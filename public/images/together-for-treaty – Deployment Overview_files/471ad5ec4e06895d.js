
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c2af1887-de2a-5745-a869-e8ed69fa5512")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6273217,e=>{e.v({alignEnd:"trace-viewer-module__8w33tq__alignEnd",alignStart:"trace-viewer-module__8w33tq__alignStart",ancestorDuration:"trace-viewer-module__8w33tq__ancestorDuration",ancestorLine:"trace-viewer-module__8w33tq__ancestorLine",ancestorLineContainer:"trace-viewer-module__8w33tq__ancestorLineContainer",ancestorName:"trace-viewer-module__8w33tq__ancestorName",ancestorNode:"trace-viewer-module__8w33tq__ancestorNode",ancestorText:"trace-viewer-module__8w33tq__ancestorText",childRow:"trace-viewer-module__8w33tq__childRow",collapsed:"trace-viewer-module__8w33tq__collapsed",color0:"trace-viewer-module__8w33tq__color0",color1:"trace-viewer-module__8w33tq__color1",color2:"trace-viewer-module__8w33tq__color2",color3:"trace-viewer-module__8w33tq__color3",colorHighlight:"trace-viewer-module__8w33tq__colorHighlight",colorVercel:"trace-viewer-module__8w33tq__colorVercel",cursorMarker:"trace-viewer-module__8w33tq__cursorMarker",cursorMarkerContainer:"trace-viewer-module__8w33tq__cursorMarkerContainer",cursorMarkerLabel:"trace-viewer-module__8w33tq__cursorMarkerLabel",cursorMarkerLabelContainer:"trace-viewer-module__8w33tq__cursorMarkerLabelContainer",cursorMarkerStickyParent:"trace-viewer-module__8w33tq__cursorMarkerStickyParent",cursorSelection:"trace-viewer-module__8w33tq__cursorSelection",detailGroup:"trace-viewer-module__8w33tq__detailGroup",detailHeading:"trace-viewer-module__8w33tq__detailHeading",detailHeadingIcon:"trace-viewer-module__8w33tq__detailHeadingIcon",divider:"trace-viewer-module__8w33tq__divider",eventDiamond:"trace-viewer-module__8w33tq__eventDiamond",eventMarker:"trace-viewer-module__8w33tq__eventMarker",eventMarkers:"trace-viewer-module__8w33tq__eventMarkers",eventMarkersContainer:"trace-viewer-module__8w33tq__eventMarkersContainer",eventName:"trace-viewer-module__8w33tq__eventName",eventTimestamp:"trace-viewer-module__8w33tq__eventTimestamp",hidden:"trace-viewer-module__8w33tq__hidden",hoverInfo:"trace-viewer-module__8w33tq__hoverInfo",huge:"trace-viewer-module__8w33tq__huge",inert:"trace-viewer-module__8w33tq__inert",infraSpanDescription:"trace-viewer-module__8w33tq__infraSpanDescription",mapCanvas:"trace-viewer-module__8w33tq__mapCanvas",mapContainer:"trace-viewer-module__8w33tq__mapContainer",mapThumb:"trace-viewer-module__8w33tq__mapThumb",marker:"trace-viewer-module__8w33tq__marker",markerLabel:"trace-viewer-module__8w33tq__markerLabel",markers:"trace-viewer-module__8w33tq__markers",markersContainer:"trace-viewer-module__8w33tq__markersContainer",mobile:"trace-viewer-module__8w33tq__mobile",notch:"trace-viewer-module__8w33tq__notch",searchBar:"trace-viewer-module__8w33tq__searchBar",searchInput:"trace-viewer-module__8w33tq__searchInput",selected:"trace-viewer-module__8w33tq__selected",skeleton:"trace-viewer-module__8w33tq__skeleton",small:"trace-viewer-module__8w33tq__small","span-skeleton":"trace-viewer-module__8w33tq__span-skeleton",spanDetailPanel:"trace-viewer-module__8w33tq__spanDetailPanel",spanDetailPanelAttribute:"trace-viewer-module__8w33tq__spanDetailPanelAttribute",spanDetailPanelAttributeKey:"trace-viewer-module__8w33tq__spanDetailPanelAttributeKey",spanDetailPanelAttributeValue:"trace-viewer-module__8w33tq__spanDetailPanelAttributeValue",spanDetailPanelBody:"trace-viewer-module__8w33tq__spanDetailPanelBody",spanDetailPanelClose:"trace-viewer-module__8w33tq__spanDetailPanelClose",spanDetailPanelCloseVerticalRule:"trace-viewer-module__8w33tq__spanDetailPanelCloseVerticalRule",spanDetailPanelCorner:"trace-viewer-module__8w33tq__spanDetailPanelCorner",spanDetailPanelDuration:"trace-viewer-module__8w33tq__spanDetailPanelDuration",spanDetailPanelName:"trace-viewer-module__8w33tq__spanDetailPanelName",spanDetailPanelQuickLink:"trace-viewer-module__8w33tq__spanDetailPanelQuickLink",spanDetailPanelQuickLinkLabel:"trace-viewer-module__8w33tq__spanDetailPanelQuickLinkLabel",spanDetailPanelResizer:"trace-viewer-module__8w33tq__spanDetailPanelResizer",spanDetailPanelTop:"trace-viewer-module__8w33tq__spanDetailPanelTop",spanDetailPanelTopInfo:"trace-viewer-module__8w33tq__spanDetailPanelTopInfo",spanDetailPanelTraceViewer:"trace-viewer-module__8w33tq__spanDetailPanelTraceViewer",spanDetailPanelTruncatedHeading:"trace-viewer-module__8w33tq__spanDetailPanelTruncatedHeading",spanDuration:"trace-viewer-module__8w33tq__spanDuration",spanName:"trace-viewer-module__8w33tq__spanName",spanNameDetailPanel:"trace-viewer-module__8w33tq__spanNameDetailPanel",spanNode:"trace-viewer-module__8w33tq__spanNode",spanNodeEvent:"trace-viewer-module__8w33tq__spanNodeEvent",spanSpacer:"trace-viewer-module__8w33tq__spanSpacer",timeline:"trace-viewer-module__8w33tq__timeline",traceNode:"trace-viewer-module__8w33tq__traceNode",traceViewer:"trace-viewer-module__8w33tq__traceViewer",traceViewerContent:"trace-viewer-module__8w33tq__traceViewerContent",unlit:"trace-viewer-module__8w33tq__unlit",xHover:"trace-viewer-module__8w33tq__xHover","zoom-buttons-fade-in":"trace-viewer-module__8w33tq__zoom-buttons-fade-in",zoomButton:"trace-viewer-module__8w33tq__zoomButton",zoomButtonGroup:"trace-viewer-module__8w33tq__zoomButtonGroup",zoomButtonTraceViewer:"trace-viewer-module__8w33tq__zoomButtonTraceViewer"})},4853462,e=>{e.v(e.b(["static/chunks/593fa239d773237a.js","static/chunks/turbopack-127044a94561a81b.js"]))},5851942,e=>{"use strict";e.s(["TraceViewer",()=>ed,"TraceViewerPanel",()=>eu,"TraceViewerProvider",()=>es,"TraceViewerTimeline",()=>ec],5851942);var t=e.i(751170),r=e.i(4099374),a=e.i(9722978),n=e.i(6273217),i=e.i(2504781),l=e.i(6942035),s=e.i(2560270),o=e.i(9508212),c=e.i(8522580),u=e.i(1344973),d=e.i(7602961),m=e.i(6195642),h=e.i(5255926),p=e.i(7749291);let f={root:{startTime:0,endTime:1,duration:1,depth:0,children:[]},spanMap:{},resourceMap:{},filter:"",selected:null,baseScale:1,scaleRatio:1,scale:1,width:640,height:480,timelineWidth:640,timelineHeight:480,panelWidth:380,panelHeight:480,scrollbarWidth:0,timelineRef:{current:null},scrollSnapshotRef:{current:void 0},memoCacheRef:{current:new Map},getQuickLinks:()=>[],withPanel:!1,isMobile:!1},w=e=>(e.width-e.scrollbarWidth-Number(!!(e.selected&&e.withPanel))*e.panelWidth)/e.root.duration,v=(0,r.createContext)({state:f,dispatch:()=>{}});v.displayName="TraceViewerContext";let _=(e,t)=>{switch(t.type){case"setRoot":return e.scrollSnapshotRef.current=void 0,e.memoCacheRef.current.clear(),_({...e,root:t.root,spanMap:t.spanMap,resourceMap:Object.fromEntries(t.resources.map(e=>{let{name:t,attributes:r}=e;return[t,r]}))},{type:"detectBaseScale"});case"setSize":{let r=t.height-56-40-24,a=e.withPanel&&t.width<=768,n={...e,width:t.width,height:t.height,timelineWidth:t.width-Number(!!(e.selected&&e.withPanel&&!a))*e.panelWidth,timelineHeight:r,panelHeight:r,isMobile:a};return n.width!==e.width&&(n=_(n,{type:"detectBaseScale"})),n}case"setPanelWidth":{let r=Math.max(240,Math.min(t.width,e.width-240));return{...e,timelineWidth:e.width-r,panelWidth:r}}case"setFilter":return{...e,filter:t.filter};case"deselect":return _({...e,selected:null,timelineWidth:e.width},{type:"minScale"});case"select":{let r=e.spanMap[t.id];if(!r)return e;return{...e,selected:r,timelineWidth:e.width-(e.withPanel&&!e.isMobile?e.panelWidth:0)}}case"escape":if(e.selected)return _(e,{type:"deselect"});return _(e,{type:"resetScale"});case"toggleSelection":{let r=e;if(e.selected&&(r=_(r,{type:"deselect"})),e.selected?.span.spanId===t.id)return r;return _(r,{type:"select",id:t.id})}case"detectBaseScale":{let t=(e.width-e.scrollbarWidth)/e.root.duration;return{...e,baseScale:t,scale:t*e.scaleRatio}}case"setScale":return{...e,scaleRatio:t.scale,scale:e.baseScale*t.scale};case"resetScale":return _(e,{type:"scaleToRange",t1:e.root.startTime,t2:e.root.endTime});case"scaleToNode":{let r=e.spanMap[t.id];if(!r)return e;return _(_(e,{type:"setScale",scale:(e.width-e.scrollbarWidth-(e.withPanel&&!e.isMobile?e.panelWidth:0))/r.duration/e.baseScale}),{type:"setScrollSnapshot",anchorT:r.startTime-e.root.startTime,anchorX:0})}case"scaleToRange":{let r=Math.abs(t.t1-t.t2);return _(_(e,{type:"setScale",scale:(e.width-e.scrollbarWidth-(e.selected&&e.withPanel?e.panelWidth:0))/r/e.baseScale}),{type:"setScrollSnapshot",anchorT:Math.min(t.t1,t.t2)-e.root.startTime,anchorX:0})}case"adjustScaleRatio":{let{scaleRatio:r}=e;switch(t.direction){case -1:r*=.8;break;case 1:r*=1.25;break;default:r=1}let a=e.timelineRef.current;if(!a)return console.warn("timelineRef is null"),e;let{clientWidth:n,scrollLeft:i}=a;return _(_({...e,scaleRatio:r,scale:e.baseScale*r},{type:"minScale"}),{type:"setScrollSnapshot",anchorT:(i+.5*n)/e.scale,anchorX:.5*n})}case"trackpadScale":{let r=Math.max(w(e)/e.baseScale,e.scaleRatio*(1+.2*Math.sign(t.delta)*Math.sqrt(Math.abs(t.delta))));return _({...e,scaleRatio:r,scale:e.baseScale*r},{type:"setScrollSnapshot",anchorT:t.anchorT,anchorX:t.anchorX})}case"minScale":{let t=w(e);if(e.scale>=t)return e;return{...e,scale:t,scaleRatio:t/e.baseScale}}case"setScrollSnapshot":{let r=e.timelineRef.current;if(!r)return e;let{anchorT:a,anchorX:n}=t,i=a*e.scale-n,{scrollTop:l}=r,s=(l-24-8)/26,o=s+Math.ceil(e.timelineHeight/26);return e.scrollSnapshotRef.current={anchorT:a,anchorX:n,scrollLeft:i,scrollTop:l,startTime:e.root.startTime+i/e.scale,endTime:e.root.startTime+(i+e.timelineWidth)/e.scale,startRow:s,endRow:o,scale:e.scale},e}case"setWithPanel":if(e.withPanel===t.withPanel)return e;return{...e,withPanel:t.withPanel};case"forceRender":return e.memoCacheRef.current.set("",{}),{...e}}};function g(e){let{getQuickLinks:a,withPanel:n=!1,children:i}=e,l=(0,r.useRef)(null),s=(0,r.useRef)(void 0),o=(0,r.useRef)(a);o.current=a;let c=(0,r.useRef)(new Map),u=(0,r.useRef)(new Map),[d,m]=(0,r.useReducer)(_,f,e=>({...e,scrollbarWidth:(()=>{if(!("document"in globalThis))return 0;let e=document.createElement("div");e.style.width="400px",e.style.height="400px",e.style.overflow="scroll",document.body.appendChild(e);let t=400-e.scrollWidth;return e.remove(),t})(),timelineRef:l,scrollSnapshotRef:s,memoCacheRef:c,withPanel:n,getQuickLinks:e=>{let t=e.spanId,r=u.current.get(t);if(r)return r;let a=o.current?.(e)||[];return u.current.set(t,a),a}}));(0,r.useEffect)(()=>m({type:"setWithPanel",withPanel:n}),[n]);let h=(0,r.useMemo)(()=>({state:d,dispatch:m}),[d,m]);return(0,t.jsx)(v.Provider,{value:h,children:i})}let x=()=>(0,r.useContext)(v);var b=e.i(9698309);let y=(e,t)=>e.duration*t<64,k=(e,t)=>e.duration*t>=500,j=e=>e.isVercel?String(n.default.colorVercel):String(n.default[`color${e.resourceIndex%5}`]),T=(e,t)=>{let r=k(e,t),i=e.isHovered&&!r&&!1!==e.isHighlighted;return(0,a.clsx)(n.default.spanNode,r&&n.default.huge,y(e,t)&&n.default.small,e.isSelected&&n.default.selected,i&&n.default.xHover,e.isHighlighted?n.default.colorHighlight:j(e),!1===e.isHighlighted&&n.default.unlit)},S=(0,r.memo)(function(e){let{root:r,scale:a,spans:n,scrollSnapshotRef:i,cache:l}=e;return n.map(e=>(0,t.jsx)(N,{cacheKey:l.get(e.span.spanId),node:e,root:r,scale:a,scrollSnapshotRef:i},e.span.spanId))}),N=(0,r.memo)(function(e){let{node:a,root:i,scale:l,scrollSnapshotRef:s}=e,o=(0,r.useRef)(null);a.ref=o;let{span:c}=a,u=a.isInstrumentationHint?"Get Started":(0,b.formatDuration)(a.duration),d=(a.startTime-i.startTime)*l,m=24+26*a.row,h=a.duration*l,p=24,f=k(a,l),w=y(a,l),v=a.isHovered&&!f&&!1!==a.isHighlighted;w&&!v&&(p*=.4,m+=(24-p)*.5);let _=!1;if(v){let{duration:e,endTime:t}=i,r=s.current;r&&(e=r.endTime-r.startTime,t=r.endTime),_=t-a.startTime<.25*e}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{"aria-label":`${c.name} - ${u}`,className:T(a,l),"data-span-id":c.spanId,"data-start-time":a.startTime-i.startTime,"data-right-side":_,ref:o,style:{"--span-width":`${h}px`,minWidth:v?h:void 0,width:v?void 0:h,height:p,maxWidth:v&&!_?(i.endTime-a.startTime)*l:void 0,containIntrinsicWidth:v?void 0:h,containIntrinsicHeight:p,left:_?void 0:d,right:_?(i.endTime-a.endTime)*l:void 0,top:m},type:"button",children:w&&!v?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:n.default.spanName,children:a.label||c.name}),f?(0,t.jsx)("span",{className:n.default.spanSpacer}):null,v||h>128?(0,t.jsx)("span",{className:n.default.spanDuration,children:u}):null]})}),a.events&&!w?a.events.map(e=>(0,t.jsx)(M,{event:e,node:a,root:i,scale:l},e.key)):null]})}),M=(0,r.memo)(function(e){let{event:i,node:l,root:s,scale:o}=e,c=(0,r.useRef)(null);i.ref=c;let{event:{name:u}}=i,d=(0,b.formatDuration)(i.timestamp-s.startTime),m=(i.timestamp-s.startTime)*o,h=24+26*l.row;return(0,t.jsxs)("div",{"aria-label":`${u} - ${d}`,className:(0,a.clsx)(n.default.spanNodeEvent,l.isHighlighted?n.default.colorHighlight:j(l),!1===l.isHighlighted&&n.default.unlit),"data-hovered":i.isHovered,ref:c,style:{left:m,top:h},children:[(0,t.jsxs)("div",{className:(0,a.clsx)(n.default.hoverInfo,(i.timestamp-l.startTime)/l.duration<.5?n.default.alignStart:n.default.alignEnd),children:[(0,t.jsx)("span",{className:n.default.eventName,children:u}),(0,t.jsx)("span",{className:n.default.eventTimestamp,children:d})]}),(0,t.jsx)("div",{className:n.default.eventDiamond})]})}),q=e=>`${(100*e).toFixed(3)}%`,D=(e,t)=>e<t?-1:+(e>t),L=e=>{let t={};for(let[r,a]of Object.entries(e)){let e=r.indexOf("."),n="",i="";-1!==e?(n=r.substring(0,e),i=r.substring(e+1)):i=r;let l=t[n];l||(l={prefix:n,attributes:[]},t[n]=l),l.attributes.push({key:r,suffix:i,value:String(a)})}let r=Array.from(Object.values(t)).sort((e,t)=>D(e.prefix,t.prefix));for(let e of r)e.attributes.sort((e,t)=>D(e.suffix,t.suffix));return r};function P(e){let{attached:s=!1}=e,{state:{root:c,selected:d,resourceMap:m,getQuickLinks:h,isMobile:p},dispatch:f}=x(),w=(0,r.useMemo)(()=>L(d?.span.attributes??{}),[d]),v=(0,r.useMemo)(()=>{let e=d?.span.resource;if(!e)return[];let t=m[e];return t?L(t):[]},[m,d]),_=(0,r.useMemo)(()=>((e,t)=>{let r=[];if(!t)return r;for(let e=t;"parent"in e;e=e.parent)r.unshift(e);return r})(0,d),[c,d]);if(!d)return null;let{span:g}=d,y=V(d);return(0,t.jsxs)(o.Stack,{className:(0,a.clsx)(n.default.spanDetailPanel,p&&n.default.mobile),children:[s&&!p?(0,t.jsx)(O,{}):null,(0,t.jsx)(o.Stack,{className:n.default.spanDetailPanelTop,direction:"row",children:(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelTopInfo,direction:"row",gap:3,justify:"space-between",children:[(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelTruncatedHeading,direction:"row",gap:3,children:[d.isInstrumentationHint?null:(0,t.jsx)(u.Text,{as:"span",className:n.default.spanDetailPanelDuration,monospace:!0,size:13,children:(0,b.formatDuration)(d.duration)}),(0,t.jsx)(u.Text,{as:"span",className:n.default.spanDetailPanelName,size:13,title:g.name,children:g.name})]}),(0,t.jsxs)(o.Stack,{align:"center",className:n.default.spanDetailPanelCorner,direction:"row",gap:2,children:[(0,t.jsx)(o.Stack,{direction:"row",children:(0,t.jsx)("div",{className:n.default.spanDetailPanelCloseVerticalRule})}),(0,t.jsx)(i.Button,{"aria-label":"Close Span Details",className:n.default.spanDetailPanelClose,onClick:()=>f({type:"deselect"}),shape:"square",size:"small",svgOnly:!0,touchEventWorkaround:!0,type:"tertiary",children:(0,t.jsx)(l.Cross,{color:"gray-700",size:20})})]})]})}),(0,t.jsxs)(o.Stack,{className:n.default.spanDetailPanelBody,gap:3,children:[d.isVercel?(0,t.jsx)(F,{node:d}):null,d.isInstrumentationHint?(0,t.jsx)(B,{}):null,!d.isInstrumentationHint&&_.length?(0,t.jsx)(E,{className:n.default.ancestorGroup,name:"Location",children:_.map(e=>(0,t.jsxs)("button",{className:n.default.ancestorNode,onClick:()=>f({type:"select",id:e.span.spanId}),type:"button",children:[(0,t.jsxs)("div",{className:n.default.ancestorText,children:[(0,t.jsx)("span",{className:n.default.ancestorName,children:e.label||e.span.name}),(0,t.jsx)("span",{className:n.default.ancestorDuration,children:(0,b.formatDuration)(e.duration)})]}),(0,t.jsx)("span",{"aria-hidden":!0,className:n.default.ancestorLineContainer,children:(0,t.jsx)("span",{className:(0,a.clsx)(n.default.ancestorLine,j(e)),style:{left:q((e.startTime-c.startTime)/c.duration),width:q(e.duration/c.duration)}})})]},`${d.span.spanId}.${e.span.spanId}`))}):null,y?(0,t.jsx)(W,{getQuickLinks:h,span:d.span}):null,d.events?.length?(0,t.jsx)(E,{name:"Events",children:d.events.map(e=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsxs)("dl",{className:n.default.spanDetailPanelAttribute,children:[(0,t.jsx)("dt",{className:n.default.spanDetailPanelAttributeKey,children:e.event.name}),(0,t.jsx)("dd",{className:n.default.spanDetailPanelAttributeValue,children:(0,b.formatDuration)(e.timestamp-c.startTime)})]}),Object.entries(e.event.attributes).map(r=>{let[a,n]=r;return(0,t.jsx)(z,{name:`${e.event.name}.${a}`,value:n},a)})]},e.key))}):null,w.length?(0,t.jsx)(E,{name:"Attributes",children:w.map(e=>(0,t.jsx)(r.Fragment,{children:e.attributes.map(e=>{let{key:r,value:a}=e;return(0,t.jsx)(z,{name:r,value:a},r)})},e.prefix))}):null,v.length?(0,t.jsx)(E,{name:"Resource",children:v.map(e=>(0,t.jsx)(r.Fragment,{children:e.attributes.map(e=>{let{key:r,value:a}=e;return(0,t.jsx)(z,{name:r,value:a},r)})},e.prefix))}):null,d.isInstrumentationHint?null:(0,t.jsxs)(E,{name:"Library",children:[(0,t.jsx)(z,{name:"name",value:g.library.name}),g.library.version?(0,t.jsx)(z,{name:"version",value:g.library.version}):null]})]})]})}let R="vc-trace-span-exp:";function E(e){let{name:i,className:l="",children:c}=e,[u,d]=(0,r.useState)(()=>!("localStorage"in globalThis)||"0"!==localStorage.getItem(`${R}${i}`)),m=(0,r.useCallback)(()=>{d(e=>{let t=!e;return localStorage.setItem(`${R}${i}`,String(Number(t))),t})},[i]);return(0,t.jsxs)(o.Stack,{className:(0,a.clsx)(n.default.detailGroup,u?n.default.expanded:n.default.collapsed,l),children:[(0,t.jsxs)("button",{className:n.default.detailHeading,onClick:m,type:"button",children:[(0,t.jsx)("span",{children:i}),(0,t.jsx)(s.ChevronDown,{className:n.default.detailHeadingIcon})]}),u?c:null]})}let C=new Set(["OPTIONS","HEAD","GET","PUT","POST","DELETE"]),H={"Resolve Deployment":"How long it took Vercel's routing layer to retrieve details for the deployment.","Resolve Cache":"How long it took Vercel's routing layer to check for a cached function invocation.","Resolve Route":"How long it took Vercel's routing layer to resolve routing rules, including redirects and rewrites.","Invoke Middleware":"How long it took this middleware to start and run user code.","Invoke Function":"How long it took this Vercel Function to start and run user code.",waitUntil:"How long it took to run user code inside of waitUntil.","Start VM":"How long it took to start the Virtual Machine which contains the Vercel Function.","Spawn Node.js":"How long it took the Virtual Machine to start the Node.js runtime.","Spawn Python":"How long it took the Virtual Machine to start the Python runtime.","Init User Code":"How long it took to import the user code and run any globally-scoped code."},I=new Set(["Start VM","Spawn Node.js","Spawn Python","Init User Code"]),A=e=>{if(!e||!("span"in e))return null;let t=e.span.attributes,r=t["vercel.region"]||t["vercel.function.region"];return r?String(r):null},V=e=>{if(!e.isVercel)return!1;let{name:t}=e.span,r=t.indexOf(" ");if(-1===r)return!1;let a=t.substring(0,r);return C.has(a)};function F(e){let{node:r}=e,{name:a}=r.span,i=H[a];if(!i&&V(r)&&(i="How long it took for Vercel to process the request and send the response."),!i)return null;let l=(e=>{let{name:t}=e.span,r=A(e),a=A(e.parent);return"true"===e.span.attributes["vercel.middleware.internal"]?"The Vercel Toolbar created this middleware.":I.has(t)||"Invoke Function"===t&&e.children.some(e=>I.has(e.span.name))?"This function encountered a cold start.":r&&a&&r!==a?"This request was routed across regions.":null})(r);return(0,t.jsx)(E,{name:"What is this?",children:(0,t.jsxs)("div",{className:n.default.infraSpanDescription,children:[(0,t.jsx)("span",{children:i}),l?(0,t.jsx)(c.Note,{children:l}):l]})})}let W=(0,r.memo)(function(e){let{getQuickLinks:r,span:a}=e,n=r(a);return n.length?(0,t.jsx)(E,{name:"Links",children:n.map(e=>{let{key:r,value:a}=e;return(0,t.jsx)($,{link:a,name:r},r)})}):null});function $(e){let{name:i,link:l}=e,s=function(e){let[t,a]=(0,r.useState)({}),n=void 0!==e.__resolvedValue||void 0!==e.__rejectedValue;return(0,r.useEffect)(()=>{n||e.then(t=>{e.__resolvedValue=t}).catch(t=>{e.__rejectedValue=t}).finally(()=>a({}))},[e,n]),e.__resolvedValue}(l);return(0,t.jsxs)(m.Link,{as:s?void 0:"span",className:(0,a.clsx)(n.default.spanDetailPanelAttribute,n.default.spanDetailPanelQuickLink),href:s?.href||"",children:[(0,t.jsx)("span",{className:n.default.spanDetailPanelAttributeKey,children:i}),(0,t.jsx)("span",{className:(0,a.clsx)(n.default.spanDetailPanelAttributeValue,n.default.spanDetailPanelQuickLinkLabel),children:s?(0,t.jsxs)(t.Fragment,{children:[s.label,s.icon||(0,t.jsx)(p.ExternalSmall,{color:"gray-900"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Skeleton,{height:18,width:32+8*i.length}),(0,t.jsx)(h.Skeleton,{height:18,rounded:!0,width:18})]})})]})}function B(){return(0,t.jsx)(E,{name:"What is this?",children:(0,t.jsxs)("div",{className:n.default.infraSpanDescription,children:[(0,t.jsx)("span",{children:"You can visualize your application's spans alongside Vercel's spans in this viewer."}),(0,t.jsx)(d.ButtonLink,{href:"https://vercel.com/docs/session-tracing#adding-custom-spans",size:"small",target:"_blank",children:"Get Started"})]})})}function z(e){let{name:r,value:a}=e;return(0,t.jsxs)("dl",{className:n.default.spanDetailPanelAttribute,children:[(0,t.jsx)("dt",{className:n.default.spanDetailPanelAttributeKey,children:r}),(0,t.jsx)("dd",{className:n.default.spanDetailPanelAttributeValue,title:String(a),children:String(a)})]})}function O(){let{state:{panelWidth:e},dispatch:a}=x(),i=(0,r.useRef)({start:{x:0,width:e},x:0,width:e,isHeld:!1});i.current.width=e;let l=(0,r.useCallback)(e=>{if("mouse"!==e.pointerType)return;e.preventDefault();let t=i.current;t.start.x=e.clientX,t.x=e.clientX,t.start.width=t.width,t.isHeld=!0},[]),s=(0,r.useCallback)(()=>{a({type:"setPanelWidth",width:f.panelWidth})},[a]);return(0,r.useEffect)(()=>{let e=0,t=()=>{let e=i.current;a({type:"setPanelWidth",width:e.start.width+e.start.x-e.x})},r=r=>{i.current.isHeld&&(r.preventDefault(),i.current.x=r.clientX,cancelAnimationFrame(e),e=requestAnimationFrame(t))},n=()=>{i.current.isHeld=!1};return window.addEventListener("pointermove",r),window.addEventListener("pointerup",n),()=>{window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",n)}},[a]),(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.spanDetailPanelResizer,onDoubleClick:s,onPointerDown:l})}var K=e.i(3074892);let X=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.5 1.5C3.73858 1.5 1.5 3.73858 1.5 6.5C1.5 9.26142 3.73858 11.5 6.5 11.5C9.26142 11.5 11.5 9.26142 11.5 6.5C11.5 3.73858 9.26142 1.5 6.5 1.5ZM0 6.5C0 2.91015 2.91015 0 6.5 0C10.0899 0 13 2.91015 13 6.5C13 8.02469 12.475 9.42677 11.596 10.5353L15.0303 13.9697L15.5607 14.5L14.5 15.5607L13.9697 15.0303L10.5353 11.596C9.42677 12.475 8.02469 13 6.5 13C2.91015 13 0 10.0899 0 6.5ZM4.75 5.875H4.125V7.125H4.75H8.25H8.875V5.875H8.25H4.75Z" fill="currentColor"/>');var G=e.i(5376191);function Q(){let{dispatch:e}=x(),a=(0,r.useCallback)(()=>{e({type:"adjustScaleRatio",direction:1})},[e]),l=(0,r.useCallback)(()=>{e({type:"adjustScaleRatio",direction:-1})},[e]),s=(0,r.useCallback)(()=>{e({type:"adjustScaleRatio",direction:0})},[e]);return(0,t.jsxs)(o.Stack,{className:n.default.zoomButtonGroup,direction:"row",children:[(0,t.jsx)(i.Button,{"aria-label":"Zoom Out",className:n.default.zoomButton,onClick:l,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(X,{})}),(0,t.jsx)("div",{className:n.default.divider}),(0,t.jsx)(i.Button,{"aria-label":"Reset Zoom",className:n.default.zoomButton,onClick:s,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(G.Minus,{})}),(0,t.jsx)("div",{className:n.default.divider}),(0,t.jsx)(i.Button,{"aria-label":"Zoom In",className:n.default.zoomButton,onClick:a,svgOnly:!0,variant:"unstyled",children:(0,t.jsx)(K.MagnifyingGlassPlus,{})})]})}var U=e.i(9096091);function Z(e){let t=(0,r.useRef)({});return{setStyle:(0,r.useCallback)((r,a)=>{if(t.current[r]=a,e.current){if(!a)return void e.current.style.removeProperty(r);e.current.style.setProperty(r,a)}},[e]),styleRef:t,style:{...t.current}}}let Y=[1,2,4,5,8,10];function J(e){let{scale:r}=e,{state:{root:i}}=x(),l=i.duration,s=Math.floor(Math.log10(l)),o=Math.max(2,Math.pow(10,s)*(Math.floor(Math.log10(.5*l))===s?1:.5)),c=o*r,u=1;for(let e of Y){if(o/e<24)break;u=e}o/=u,c/=u;let d=Math.ceil(l/o),m=Math.ceil(100/c)||1;return(0,t.jsx)("div",{className:n.default.markersContainer,children:(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.markers,style:{width:Math.floor(i.duration*r+15),visibility:-1!==r?"visible":"hidden","--marker-width":`${c}px`},children:Array(d).fill(null).map((e,r)=>{let i=r%m==0;return(0,t.jsx)("span",{className:(0,a.clsx)(n.default.marker,!i&&n.default.notch),children:i?(0,t.jsx)("span",{className:n.default.markerLabel,children:(0,b.formatDuration)(o*r)}):null},String(r))})})})}function ee(e){let{events:r,root:i,scale:l}=e;return(0,t.jsx)("div",{className:n.default.eventMarkersContainer,children:(0,t.jsx)("div",{"aria-hidden":!0,className:n.default.eventMarkers,style:{width:Math.floor(i.duration*l)},children:r.map(e=>(0,t.jsx)("span",{className:(0,a.clsx)(n.default.eventMarker),style:{left:Math.floor((e.timestamp-i.startTime)*l)}},e.key))})})}function et(e){let{memoCacheRef:a,timelineRef:i,root:l,spans:s,events:o,scale:c,dispatch:u,scrollSnapshotRef:d}=e,m=(0,r.useRef)(!1),h=(0,r.useRef)(s);h.current=s;let p=(0,r.useRef)(o);p.current=o;let f=(0,r.useRef)(null),{style:w,setStyle:v}=Z(f),_=(0,r.useRef)(null),g=(0,r.useRef)(null),{style:x,setStyle:y}=Z(g),k=(0,r.useRef)(void 0),j=(0,r.useRef)(null),{style:T,setStyle:S}=Z(j),N=(0,r.useRef)(0);(0,r.useEffect)(()=>{let e=i.current;if(!e)return;let t=N.current,r=0,n=!1,s=!1,o=!1,d=!1,f=0,w=0,g=Date.now()+500,x=()=>{k.current||(k.current=e.getBoundingClientRect())},T=e=>k.current?(e-24-8)/26:0,q=()=>{let e=a.current;for(let t of h.current)t.isHovered&&(t.isHovered=!1,e.set(t.span.spanId,{}));u({type:"forceRender"})},D=0,L=()=>{if(!m.current)return;k.current||x();let i=k.current;if(!i)return;let{scrollLeft:d,scrollTop:N}=e,M=Math.max(0,Math.min(t+d-i.left-8,l.duration*c)),P=`${M-d+8}px`;y("left",P),v("left",P);let R=l.startTime+M/c,E=R-l.startTime;if(E<0||E>l.duration?_.current?.removeAttribute("data-text"):_.current?.setAttribute("data-text",(0,b.formatTimeSelection)(E)),n){let e,a,n=t-r,s=Math.abs(n);if(!o){if(s<4)return;o=!0,S("display","flex"),q()}n>0?(S("left",""),S("right","0")):(S("left","0"),S("right","")),S("width",`${s}px`);let u=Math.max(0,Math.min(r+d-i.left-8,l.duration*c))/c;u<E?(e=u,a=E):(e=E,a=u),j.current?.setAttribute("data-range",`${(0,b.formatTimeSelection)(e)} — ${(0,b.formatTimeSelection)(a)}`),j.current?.setAttribute("data-duration",`${(0,b.formatTimeSelection)(a-e)} selected`)}if(Date.now()<g){D=requestAnimationFrame(L);return}if(d!==f||N!==w){f=d,w=N,D=requestAnimationFrame(L);return}if(t-i.left<128?_.current?.setAttribute("data-align","left"):t-i.left>i.width-128?_.current?.setAttribute("data-align","right"):_.current?.removeAttribute("data-align"),!o&&!s){let e=a.current,t=T(N)-2,r=T(N+i.height)+2;for(let a of h.current){let n=a.row>=t&&a.row<=r&&R>=a.startTime&&R<=a.endTime;a.isHovered!==n&&(a.isHovered=n,e.set(a.span.spanId,{}))}let n=12/c;for(let e of p.current){let t=R>=e.timestamp-n&&R<=e.timestamp+n;if(e.isHovered===t)continue;e.isHovered=t;let r=e.ref?.current;r&&r.setAttribute("data-hovered",String(t))}u({type:"forceRender"})}};D=requestAnimationFrame(L);let P=e=>{"mouse"===e.pointerType&&(m.current=!0)},R=()=>{m.current&&(m.current=!1,q())},E=e=>{let{clientX:r}=e;N.current=t=r,cancelAnimationFrame(D),D=requestAnimationFrame(L)},C=e=>{e.preventDefault()},H=e=>{if(2===e.button)d=!0,e.preventDefault();else{if(0!==e.button)return;d=!1}i.current?.contains(e.target)?(r=t,n=!0):(s=!0,requestAnimationFrame(q))},I=a=>{if(s=!1,!n||(n=!1,!o))return;if(o=!1,S("display",""),S("left",""),S("right",""),S("width",""),a.preventDefault(),a.stopImmediatePropagation(),d){d=!1;return}k.current||x();let i=k.current;if(!i)return;let{scrollLeft:m}=e,h=Math.max(0,Math.min((r+m-i.left-8)/c,l.duration)),p=Math.max(0,Math.min((t+m-i.left-8)/c,l.duration));u({type:"scaleToRange",t1:h+l.startTime,t2:p+l.startTime})},A=e=>{n&&"Escape"===e.key&&(d=!0,I(e))},V=()=>{k.current=void 0,M.current=void 0,cancelAnimationFrame(D),D=requestAnimationFrame(L)},F=()=>{cancelAnimationFrame(D),D=requestAnimationFrame(L)},W=new ResizeObserver(()=>{k.current=void 0});return W.observe(e),window.addEventListener("mousemove",E),e.addEventListener("contextmenu",C),window.addEventListener("mousedown",H),window.addEventListener("mouseup",I),window.addEventListener("blur",I),window.addEventListener("keydown",A,!0),window.addEventListener("scroll",V),e.addEventListener("scroll",F),e.addEventListener("pointerenter",P),e.addEventListener("pointerleave",R),()=>{W.disconnect(),window.removeEventListener("mousemove",E),e.removeEventListener("contextmenu",C),window.removeEventListener("mousedown",H),window.removeEventListener("mouseup",I),window.removeEventListener("blur",I),window.removeEventListener("keydown",A,!0),window.removeEventListener("scroll",V),e.removeEventListener("scroll",F),e.removeEventListener("pointerenter",P),e.removeEventListener("pointerleave",R),cancelAnimationFrame(D),N.current=t,q()}},[u,l,c,y,v,S,a,i,d]);let M=(0,r.useRef)(void 0);var q=e=>{let t=i.current;if(!t)return;k.current??=t.getBoundingClientRect();let r=k.current,a=Math.max(0,Math.min(N.current-r.left-8,r.width-16)),n=0,l=M.current;l?.anchorX===a?n=l.anchorT:M.current=l={anchorT:n=(t.scrollLeft+a)/c,anchorX:a},u({type:"trackpadScale",delta:e/64,anchorT:n,anchorX:a})};let D=(0,r.useRef)(q);return D.current=q,(0,r.useEffect)(()=>{let e=0,t=0,r=()=>{D.current(e),e=0},a=a=>{if(!a.ctrlKey&&!a.metaKey)return;a.preventDefault();let n=-a.deltaY;switch(a.deltaMode){case WheelEvent.DOM_DELTA_PAGE:n*=window.innerHeight;break;case WheelEvent.DOM_DELTA_LINE:n*=20}e+=n,cancelAnimationFrame(t),t=requestAnimationFrame(r)};return window.addEventListener("wheel",a,{passive:!1}),()=>{window.removeEventListener("wheel",a),cancelAnimationFrame(t)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:n.default.cursorMarkerStickyParent,children:(0,t.jsx)("div",{className:n.default.cursorMarkerLabelContainer,ref:f,style:w,children:(0,t.jsx)("div",{className:n.default.cursorMarkerLabel,ref:_})})}),(0,t.jsx)("div",{className:n.default.cursorMarkerStickyParent,children:(0,t.jsx)("div",{className:n.default.cursorMarkerContainer,ref:g,style:x,children:(0,t.jsx)("div",{className:n.default.cursorMarker,children:(0,t.jsx)("div",{className:n.default.cursorSelection,ref:j,style:T})})})})]})}function er(){return[]}let ea=(0,r.memo)(function(e){let{timelineRef:a,rows:i,scale:l}=e,{state:{root:s,baseScale:o,timelineWidth:c,width:u,scrollbarWidth:d}}=x(),m=u+16,h=(()=>{let[e,t]=(0,r.useState)(1);return(0,r.useLayoutEffect)(()=>{let r=()=>t("devicePixelRatio"in globalThis&&globalThis.devicePixelRatio||1),a=matchMedia(`(resolution: ${e}dppx)`);return a.addEventListener("change",r),r(),()=>{a.removeEventListener("change",r)}},[e]),e})(),p=(0,r.useRef)(null),f=(0,r.useRef)(null),w=u/(u-d)*Math.min(u/c,o/l),v=Math.min(u,(c-d)*w);(0,r.useEffect)(()=>{let e,t=!1,r=0,n=e=>!!p.current?.contains(e),i=0,l=()=>{if(!t||!e)return;let n=a.current;n&&(n.scrollLeft=(r-.5*v-e.left)/w)},s=e=>{({clientX:r}=e),cancelAnimationFrame(i),i=requestAnimationFrame(l)},o=r=>{n(r.target)&&(t=!0,e=p.current?.getBoundingClientRect(),s(r))},c=()=>{t=!1,e=void 0},u=e=>{n(e.target)&&e.cancelable&&e.preventDefault()},d=e=>{t&&e.cancelable&&e.preventDefault()};return window.addEventListener("pointerdown",o),window.addEventListener("pointermove",s),window.addEventListener("pointerup",c),window.addEventListener("blur",c),window.addEventListener("touchstart",u,{passive:!1}),window.addEventListener("touchmove",d,{passive:!1}),()=>{window.removeEventListener("pointerdown",o),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",c),window.removeEventListener("blur",c),window.removeEventListener("touchstart",u),window.removeEventListener("touchmove",d),cancelAnimationFrame(i)}},[a,w,v]),(0,r.useEffect)(()=>{let e=f.current,t=e?.getContext("2d");if(!e||!t)return;let r=requestAnimationFrame(()=>{t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.scale(h,h);let r=(m-16)/s.duration;for(let e of(t.fillStyle="#ccc",t.beginPath(),i))for(let a of e){let e=7+4*a.row;if(e>=45)break;let n=8+(a.startTime-s.startTime)*r,i=a.duration*r;t.roundRect(n,e,i,3,3)}t.fill()});return()=>cancelAnimationFrame(r)},[h,s,m,i]);let _=(0,r.useRef)(null),{style:g,setStyle:b}=Z(_);return(0,r.useLayoutEffect)(()=>{let e=a.current;if(!e)return;let t=0,r=()=>{b("transform",`translateX(${8+e.scrollLeft*w}px)`)};r();let n=()=>{cancelAnimationFrame(t),t=requestAnimationFrame(r)};return e.addEventListener("scroll",n),()=>{cancelAnimationFrame(t),e.removeEventListener("scroll",n)}},[a,w,b]),(0,t.jsxs)("div",{className:n.default.mapContainer,ref:p,style:{width:v>0?m:"100%",height:56},children:[(0,t.jsx)("canvas",{className:n.default.mapCanvas,height:56*h,ref:f,style:{width:m,height:56},width:m*h}),(0,t.jsx)("div",{className:n.default.mapThumb,ref:_,style:{transform:g.transform,width:v>0?v:"calc(100% - 16px)",top:2,height:52}})]})});var en=e.i(8835183);function ei(){return(0,t.jsx)("nav",{className:n.default.searchBar,children:(0,t.jsx)(el,{})})}function el(){let{dispatch:e}=x(),[a,i]=(0,r.useState)("");return(0,r.useEffect)(()=>{let t=setTimeout(()=>e({type:"setFilter",filter:a}),100);return()=>{clearTimeout(t)}},[e,a]),(0,t.jsx)("div",{className:n.default.searchInput,children:(0,t.jsx)(en.SearchInput,{height:40,onChange:e=>i(e.target.value),placeholder:"Search spans…",value:a,width:"100%"})})}function es(e){let{getQuickLinks:r,children:a}=e;return(0,t.jsx)(g,{getQuickLinks:r,children:a})}let eo={traceId:"skeleton",spans:[{parentSpanId:"",spanId:"root",name:"root span",kind:1,resource:"vercel.runtime",startTime:[5e3,0],endTime:[6e3,0],duration:[1e3,0],library:{name:"vercel-site"},status:{code:1},attributes:{"vercel.ownerId":"team_abc"},traceFlags:1,events:[],links:[]}],resources:[{name:"vercel.runtime",attributes:{}}],rootSpanId:"root"};function ec(i){let{trace:l=eo,className:s="",scrollLock:o=!1,height:c,withPanel:u=!1,highlightedSpans:d}=i,m=l===eo,{state:h,dispatch:p}=x(),{timelineRef:f,scrollSnapshotRef:w}=h,v=h.memoCacheRef.current,_=(d?.length??0)>0;(0,r.useEffect)(()=>{let{root:e,map:t}=(0,U.parseTrace)(l);p({type:"setRoot",root:e,spanMap:t,resources:l.resources||[]})},[p,l]);let{rows:g,spans:b,events:y,scale:k}=(t=>{let{state:a,dispatch:n}=x(),{root:i,filter:l,scale:s,timelineRef:o,timelineWidth:c,spanMap:u,scrollSnapshotRef:d,selected:m,memoCacheRef:h}=a,p=function(e){let[t,a]=(0,r.useState)(e);return(0,r.useEffect)(()=>{if(t===e)return;let r=0,n=0,i=()=>{if(++r<=3){n=requestAnimationFrame(i);return}a(e)};return i(),()=>{cancelAnimationFrame(n)}},[t,e]),t}(a.timelineHeight),f=(0,r.useRef)(0),[w,v]=(0,r.useState)(er),[_,g]=(0,r.useState)(er),[b,y]=(0,r.useState)(er),[k,j]=(0,r.useState)(-1),S=(0,r.useRef)(void 0);return(0,r.useEffect)(()=>S.current?.(l),[l]),(0,r.useEffect)(()=>{if(t?.length){for(let e of w)for(let r of e){let e=t.includes(r.span.spanId);r.isHighlighted!==e&&(r.isHighlighted=e,h.current.set(r.span.spanId,{}))}n({type:"forceRender"})}},[w,t,n,h]),(0,r.useEffect)(()=>{if(!i.startTime)return;let t=new Worker(e.r(4853462)),r=++f.current;t.addEventListener("message",e=>{let t=e.data;switch(t.type){case"setRowsResult":if(t.isEnd)for(let e of t.rows)for(let t of e)t.span=u[t.span.spanId]?.span??t.span;v(t.rows);break;case"updateHighlight":{if(t.requestId!==r)return;let{matches:e}=t;v(t=>{for(let r of t)for(let t of r){let r=e.has(t.span.spanId);t.isHighlighted!==r&&(t.isHighlighted=r,h.current.set(t.span.spanId,{}))}return t}),n({type:"forceRender"})}}});let a={requestId:r,type:"calculateSpanPositions",root:i};return t.postMessage(a),S.current=e=>{let a=e.trim().toLocaleLowerCase();if(!a)return void v(e=>e.map(e=>e.map(e=>(e.isHighlighted=void 0,{...e}))));let n={type:"filterSpans",requestId:r=++f.current,root:i,filter:a};t.postMessage(n)},()=>{t.terminate()}},[i,u,n,h]),(0,r.useEffect)(()=>{if(!w.length)return;let e=o.current,t=d.current,r=!1,a=!1,n=0,l=0,u=Math.max(500,.5*c),m=Array(w.length).fill(null),h=e=>t?e<t.startRow?e-t.startRow:e>t.endRow?e-t.endRow:0:0,f=e=>{if(!t)return 0;let r=0;e.endTime<t.startTime?r=t.startTime-e.endTime:e.startTime>t.endTime&&(r=e.startTime-t.endTime);let a=Math.abs(h(e.row));return r||a?Math.sqrt(Math.pow(r/s,2)+Math.pow(24*a+2,2)):0},v=0,_=()=>{(r||!t)&&(r=!1,(()=>{if(!e)return;let{scrollLeft:r,scrollTop:a}=e,n=(a-24-8)/26,l=n+Math.ceil(p/26);d.current=t={anchorT:r/s,anchorX:0,scrollLeft:r,scrollTop:a,startTime:i.startTime+r/s,endTime:i.startTime+(r+c)/s,startRow:n,endRow:l,scale:s};for(let e=m.length;e--;)m[e]=null})()),(()=>{a=!0;let e=Math.min(1+l+Math.ceil(t?.endRow??1/0),w.length);for(let t=e;t--;){if(m[t])continue;let e=h(t);if(Math.abs(e)>l){if(a=!1,e>0)continue;break}let r=[],i=w[t];if(i){for(let e of i){if(!(0,U.adjustSpanVisibility)(e,s))continue;let t=f(e);n=Math.max(t,n),r.push({d:t,span:e})}m[t]=r}}})();let o=[],x=[];for(let e of m)if(e)for(let{d:t,span:r}of e)!(t>l)&&(o.push(r),r.events&&x.push(...r.events));l<u&&(!a||l<n)&&(l=Math.min(u,l+100),v=requestAnimationFrame(_)),g(o),y(x),j(s)};_();let x=Date.now(),b=e=>{(e.ctrlKey||e.metaKey)&&(x=Date.now())};e?.addEventListener("wheel",b);let k=()=>{Date.now()-x<=50||(r=!0,cancelAnimationFrame(v),v=requestAnimationFrame(_))};return e?.addEventListener("scroll",k),()=>{cancelAnimationFrame(v),e?.removeEventListener("wheel",b),e?.removeEventListener("scroll",k)}},[w,i,s,d,o,c,p]),(0,r.useEffect)(()=>{let e;if(!m)return;for(let t of _)if(t.span.spanId===m.span.spanId){e=t;break}let t=e?.ref?.current;if(e&&t)return e.isSelected=!0,t.className=T(e,s),()=>{e.isSelected=!1,t.className=T(e,s)}},[_,s,m]),{rows:w,spans:_,events:b,scale:k}})(d),j=(0,r.useRef)(null);(0,r.useLayoutEffect)(()=>{let e=j.current;if(!e)return;let t=()=>{let t=e.getBoundingClientRect();p({type:"setSize",width:t.width-16,height:t.height})};t();let r=new ResizeObserver(t);return r.observe(e),window.addEventListener("resize",t),()=>{r.disconnect(),window.removeEventListener("resize",t)}},[p]);let N=(0,r.useRef)({t:0,x:-1,y:-1,spanId:""}),M=(0,r.useCallback)(e=>{let t=N.current,r=Date.now(),{clientX:a,clientY:i}=e,l=Math.sqrt(Math.pow(a-t.x,2)+Math.pow(i-t.y,2));if(r-t.t<=500&&l<=8)return(e.stopPropagation(),e.preventDefault(),t.spanId)?(p({type:"select",id:t.spanId}),void p({type:"scaleToNode",id:t.spanId})):void p({type:"resetScale"});let s=e.target;if(!s.closest(`.${String(n.default.timeline)}`))return;let o=s.closest("[data-span-id]"),c=o?.dataset.spanId||"";N.current={x:a,y:i,t:r,spanId:c},c&&(p({type:"toggleSelection",id:c}),e.stopPropagation())},[p]);(0,r.useLayoutEffect)(()=>{let e=f.current;if(!e)return;let t=w.current;t&&(e.scrollLeft=t.anchorT*k-t.anchorX)},[w,f,k]),(0,r.useEffect)(()=>{let e=h.selected?.span.spanId;if(!e)return;let t=setTimeout(()=>{let t=h.timelineRef.current,r=t?.querySelector(`[data-span-id="${e}"]`);if(!t||!r)return;let a=t.getBoundingClientRect(),n=r.getBoundingClientRect();n.width<a.width&&(n.left<a.left||n.right>a.right||n.top<a.top||n.bottom>a.bottom)&&r.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"})},500);return()=>{clearTimeout(t)}},[h.selected,h.timelineRef]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&p({type:"escape"})};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[p]),(0,r.useEffect)(()=>{if(!o)return;let e=document.documentElement,t=document.body;e.style.overflow="clip",t.style.overflow="clip";let r=e=>{e?.cancelable?e.preventDefault():window.scrollTo({left:0,top:0,behavior:"instant"})};return r(),window.addEventListener("scroll",r,{passive:!1}),()=>{e.style.overflow="",t.style.overflow="",window.removeEventListener("scroll",r)}},[o]);let q=Math.max(h.timelineHeight-h.scrollbarWidth,26+26*g.length-2+84),D=!!(h.isMobile&&h.selected);return(0,t.jsxs)("div",{className:(0,a.clsx)(n.default.traceViewer,m&&n.default.skeleton,s),onClickCapture:M,ref:j,style:{height:c,"--timeline-padding":"8px","--row-height":"24px","--row-padding":"2px","--search-height":`${40*!_}px`,"--search-gap":`${!_?8:2}px`,"--map-height":"56px","--timeline-width":`${h.timelineWidth}px`,"--timeline-height":`${h.timelineHeight}px`,"--timeline-scroll-width":`${Math.round(h.root.duration*h.scale)}px`,"--panel-width":`${h.panelWidth}px`,"--panel-height":`${h.panelHeight}px`,"--height":`${h.height}px`,"--scrollbar-width":`${h.scrollbarWidth}px`,"--marker-height":"24px","--marker-notch-height":"8px"},children:[_?null:(0,t.jsx)(ei,{}),(0,t.jsx)(ea,{rows:g,scale:k,timelineRef:f}),(0,t.jsxs)("div",{className:(0,a.clsx)(n.default.traceViewerContent,D&&n.default.inert),children:[(0,t.jsx)("div",{className:n.default.timeline,ref:f,children:(0,t.jsx)("div",{style:{position:"relative",width:h.timelineWidth,height:h.timelineHeight-16,padding:8,paddingBottom:0},children:(0,t.jsxs)("div",{className:n.default.traceNode,style:{width:h.root.duration*k||void 0,height:q-16},children:[(0,t.jsx)(J,{scale:k}),(0,t.jsx)(ee,{events:y,root:h.root,scale:k}),(0,t.jsx)(et,{dispatch:p,events:y,memoCacheRef:h.memoCacheRef,root:h.root,scale:k,scrollSnapshotRef:w,spans:b,timelineRef:f}),(0,t.jsx)(S,{cacheKey:v.get(""),cache:v,root:h.root,scale:k,scrollSnapshotRef:w,spans:b})]})})}),(0,t.jsx)("div",{className:n.default.zoomButtonTraceViewer,children:(0,t.jsx)(Q,{})})]}),u?(0,t.jsx)("div",{className:(0,a.clsx)(n.default.spanDetailPanelTraceViewer,!h.selected&&n.default.hidden,h.isMobile&&n.default.mobile),children:(0,t.jsx)(P,{attached:!0})}):null]})}function eu(e){let{className:r="",children:i=null}=e,{state:l}=x();return l.selected?(0,t.jsx)("div",{className:(0,a.clsx)(n.default.spanDetailPanelTraceViewer,r),style:{position:"relative","--search-height":"0","--search-gap":"0","--map-height":"0","--panel-width":"100%","--panel-height":"100%","--height":"100%","--scrollbar-width":`${l.scrollbarWidth}px`},children:(0,t.jsx)(P,{})}):i}function ed(e){return(0,t.jsx)(g,{getQuickLinks:e.getQuickLinks,withPanel:!0,children:(0,t.jsx)(ec,{withPanel:!0,...e})})}}]);

//# sourceMappingURL=f937ced02d0f02d6.js.map
//# debugId=c2af1887-de2a-5745-a869-e8ed69fa5512
