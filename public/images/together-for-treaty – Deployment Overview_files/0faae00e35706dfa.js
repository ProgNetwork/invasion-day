
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="836eab07-74ea-5756-a577-10fedcc024d7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5758916,7442760,e=>{"use strict";e.s(["DeploymentRow",()=>eR],5758916);var t=e.i(751170),i=e.i(4099374),n=e.i(5499338),l=e.i(6850581),s=e.i(5255926),r=e.i(9508212),a=e.i(1344973),o=e.i(5468328),d=e.i(3981247),c=e.i(57106),u=e.i(8893913),m=e.i(3753138),p=e.i(6226725),x=e.i(5169576),h=e.i(3978547),y=e.i(4004502);e.s(["useDeploymentListScope",()=>j],7442760);var g=e.i(1991452);function j(){let e=(0,g.useRouter)(),t=e.isReady&&"/[teamSlug]/~/deployments"===e.pathname;return{isReady:e.isReady,scope:t?"TEAM_DEPLOYMENTS":"PROJECT_DEPLOYMENTS"}}var f=e.i(1717203),k=e.i(7557283),b=e.i(7957424),v=e.i(7218483),I=e.i(5819220),S=e.i(979715),R=e.i(3872542),C=e.i(7808943),D=e.i(3679047),E=e.i(9722978),A=e.i(8735244),N=e.i(85019),L=e.i(4641028),w=e.i(5356862);function T(e){let{children:i,inProgress:n}=e;return(0,t.jsxs)("div",{className:"flex items-center",children:[i,n?(0,t.jsx)("div",{className:"ml-[7.5px] w-[19.5px]",children:(0,t.jsx)(A.Spinner,{size:12})}):null]})}let M=function(e){let{deployment:i,padLeft:n,showSpinner:l=!0,onlyBuild:r=!1}=e,{teamSlug:a}=(0,D.useParams)()??{},o=(0,v.useAge)(i?.buildingAt||void 0,{includeSeconds:!0}),d=i&&"id"in i?i.id:i?.uid,c=i&&"READY"===i.readyState&&i.checksState,{data:u,checks:m,isLoading:p}=(0,L.default)({deploymentId:c?d:void 0,teamId:a}),x=P(i,m,r)||0,h=i?.undeleted||i?.deleted||i?.createdAt||i?.created,y=h?h+x:void 0,g=i?.deleted!==void 0,j=y?new Date(y).toLocaleDateString(void 0,{hour:"numeric",minute:"2-digit",second:"2-digit",year:"numeric",month:"short",day:"numeric",timeZoneName:"short"}):"",f=(0,v.useAgo)(y,{suffix:" ago",alwaysRelative:!0});if(!i||p&&!u)return(0,t.jsx)(s.Skeleton,{height:16,width:100});let k=i.checksState&&!i.checksConclusion,b=!!("BUILDING"===i.readyState||"READY"===i.readyState&&!i.aliasAssigned&&k),I=function(e,t,i){let n=P(e,t,i);return(0,N.age)(n,{includeSeconds:!0})}(i,m,r)||"—",S=(0,t.jsx)("span",{className:(0,E.clsx)({"pl-[18px]":!b&&n}),suppressHydrationWarning:!0,children:g?(0,t.jsx)("span",{suppressHydrationWarning:!0,title:j,children:f}):(0,t.jsxs)(t.Fragment,{children:[b?o:I,!b&&f?(0,t.jsxs)("span",{suppressHydrationWarning:!0,title:j,children:[" ","(",f,")"]}):null]})});return l?(0,t.jsx)(T,{inProgress:b,children:S}):S};function P(e,t,i){if(!e||"BUILDING"===e.readyState||!("buildingAt"in e))return;let n="readyStateAt"in e?e.readyStateAt:e.ready;if(!n||!e.buildingAt)return;let l=n-e.buildingAt;if(i)return l;let s=t?.length?(0,w.getChecksTimes)(t,e):void 0,r=s?.checksFinishedAt&&s.checksStartedAt?s.checksFinishedAt-s.checksStartedAt:0,a=e.aliasAssignedAt??("number"==typeof e.aliasAssigned?e.aliasAssigned:void 0),o=0;if(a){let e=s?.checksFinishedAt?a-s.checksFinishedAt:a-n;e<18e5&&(o=e)}return l+r+o}var U=e.i(8529990),F=e.i(6625227),B=e.i(6060673),O=e.i(6204417),z=e.i(5071474),_=e.i(7952998),W=e.i(5002318),G=e.i(9334638);function V(e){let{percentage:i}=e,n=(e=>{if(e>=100)return"M8 3.5C10.4853 3.5 12.5 5.51472 12.5 8C12.5 10.4853 10.4853 12.5 8 12.5C5.51472 12.5 3.5 10.4853 3.5 8C3.5 5.51472 5.51472 3.5 8 3.5Z";let t=-Math.PI/2+e/100*2*Math.PI,i=8+4.5*Math.cos(t),n=8+4.5*Math.sin(t);return`M 8 8 L 8 3.5 A 4.5 4.5 0 ${+(e>50)} 1 ${i} ${n} Z`})(i),l=(0,G.withNewIcon)(`<path d="M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8 2.5C4.96243 2.5 2.5 4.96243 2.5 8C2.5 11.0376 4.96243 13.5 8 13.5C11.0376 13.5 13.5 11.0376 13.5 8C13.5 4.96243 11.0376 2.5 8 2.5Z" fill="currentColor" />
     <path d="${n}" fill="currentColor" />`);return(0,t.jsx)(l,{})}var q=e.i(6338279),Y=e.i(9375869),$=e.i(8216525),Z=e.i(3907048),Q=e.i(779588),H=e.i(5326905),J=e.i(8459493),K=e.i(7448864),X=e.i(940143),ee=e.i(455575),et=e.i(7749291),ei=e.i(5338940),en=e.i(545405),el=e.i(4478191),es=e.i(8366444);function er(e){let{isDisabled:i,menuText:n,tidString:l,icon:s,disabledTooltip:d,title:c,onClick:u}=e;return i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Stack,{className:"geist-show-on-mobile",children:(0,t.jsx)(o.Tooltip,{boxAlign:"left",text:d,children:(0,t.jsx)(J.MenuItem,{"data-testid":(0,y.tid)("deployment-entity","dots-menu",l),disabled:!0,suffix:s,children:(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:n})})})})}),(0,t.jsx)(r.Stack,{className:"geist-hide-on-mobile",children:(0,t.jsx)(o.Tooltip,{forceHide:!1,position:"left",style:{width:"100%"},text:d,children:(0,t.jsx)(J.MenuItem,{"data-testid":(0,y.tid)("deployment-entity","dots-menu",l),disabled:!0,style:{width:"100%"},suffix:s,children:(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:n})})})})})]}):(0,t.jsx)(J.MenuItem,{"data-testid":(0,y.tid)("deployment-entity","dots-menu",l),onClick:u,suffix:s,title:c,children:(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:n})})})}var ea=e.i(6619197),eo=e.i(9365163);function ed(e){let{openModal:i,rollingRelease:n,teamSlug:l,projectSlug:s}=e;return er({isDisabled:!1,menuText:"Abort Rollout",tidString:"abort-rollout",icon:(0,t.jsx)(u.RotateCounterClockwise,{}),disabledTooltip:"",title:"Abort Rollout",onClick:()=>{i&&n&&l&&s&&i(l,s,n)}})}function ec(e){let{openModal:i,rollingRelease:n,teamSlug:l,projectSlug:s}=e;return er({isDisabled:!1,menuText:"Force Complete",tidString:"force-complete",icon:(0,t.jsx)(m.ArrowCircleUp,{}),disabledTooltip:"",title:"Force Complete",onClick:()=>{i&&n&&l&&s&&i(l,s,n)}})}function eu(e){let{deployment:i,redeploy:n,handleClickRunInstantly:l,handleClickCreateAlias:s,itemsOnly:r,handleCancelDeployment:a,canPromoteToProduction:o,canRedeployProduction:d,canUpdateDeployment:p,canReadDeployment:x,canRollbackDeployment:h,handleClickRollback:y,isRollingReleaseCanaryDeployment:g,isRollingReleaseActive:j,rollingRelease:f,openCompleteRollingReleaseModal:k,openAbortRollingReleaseModal:b}=e,v=(0,ee.useToasts)(),I=(0,Y.useDeploymentLink)(i),S=a&&("QUEUED"===i.readyState||"BUILDING"===i.readyState),R="READY"===i.readyState,{team:C}=(0,ei.useTeam)(),{enabled:D}=(0,es.useOnDemandConcurrentBuilds)(C,p),E="QUEUED"===i.readyState&&D,A=p||(!("target"in i)||"production"===i.target)&&d,N=o&&A&&p&&x&&h,L=(0,eo.useRollbackTooltip)(i),w=er({isDisabled:!!L,menuText:"Instant Rollback",tidString:"instant-rollback",icon:(0,t.jsx)(u.RotateCounterClockwise,{}),disabledTooltip:L,title:"Instant Rollback",onClick:y}),T=j?"Queue for Promotion":"target"in i&&"production"===i.target?"Promote":"Promote to Production",M=null,P=(0,ea.usePromoteTooltip)(i);o&&(M=(0,t.jsxs)(t.Fragment,{children:[er({isDisabled:!!P,disabledTooltip:P,menuText:T,tidString:"promote",icon:(0,t.jsx)(m.ArrowCircleUp,{}),title:T,onClick:()=>n(i,!0)}),(0,t.jsx)(H.MenuDivider,{})]}));let U=g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(X.MenuSection,{title:"Manage Rolling Release",children:[(0,t.jsx)(ed,{openModal:b,rollingRelease:f,teamSlug:C?.slug,projectSlug:i.name}),(0,t.jsx)(ec,{openModal:k,rollingRelease:f,teamSlug:C?.slug,projectSlug:i.name})]}),(0,t.jsx)(H.MenuDivider,{})]}):(0,t.jsxs)(t.Fragment,{children:[h?w:null,o?M:null]}),F=(0,t.jsxs)(t.Fragment,{children:[o||h?U:null,A?(0,t.jsx)(J.MenuItem,{onClick:()=>n(i),children:"Redeploy"}):null,E&&p?(0,t.jsx)(J.MenuItem,{onClick:l,children:"Start Building Now"}):null,x?(0,t.jsx)(J.MenuItem,{Component:c.Link,href:I,isLink:!0,children:"Inspect Deployment"}):null,x?(0,t.jsx)(J.MenuItem,{Component:c.Link,href:`${I}/source`,isLink:!0,children:"View Source"}):null,x?(0,t.jsx)(J.MenuItem,{onClick:()=>{(0,en.copyToClipboard)(i.url),v.message("Copied to clipboard!")},children:"Copy URL"}):null,R&&p?(0,t.jsx)(J.MenuItem,{onClick:s,children:"Assign Domain"}):null,S&&p?(0,t.jsx)(J.MenuItem,{onClick:()=>a?.(i),type:"error",children:"Cancel Deployment"}):null,x?(0,t.jsxs)(J.MenuItem,{Component:c.Link,disabled:!i,href:(0,el.withDefaultRoute)(`https://${i.url}`,i.defaultRoute),isLink:!0,target:"_blank",children:["Visit   ",(0,t.jsx)(et.ExternalSmall,{})]}):null,!N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.MenuDivider,{}),h?null:(0,t.jsx)(K.MenuItemLocked,{children:"Instant Rollback"}),o?null:(0,t.jsx)(K.MenuItemLocked,{children:"Promote"}),A?null:(0,t.jsx)(K.MenuItemLocked,{children:"Redeploy"}),E&&!p?(0,t.jsx)(K.MenuItemLocked,{children:"Run Build"}):null,x?null:(0,t.jsx)(K.MenuItemLocked,{children:"Inspect Deployment"}),x?null:(0,t.jsx)(K.MenuItemLocked,{children:"View Source"}),x?null:(0,t.jsx)(K.MenuItemLocked,{children:"Copy URL"}),R&&!p?(0,t.jsx)(K.MenuItemLocked,{children:"Assign Domain"}):null,S&&!p?(0,t.jsx)(K.MenuItemLocked,{children:"Cancel Deployment"}):null,x?null:(0,t.jsxs)(K.MenuItemLocked,{children:["Visit   ",(0,t.jsx)(et.ExternalSmall,{})]})]})]});return r?F:(0,t.jsx)(Q.DotsMenu,{closeOnSelect:!1,children:F})}var em=e.i(6143247),ep=e.i(5123268),ex=e.i(4396019);function eh(e){let{datetime:i,label:n,tooltipTop:l}=e;return(0,t.jsx)(o.Tooltip,{text:(0,t.jsx)(W.DeploymentAliasToolTipText,{datetime:i,tooltipTop:l}),children:(0,t.jsx)("div",{style:{pointerEvents:"auto",display:"inline-block"},children:(0,t.jsx)("span",{className:"inline-flex items-center",style:{color:"var(--ds-gray-900)",fontWeight:500,fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%",pointerEvents:"auto",cursor:"default",zIndex:10,position:"relative"},children:n})})})}function ey(e){let{datetime:i}=e,n=(0,v.useAgo)(i);return(0,t.jsx)("span",{children:n})}function eg(e){let{datetime:i}=e;return i?(0,t.jsx)(ey,{datetime:i}):null}var ej=e.i(4206574),ef=e.i(4597921);function ek(e){let{deployment:i}=e,n=(0,g.useRouter)(),{data:l}=(0,B.useProject)(i?.name);return(0,t.jsx)(S.EntityField,{thumbnail:l?(0,t.jsx)(O.ProjectAvatar,{project:l,size:22}):(0,t.jsx)(O.ProjectAvatarSkeleton,{size:22}),thumbnailSize:22,title:l?(0,t.jsx)(c.Link,{href:`/${n.query.teamSlug}/${l.name}`,title:l.name,children:l.name}):i?.name??null})}function eb(e){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(eS,{}),children:(0,t.jsx)(ev,{...e})})}function ev(e){let n,{deployment:l,deploymentsMap:r}=e,a=l?.meta?.originalDeploymentId,o=a?String(a):void 0;o&&(n=r?.get(o));let{data:d,isLoading:p}=(0,F.default)(n?void 0:o,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});d&&(n=d);let x=(0,Y.useDeploymentLink)(n),h=(0,i.useMemo)(()=>n?(0,z.default)(n).hash:"",[n]);if(o){let e=l?.meta?.action==="promote"||l?.target==="production"&&n?.target!=="production";return(0,t.jsx)(S.EntityField,{title:(0,t.jsx)("div",{className:"flex h-[22px] flex-row gap-2 text-[var(--accents-6)]",children:p?(0,t.jsx)(s.Skeleton,{boxHeight:22,height:14,vcenter:!0,width:100}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid place-content-center",children:e?(0,t.jsx)(m.ArrowCircleUp,{}):(0,t.jsx)(u.RotateCounterClockwise,{})}),(0,t.jsxs)("span",{className:"flex min-w-0 items-center gap-[0.3em]",children:[e?"Production Rebuild":"Redeploy"," of"," ",n?(0,t.jsx)(c.Link,{className:"z-[2] flex min-w-0 text-inherit",href:x,title:n.host||"",variant:"secondary",prefetch:!1,children:h?(0,t.jsx)(C.default,{className:"overflow-hidden truncate whitespace-nowrap bg-transparent p-0 text-[13.5px] text-inherit",children:h}):n.host||""}):"a deleted deployment"]})]})}),titleSkeletonWidth:100})}return(0,t.jsx)(eI,{deployment:l,skeletonWidth:100})}function eI(e){let{deployment:i,skeletonWidth:n}=e;return i?(0,t.jsx)(S.EntityField,{description:(0,t.jsx)(_.DeploymentSource,{branchClassName:"text-[13.5px]",commitClassName:"text-[13.5px]",lineClassName:"gap-1 h-[22px] text-black",secondLineLinkClassName:"gap-2",deployment:i}),descriptionSkeletonWidth:n,title:null,titleSkeletonWidth:n}):(0,t.jsx)(eS,{})}function eS(){return(0,t.jsx)(S.EntityField,{className:"h-[44px]",description:null,descriptionSkeletonWidth:100,title:null,titleSkeletonWidth:100})}function eR(e){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(eD,{...e}),children:(0,t.jsx)(eC,{...e})})}function eC(e){let{scope:i}=j(),{deployment:n}=e,{team:l}=(0,ei.useTeam)(),s=(0,ep.useDeploymentsPageRefreshInterval)(),r=e.projectIdOrName??n?.projectId??n?.name,{data:a}=(0,B.useProject)(r,ep.DEPLOYMENTS_PROJECT_API_PARAMS),{deployment:o}=(0,ex.useProjectProductionDeployment)(r,{config:{refreshInterval:s}}),c=n?.customEnvironment?.id&&!n.customEnvironment.slug,{data:u}=(0,b.useCustomEnvironments)(r,{revalidateIfStale:!1,skip:!c}),{data:m}=(0,d.useRollingRelease)({teamIdOrSlug:l?.slug,projectSlug:n?.name},{refreshInterval:s}),p=(0,Y.useDeploymentLink)(n),{can:x,isLoading:h}=(0,f.default)({projectIdOrName:r}),{deploymentTargetLabel:y}=(0,q.useDeploymentEnvironmentLabel)({deployment:n,customEnvironments:u?.customEnvironments}),g=(0,ef.useServerFlag)("promotion-status-visible",!1);return(0,t.jsx)(eD,{...e,arePermissionsLoading:h,can:x,deploymentLink:p,deploymentTargetLabel:y,isCurrentProductionDeployment:o?.id===n?.uid,rollingRelease:m?.rollingRelease??void 0,project:a,isProjectDeploymentsPage:"PROJECT_DEPLOYMENTS"===i,promotionStatusVisibleFlag:g})}let eD=(0,i.memo)(function(e){let{deployment:s,deploymentsMap:d,isCurrentProductionDeployment:g,rollingRelease:j,redeploy:f,handleClickCreateAlias:b,handleCancelDeployment:C,handleClickRunInstantly:D,project:E,openRollbackModal:A,projectCellEnabled:N,deploymentLink:L,can:w,arePermissionsLoading:T,deploymentTargetLabel:P,skeleton:F,openCompleteRollingReleaseModal:B,openAbortRollingReleaseModal:O,isProjectDeploymentsPage:_,promotionStatusVisibleFlag:G}=e,q=E?.lastAliasRequest?.type==="rollback"&&E.lastAliasRequest.toDeploymentId===s?.uid,Y=E?.lastAliasRequest?.type==="rollback"&&E.lastAliasRequest.fromDeploymentId===s?.uid,Q=q&&E.lastAliasRequest?.requestedAt||s?.created||0,H=(0,v.useAgo)(Q),J=s?(0,U.getGitInfoFromDeployment)(s):null,K=s?.meta?.deployHookId||void 0,X=(e,t)=>w?.(e,t)??!1,ee=!!(E&&T),et=s?.target!==null?k.Resource.Deployment:k.Resource.DeploymentPreview,ei=X(k.Action.Update,et),en=X(k.Action.Read,et),el=X(k.Action.Create,k.Resource.DeploymentRollback),es=X(k.Action.Create,k.Resource.Deployment),er=X(k.Action.Create,k.Resource.DeploymentFromProductionBranch),ea=!ee&&(es||er||ei||en||el),eo=(0,i.useMemo)(()=>(0,z.default)(s).hash,[s]),ed=null,ec=j?.state==="ACTIVE"&&!!(j.canaryDeployment?.id&&j.canaryDeployment.id===s?.uid),ep=j?.state==="ACTIVE"&&!!(j.queuedDeploymentId&&j.queuedDeploymentId===s?.uid),ex=null,ey=(0,ej.getPromotionStatusInfo)({deployment:s,rollingRelease:j,project:E});G&&(ex=ey?(0,t.jsx)(S.EntityField,{description:(0,t.jsx)("span",{className:"block h-[20px] tabular-nums",children:(0,t.jsx)(eg,{datetime:ey.datetime})}),descriptionSkeletonWidth:120,descriptionWrap:!1,title:(0,t.jsx)(eh,{...ey}),titleSkeletonWidth:80,width:120}):(0,t.jsx)(S.EntityField,{width:120}));let ef=ey?(0,t.jsx)(W.DeploymentAliasToolTipText,{datetime:ey.datetime,tooltipTop:ey.tooltipTop}):null;if(g)ed=q?(0,t.jsx)(o.Tooltip,{className:"translate-y-px",text:ef,children:(0,t.jsx)(n.Badge,{icon:(0,t.jsx)(u.RotateCounterClockwise,{}),size:"sm",variant:"amber-subtle",children:"Current"})}):(0,t.jsx)(o.Tooltip,{className:"translate-y-px",text:ef,children:(0,t.jsx)(n.Badge,{icon:(0,t.jsx)(m.ArrowCircleUp,{}),size:"sm",variant:"blue-subtle",children:"Current"})});else if(ec){let{activeStage:e}=j,i=e?.targetPercentage;ed=(0,t.jsx)(o.Tooltip,{className:"translate-y-px",text:ef,children:(0,t.jsx)(n.Badge,{icon:"number"==typeof i?(0,t.jsx)(V,{percentage:i}):null,size:"sm",variant:"blue-subtle",children:"Canary"})})}else Y?ed=(0,t.jsx)(o.Tooltip,{className:"translate-y-px",text:ef,children:(0,t.jsx)(n.Badge,{icon:(0,t.jsx)(p.CrossCircle,{}),size:"sm",variant:"red-subtle",children:"Rolled Back"})}):s?.readySubstate!=="PROMOTED"||G||(ed=(0,t.jsx)(o.Tooltip,{text:ef,children:(0,t.jsx)(x.Information,{color:"gray-900",size:14})}));return ep&&(ed=(0,t.jsx)(n.Badge,{icon:(0,t.jsx)(h.ClockDashed,{}),size:"sm",variant:"blue-subtle",children:"Upcoming Canary"})),s?.readySubstate!=="STAGED"||"production"!==s.target||G||(P=P?.concat(": Staged")),(0,t.jsxs)(I.Entity,{className:(0,em.cn)("rounded border border-solid border-gray-alpha-400 md:border-0 md:[&:not(:first-of-type)]:rounded-t-[0px] md:[&:not(:first-of-type)]:border-t",{"deployment-entity":s,"shadow-[inset_4px_0_0_var(--geist-warning)] rounded-none":q&&g,"md:[&:not(:first-of-type)]:mt-[-1px]":F}),"data-testid":(0,y.tid)("deployments","deployment-entity",s?.uid??"no-uid"),disabledDotMenuTooltip:ea?void 0:(0,t.jsxs)(t.Fragment,{children:["Additional permissions are required to manage Deployment."," ",(0,t.jsx)(c.Link,{href:"/docs/deployments/managing-deployments",variant:"highlight",children:"Learn More →"})]}),isDotMenuDisabled:!ea,menuButtonProps:{"aria-label":"Deployment Actions","data-testid":(0,y.tid)("deployment-entity","dots-menu","button")},menuItems:s&&_?(0,t.jsx)(eu,{canPromoteToProduction:es,canReadDeployment:en,canRedeployProduction:er,canRollbackDeployment:el,canUpdateDeployment:ei,deployment:s,handleCancelDeployment:()=>C?.(s),handleClickCreateAlias:()=>b?.(s),handleClickRollback:()=>{A&&A(g?void 0:s)},handleClickRunInstantly:()=>D?.(s),isRollingReleaseCanaryDeployment:ec,isRollingReleaseActive:j?.state==="ACTIVE",itemsOnly:!0,redeploy:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return f?.(...t)},rollingRelease:j,openCompleteRollingReleaseModal:B,openAbortRollingReleaseModal:O}):null,menuListTestId:`${s?.uid??"no-uid"}-dots-menu`,placeholder:!s,children:[s?(0,t.jsx)(R.PropagatedPropsOmitter,{children:(0,t.jsx)(c.Link,{className:"absolute -inset-4 z-[1]",href:L,prefetchStrategy:"hover"})}):null,(0,t.jsx)(S.EntityField,{"data-testid":(0,y.tid)("deployment-entity","target"),descriptionWrap:!1,description:s?(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1,style:{position:"relative",zIndex:1},children:[P,ed]}):null,descriptionSkeletonWidth:80,title:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(c.Link,{href:L,prefetchStrategy:"hover",style:{display:"flex",alignItems:"center",gap:8},title:s?.url,children:(0,t.jsx)(a.Text,{size:14,truncate:!0,weight:600,children:eo})})}),titleSkeletonWidth:220,minWidth:140}),(0,t.jsx)(S.EntityField,{description:(0,t.jsx)("span",{className:"block h-[20px] tabular-nums",children:(0,t.jsx)(M,{deployment:s,onlyBuild:!0})}),descriptionSkeletonWidth:146,descriptionWrap:!1,title:s?(0,t.jsx)($.DeploymentStatus,{deployment:s,label:!0,labelStyle:{color:"var(--ds-gray-900)",fontWeight:400},labelWeight:500}):null,titleSkeletonWidth:146,width:146}),ex,N?(0,t.jsx)(ek,{deployment:s}):null,(0,t.jsx)(eb,{deployment:s,deploymentsMap:d}),(0,t.jsx)(S.EntityField,{avatar:s?(0,t.jsx)(Z.CreatorAvatar,{deployment:s,showProviderIcon:!0,size:24}):null,className:"z-[2]",description:s?(0,t.jsxs)(l.RelativeTimeCard,{date:Q,side:"left",children:[H,void 0===K&&(!s.meta?.originalDeploymentId&&J?.commitAuthorLogin?` by ${J.commitAuthorLogin}`:` by ${s?.creator.username}`),void 0!==K&&" via Deploy Hook"]}):null,right:!0})]})})},1122901,e=>{"use strict";e.s(["default",()=>R,"getReadyStateFilter",()=>b,"useFilterStatus",()=>I]);var t=e.i(751170),i=e.i(4099374),n=e.i(9722978),l=e.i(3679047),s=e.i(1991452),r=e.i(9508212),a=e.i(5255926),o=e.i(1344973),d=e.i(5499338),c=e.i(4991687),u=e.i(8674454),m=e.i(8459493),p=e.i(6694387),x=e.i(6143247),h=e.i(7151748),y=e.i(3870297);let g={READY:{label:"Ready",className:"bg-[var(--geist-cyan)]",key:"ready"},ERROR:{label:"Error",className:"bg-[var(--geist-error)]",key:"error"},BUILDING:{label:"Building",className:"bg-[var(--geist-warning)]",key:"building"},QUEUED:{label:"Queued",className:"bg-[var(--accents-2)]",key:"queued"},INITIALIZING:{label:"Provisioning",className:"bg-[var(--accents-2)]",key:"initializing"},CANCELED:{label:"Canceled",className:"bg-[var(--accents-2)]",key:"canceled"}},j=["ready","error","building","queued","initializing"],f="empty";function k(e){let{status:i,...l}=e;return(0,t.jsx)("span",{className:(0,n.clsx)("inline-block w-[10px] h-[10px] rounded-[5px] border border-solid border-[var(--geist-background)] transition-colors duration-200 ease",i),...l})}function b(e){let t=Object.keys(e).filter(t=>e[t]).map(e=>e.toUpperCase());return 0===t.length?f:t.join(",")}let v={[g.INITIALIZING.key]:!0,[g.READY.key]:!0,[g.ERROR.key]:!0,[g.BUILDING.key]:!0,[g.QUEUED.key]:!0,[g.CANCELED.key]:!1};function I(){let e=(0,s.useRouter)(),t=(0,l.usePathname)(),n=(0,l.useSearchParams)(),[r,a]=(0,i.useState)(!0),[o,d]=(0,i.useState)(v);return(0,i.useEffect)(()=>{if(r&&e.isReady){var t;d((t=e.query.status)?t===f?{[g.INITIALIZING.key]:!1,[g.READY.key]:!1,[g.ERROR.key]:!1,[g.BUILDING.key]:!1,[g.QUEUED.key]:!1,[g.CANCELED.key]:!1}:{[g.INITIALIZING.key]:t.includes(g.INITIALIZING.key),[g.READY.key]:t.includes(g.READY.key),[g.ERROR.key]:t.includes(g.ERROR.key),[g.BUILDING.key]:t.includes(g.BUILDING.key),[g.QUEUED.key]:t.includes(g.QUEUED.key),[g.CANCELED.key]:t.includes(g.CANCELED.key)}:{[g.INITIALIZING.key]:!0,[g.READY.key]:!0,[g.ERROR.key]:!0,[g.BUILDING.key]:!0,[g.QUEUED.key]:!0,[g.CANCELED.key]:!1}),a(!1)}},[e.query.status,e.isReady,r]),(0,i.useEffect)(()=>{if(r)return;let i=new URLSearchParams(n??{}),l=function(e){let t=Object.keys(e).filter(t=>e[t]).sort().join(",");return j.sort().join(",")===t?null:""===t?f:t}(o);l?i.set("status",l):i.delete("status"),n&&n.get("status")!==i.get("status")&&e.isReady&&e.replace({pathname:t,query:i.toString()},void 0,{scroll:!1})},[r,o,e,e.query.status,n,t]),{isInitialStatusItems:Object.entries(o).every(e=>{let[t,i]=e;return v[t]===i}),selectedStatusItems:o,clearStatus(){d(v)},handleSelectStatusItem:e=>{d(t=>{let i={...t,[e]:!t[e]};return h.analytics.track(y.AnalyticsEvent.DEPLOYMENT_OVERVIEW_FILTERS_STATUS,{status:JSON.stringify(i)}),i})},selectStatusFilterValues:Object.keys(o).filter(e=>o[e]).map(e=>e.toUpperCase())}}let S=(0,t.jsx)("svg",{className:"ml-auto",fill:"none",height:"18",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"18",children:(0,t.jsx)("path",{d:"M20 6L9 17l-5-5"})});function R(e){let{className:l,selectedStatusItems:s,handleSelectStatusItem:h,menuButtonClassName:y,skeleton:j=!1,position:f="right"}=e,[b,v]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{j||v(!0)},[j]),(0,t.jsx)("div",{className:(0,n.clsx)("left"===f&&"mr-[var(--geist-space-2x)] max-[600px]:mb-[var(--geist-space-2x)] max-[600px]:mr-0","right"===f&&"ml-0 mr-[var(--geist-space-2x)] max-[997px]:mb-[var(--geist-space-2x)] max-[997px]:ml-0 max-[997px]:mr-[var(--geist-space-2x)] max-[600px]:mx-0",l),children:(0,t.jsx)(a.Skeleton,{show:!!(j&&!b),children:(0,t.jsxs)(c.MenuContainer,{closeOnSelect:!1,children:[(0,t.jsx)(p.MenuButton,{align:"flex-grow",className:(0,x.cn)(y),showChevron:!0,type:"secondary",children:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",flex:1,children:[(0,t.jsx)("div",{className:"[&>span]:ease w-[45px] text-left [&>span]:relative [&>span]:border [&>span]:border-solid [&>span]:border-[var(--themed-bg,var(--ds-background-100))] [&>span]:transition-colors [&>span]:duration-200",children:Object.values(g).map((e,i)=>{let{key:n,className:l}=e;return(0,t.jsx)(k,{status:s[n]?l:"bg-[var(--geist-background)] shadow-[inset_0_0_0_1px_var(--accents-2)]",style:{left:`${-4*i}px`}},n)})}),(0,t.jsx)("span",{className:"font-normal text-[var(--geist-foreground)] max-[600px]:text-sm",children:"Status"}),(0,t.jsxs)(d.Badge,{className:"-mr-1 ml-2 h-5 min-w-8 bg-gray-300 px-1.5 text-xs font-medium tabular-nums",variant:"gray-subtle",children:[Object.values(s).filter(Boolean).length,"/",Object.values(g).length]})]})}),(0,t.jsx)(u.Menu,{width:186,children:Object.values(g).map(e=>{let{key:i,className:n,label:l}=e;return(0,t.jsxs)(m.MenuItem,{onClick:()=>h(i),children:[(0,t.jsx)(k,{status:n}),(0,t.jsx)(o.Text,{className:"ml-[var(--geist-space-2x)]",children:l}),s[i]?S:null]},i)})})]})})})}},4029500,e=>{"use strict";e.s(["FilteredBranchEntityBar",()=>T],4029500);var t=e.i(751170),i=e.i(4099374),n=e.i(8459493),l=e.i(5255926),s=e.i(9318197),r=e.i(9508212),a=e.i(1344973),o=e.i(455575),d=e.i(57106),c=e.i(1201436),u=e.i(4345845),m=e.i(6107899),p=e.i(6942035),x=e.i(7151748),h=e.i(9220774),y=e.i(5819220),g=e.i(979715),j=e.i(4712634),f=e.i(4450569),k=e.i(8529990),b=e.i(6625227),v=e.i(545405),I=e.i(5887909),S=e.i(8735244),R=e.i(5468328),C=e.i(6401841),D=e.i(2988836);function E(e){let{children:i,header:n,text:l}=e;return(0,t.jsx)(R.Tooltip,{maxWidth:278,text:(0,t.jsxs)(r.Stack,{as:"span",gap:0,children:[(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:1,justify:"center",children:n}),(0,t.jsx)(I.Balancer,{children:(0,t.jsx)(a.Text,{as:"span",children:l})})]}),children:i})}let A={building:{text:"Link can be shared now—it will open a page with a loading indicator until build completes",content:(0,t.jsx)(S.Spinner,{style:{overflow:"revert"},size:16})},ready:{text:"View of latest deployment on branch—updates automatically",content:(0,t.jsx)(D.InformationFillSmall,{})},failed:{text:"Domain was not updated because checks failed",content:(0,t.jsx)(C.Stop,{})}};function N(e){let{state:i}=e;return(0,t.jsx)(E,{header:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.GitBranch,{}),(0,t.jsx)(a.Text,{as:"span",weight:600,children:"Branch Link"})]}),text:A[i].text,children:A[i].content})}var L=e.i(2695633),w=e.i(4396019);let T=(0,i.memo)(e=>{let{project:I,branch:S,deployments:R,isLoading:C,onClearBranch:D}=e,E=function(e){let t=e?.find(e=>"READY"===e.readyState);if(t)return t;let i=e?.find(e=>"BUILDING"===e.readyState);return i||null}(R),A=(0,o.useToasts)(),{deployment:T}=(0,w.useProjectProductionDeployment)(I?.id),{data:M,isValidating:P}=(0,b.default)(E?.uid,{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:!0}),U=(0,k.getGitInfoFromDeployment)(E),F=I?.link?.type||"github",B=U?.prUrl??U?.refUrl??U?.commitUrl??"",O=(0,L.getGitMeta)(T?.meta),z=C||P,_=M?.alias[0]??M?.url,W=((e,t)=>{let n=(0,i.useRef)(0);return t||(n.current=Math.random()),(0,i.useMemo)(()=>e(),[n.current])})(()=>(0,t.jsxs)(y.Entity,{className:"shadow-small border border-[var(--ds-gray-alpha-400)] !bg-[var(--ds-background-100)] bg-clip-padding",filled:!0,placeholder:z,thumbnail:(0,t.jsx)(j.EntityThumbnail,{circular:!0,size:30,children:(0,t.jsx)(u.GitBranch,{style:{transform:"translateX(0.5px)"}})}),...!!B&&!z&&{menuItems:(0,t.jsxs)(t.Fragment,{children:[_?(0,t.jsx)(n.MenuItem,{href:`https://${_}`,isLink:!0,prefix:(0,t.jsx)(m.PreviewEye,{}),target:"_blank",children:"Visit Preview"}):null,(0,t.jsxs)(n.MenuItem,{onClick:()=>{(0,v.copyToClipboard)(B),A&&A.current&&A.current.message("Copied URL to clipboard!")},prefix:(0,t.jsx)(c.Copy,{}),children:["Copy ",U?.prUrl?"PR":"Branch"," URL ",(0,t.jsx)(s.Spacer,{})," "]}),(0,t.jsx)(n.MenuItem,{onClick:D,prefix:(0,t.jsx)(p.Cross,{}),type:"error",children:"Remove Filter"})]})},children:[(0,t.jsx)(g.EntityField,{description:B?(0,t.jsxs)("div",{children:["Branch link for"," ",(0,t.jsx)(d.Link,{href:B,children:(0,t.jsx)(a.Text,{as:"span",color:"inherit",monospace:!0,children:S})})]}):(0,t.jsx)("span",{children:S}),title:_?(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(d.Link,{className:"inline font-medium",href:`https://${_}`,onClick:()=>{x.analytics.track(h.CoreAnalyticsEvents.CLICK_EVENT,{click_name:"click_button",click_value:"deployments_page_primary_preview_deployments"})},variant:"highlight",children:_}),(0,t.jsx)(N,{state:E?.readyState==="BUILDING"?"building":"ready"})]}):(0,t.jsx)("div",{className:"mb-[2px]",children:"No successful deploy, yet."})}),(0,t.jsx)(g.EntityField,{className:"sm:max-w-fit",right:!0,children:(0,t.jsx)(f.default,{center:!0,row:!0,children:z?(0,t.jsxs)(f.default,{center:!0,className:"flex flex-row gap-4",row:!0,children:[(0,t.jsx)(l.Skeleton,{height:32,width:130}),(0,t.jsx)(l.Skeleton,{style:{width:32,height:32}})]}):(0,t.jsxs)(t.Fragment,{children:[!!U?.prUrl&&(0,t.jsx)(d.ButtonLink,{href:U.prUrl,prefix:(0,t.jsx)("span",{className:"size-4 [&>svg]:size-4",children:O?.logo}),size:"small",tab:!0,type:"secondary",children:"github"===F?"View PR":"View Changes"}),!U?.prUrl&&!!U?.refUrl&&(0,t.jsx)(d.ButtonLink,{href:U?.refUrl,prefix:(0,t.jsx)(u.GitBranch,{style:{transform:"translateX(4px)"}}),size:"small",tab:!0,type:"secondary",children:"View Branch"})]})})})]}),z);return z||S?W:null})}]);

//# sourceMappingURL=7058ade52d9d4ae7.js.map
//# debugId=836eab07-74ea-5756-a577-10fedcc024d7
