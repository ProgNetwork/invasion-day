
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="86a20c5c-01a5-5a4a-a8f9-95c4bc1aec70")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2270547,e=>{"use strict";e.s(["useDeploymentOverviewProject",()=>r]);var t=e.i(3679047),n=e.i(818351),i=e.i(134877),a=e.i(7952834);function r(e){let{teamSlug:r}=(0,t.useParams)()??{};return(0,n.useIsomorphicSWR)(e?(0,a.getProjectKey)(e,{apiVersion:"v10",teamId:r,activeBranches:!0,latestDeployments:10,fetchParams:{rollbackInfo:!0}}):null,async(e,t)=>{try{let n=await t(e);return(0,a.transformDeploymentOverviewProject)(n)}catch(e){if((0,i.isAPIErrorForbidden)(e)||(0,i.isAPIErrorNotFound)(e))return null;throw e}})}},3511954,e=>{"use strict";e.s(["DeploymentOverviewMetadata",()=>s],3511954);var t=e.i(751170),n=e.i(3679047),i=e.i(9893476),a=e.i(100247),r=e.i(9948865);let l={QUEUED:`${r.favIconFolder}/queued.ico`,BUILDING:`${r.favIconFolder}/building.ico`,READY:`${r.favIconFolder}/success.ico`,ERROR:`${r.favIconFolder}/error.ico`,CANCELED:`${r.favIconFolder}/queued.ico`,DELETED:`${r.favIconFolder}/building.ico`,INITIALIZING:`${r.favIconFolder}/building.ico`,UPLOADING:`${r.favIconFolder}/building.ico`,DEPLOYING:`${r.favIconFolder}/building.ico`};var o=e.i(2270547);function s(){let e=(0,n.useParams)(),{data:r,isLoading:s}=(0,i.useDashboardDeployment)({deploymentId:e?.id,projectName:e?.project,teamSlug:e?.teamSlug}),{data:c}=(0,o.useDeploymentOverviewProject)(e?.project),{areChecksRunning:d,areDomainsAssigning:u}=(0,a.getDeploymentStatus)(r),p=(e=>{let{readyState:t,otherBitsRunning:n,hasFailure:i}=e;return n?l.BUILDING:i?l.ERROR:t&&l[t]?l[t]:void 0})({readyState:r?.readyState,otherBitsRunning:d||u,hasFailure:r?.checksConclusion==="failed"||!!r?.aliasError});return(!s||r)&&p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("title",{children:c?.name?`${c.name} – Deployment Overview`:"Deployment Overview"}),(0,t.jsx)("link",{href:p,rel:"icon shortcut",type:"image/x-icon"},"active-favicon")]}):null}},6922402,e=>{"use strict";e.s(["DeploymentActions",()=>a]);var t=e.i(4099374),n=e.i(3679047),i=e.i(229875);function a(){let{teamSlug:e,project:a}=(0,n.useParams)()??{},{data:r}=(0,i.useDeploymentInterval)(),l=(0,n.useRouter)(),o=(0,n.useSearchParams)(),s=(0,t.useRef)(!1),c=o?.get("redirect");return(0,t.useEffect)(()=>{r?.project&&r.project.name!==a&&l.replace(`/${e}/${r.project.name}/${r.id.replace(/^dpl_/,"")}`)},[r,e,a,l]),(0,t.useEffect)(()=>{c&&!s.current&&r&&"READY"===r.readyState&&!r.public&&(s.current=!0,l.push(`https://${r.host}`))},[r,c,l]),null}},1156644,e=>{"use strict";e.s(["ProjectFeatures",()=>x,"ProjectFeaturesSkeleton",()=>h],1156644);var t=e.i(751170),n=e.i(3679047),i=e.i(5499338),a=e.i(1344973),r=e.i(3870297),l=e.i(7151748),o=e.i(5338940),s=e.i(57106),c=e.i(85322),d=e.i(2270547),u=e.i(229875),p=e.i(1717203),m=e.i(7557283);function h(){return(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsx)("div",{className:"flex w-full flex-col items-stretch gap-3 [@media(min-width:1070px)]:flex-row",children:c.ProjectFeatureList.map(e=>(0,t.jsx)(y,{feature:e},e.name))})})}function x(){let{project:e}=(0,n.useParams)()??{},{data:i}=(0,u.useDeploymentInterval)(),{team:a}=(0,o.useTeam)(),{data:r}=(0,d.useDeploymentOverviewProject)(e),l=a?.billing?.plan,{can:s,isLoading:h}=(0,p.default)();return(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsx)("div",{className:"flex w-full flex-col items-stretch gap-3 [@media(min-width:1070px)]:flex-row",children:c.ProjectFeatureList.map(e=>(0,t.jsx)(g,{billingPlan:l,enabled:e.isEnabled(i),feature:e,hasData:e.hasData(i,r||void 0),isNew:e.isNew,loading:!i||!r,projectId:i?.projectId,noPermissions:!s(m.Action.Read,e.rbacResource)&&!h},e.name))})})}function y(e){let{feature:n}=e;return(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-1.5 rounded bg-background-100 box-decoration-clone py-2.5 pl-4 pr-2 no-underline shadow-md transition-shadow hover:shadow-lg",style:{height:"auto",flex:1},children:[(0,t.jsx)(c.IconWrapper,{className:"-ml-2 [@media(min-width:1070px)]:hidden",variant:"secondary",children:n.icon}),(0,t.jsxs)("div",{className:"mb-0.5 w-full flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Text,{className:"flex-1",weight:600,children:n.name}),(0,t.jsx)("div",{className:"h-6"})]}),(0,t.jsx)(a.Text,{className:"whitespace-normal",color:"gray-700",variant:"copy-13",children:n.descriptionShort||n.description})]})]})}function g(e){let{feature:o,enabled:d,projectId:u,loading:p,hasData:m,isNew:h,billingPlan:x,noPermissions:y}=e,g=function(e){let t=(0,n.usePathname)();return`${t?t.split("/").slice(0,3).join("/"):""}${e.link}`}(o),j=()=>p?null:h?(0,t.jsx)(i.Badge,{variant:"blue-subtle",children:"New"}):y?(0,t.jsx)(i.Badge,{variant:"gray-subtle",children:"Missing Permissions"}):d?m?null:(0,t.jsx)(i.Badge,{variant:"amber-subtle",children:"No Data"}):(0,t.jsx)(i.Badge,{className:"!bg-gray-alpha-100",variant:"gray-subtle",children:"Not Enabled"}),b={className:`flex flex-1 items-center gap-1.5 rounded bg-background-100 box-decoration-clone py-2.5 pl-4 pr-2 no-underline shadow-md transition-shadow ${y?"cursor-not-allowed opacity-60":"hover:shadow-lg"}`,style:{height:"auto",flex:1}};return y?(0,t.jsxs)("div",{...b,children:[(0,t.jsx)(c.IconWrapper,{className:"-ml-2 [@media(min-width:1070px)]:hidden",variant:"secondary",children:o.icon}),(0,t.jsxs)("div",{className:"mb-0.5 w-full flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Text,{className:"flex-1",weight:600,children:o.name}),j()||(0,t.jsx)("div",{className:"h-6"})]}),(0,t.jsx)(a.Text,{className:"whitespace-normal",color:"gray-700",variant:"copy-13",children:o.descriptionShort||o.description})]})]}):(0,t.jsxs)(s.Link,{...b,href:g,onClick:()=>{u&&l.analytics.track(r.AnalyticsEvent.DEPLOYMENT_PROJECT_FEATURE_CTA_CLICKED,{enabled:d,feature:o.id,projectId:u,plan:x})},children:[(0,t.jsx)(c.IconWrapper,{className:"-ml-2 [@media(min-width:1070px)]:hidden",variant:"secondary",children:o.icon}),(0,t.jsxs)("div",{className:"mb-0.5 w-full flex-1 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Text,{className:"flex-1",weight:600,children:o.name}),j()||(0,t.jsx)("div",{className:"h-6"})]}),(0,t.jsx)(a.Text,{className:"whitespace-normal",color:"gray-700",variant:"copy-13",children:o.descriptionShort||o.description})]})]})}},449013,e=>{"use strict";e.s(["DeploymentSteps",()=>c,"DeploymentStepsSkeleton",()=>s]);var t=e.i(751170),n=e.i(222158),i=e.i(3679047);e.i(5224197);var a=e.i(7442785),r=e.i(229875),l=e.i(1367170),o=e.i(855127);function s(e){return(0,t.jsx)(n.Root,{defaultValue:[],disabled:!0,className:"rounded bg-background-100 shadow-sm",type:"multiple",children:(0,t.jsx)(l.DeployStepsSkeleton,{...e})})}function c(){let{data:e,mutate:n}=(0,r.useDeploymentInterval)(),{teamSlug:l}=(0,i.useParams)()??{},{expandedSteps:s,setExpandedSteps:c}=(0,o.useExpandedSteps)(e);return(0,t.jsx)(a.DeploySteps,{creationFlow:!1,deployment:e,enableLineHighlighting:!0,expandedSteps:s,mutateDeployment:n,onExpandedStepsChange:c,teamSlug:l})}},3212616,3349841,e=>{"use strict";e.s(["useCurrentDashboardDeploymentOverviewProject",()=>i],3212616);var t=e.i(3679047),n=e.i(9850094);function i(e){let{project:i,teamSlug:a}=(0,t.useParams)()??{};if(!a||!i)throw Error("Missing params");return(0,n.useDashboardDeploymentOverviewProject)({projectSlug:i,teamSlug:a},e)}e.s(["useIsCurrentProductionDeployment",()=>r],3349841);var a=e.i(4396019);function r(e){let{project:n}=(0,t.useParams)()??{},{deployment:i}=(0,a.useProjectProductionDeployment)(n);return!!(e&&i?.id===(e.id||e.uid))}},946578,6293744,e=>{"use strict";e.s(["DeploymentModalsProvider",()=>E,"useDeploymentModals",()=>L],946578);var t=e.i(751170),n=e.i(4099374),i=e.i(8159863),a=e.i(3212616),r=e.i(5129431),l=e.i(2645806),o=e.i(9365163),s=e.i(6619197),c=e.i(57106),d=e.i(4030453),u=e.i(6891161),p=e.i(9318197),m=e.i(1344973),h=e.i(455575),x=e.i(4004502),y=e.i(277234),g=e.i(4244280),j=e.i(5338940),b=e.i(609109),f=e.i(2695633),v=e.i(3679047),w=e.i(9716741),k=e.i(2270547);let C=(0,n.memo)(function(e){let{active:i,onClose:a,deployment:r,teamId:l}=e,[o,s]=(0,n.useState)(!1),c=(0,v.useRouter)(),{teamSlug:d,project:p}=(0,v.useParams)()??{},{data:m}=(0,k.useDeploymentOverviewProject)(p),h=(0,n.useCallback)(async()=>{s(!0);let e=l?`?teamId=${l}`:"";await (0,y.fetchAPI)(`${(0,g.API_DEPLOYMENTS)("v2")}/${r.id}${e}`,{throwOnHTTPError:!0,method:"DELETE"}),c.replace(`/${d??""}/${encodeURIComponent(m?.name||"")}?deploymentDeleted=1`),s(!1)},[r,l,c,m,d]);return(0,t.jsxs)(u.Modal.Modal,{active:i,onClickOutside:a,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Delete Deployment"})}),(0,t.jsxs)(w.default,{preset:"body-2",children:[(0,t.jsx)("b",{children:"NOTE:"})," Deployments that are not actively receiving any traffic do not generate any costs nor count towards any limits."]}),(0,t.jsx)(w.default,{preset:"body-2",children:"Deleting this deployment will prevent you from instantly reverting and might break links used in integrations, such as the ones in the pull requests of your Git provider."}),(0,t.jsx)(w.default,{preset:"body-2",style:{marginBottom:0},children:"Are you sure you want to continue?"})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:a,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{disabled:o,loading:o,onClick:h,children:"Delete"})]})]})});e.s(["useDeploymentPermissions",()=>I],6293744);var D=e.i(1857939),S=e.i(1717203),A=e.i(7557283);function I(e){let{project:t,deployment:n}=e,{can:i,isLoading:a}=(0,S.default)({projectIdOrName:t?.name}),{isLoggedOut:r}=(0,D.useIsLoggedIn)(),l=n?.target!==null?A.Resource.DeploymentFromProductionBranch:A.Resource.DeploymentPreview,o=i(A.Action.Create,l),s=i(A.Action.Update,l),c=i(A.Action.Read,l)||!!(r&&n?.public),d=i(A.Action.Delete,l);return{isLoading:a,permissions:{canCreateDeployment:o,canUpdateDeployment:s,canReadDeployment:c,canDeleteDeployment:d,canPromoteToProduction:i(A.Action.Create,A.Resource.Deployment),canUpdateSkewProtection:i(A.Action.Update,A.Resource.SkewProtection)}}}var T=e.i(3349841);let N=(0,n.createContext)(void 0);function E(e){let{children:i}=e,[a,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)({openRedeployModal:()=>{},openCancelDeploymentModal:()=>{},openPromoteToProductionModal:()=>{},openInstantRollbackModal:()=>{},openSkewProtectionModal:()=>{},openDeleteDeploymentModal:()=>{},canRollbackDeployment:!1,isLoadingModals:a});return(0,t.jsxs)(N.Provider,{value:l,children:[i,(0,t.jsx)(n.Suspense,{fallback:null,children:(0,t.jsx)(P,{setIsLoadingModals:r,setModalsContext:o})})]})}function P(e){let{setIsLoadingModals:n,setModalsContext:i}=e,{data:r}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return r?(0,t.jsx)(M,{project:r,setIsLoadingModals:n,setModalsContext:i}):null}function M(e){let{setIsLoadingModals:a,setModalsContext:v,project:w}=e,{data:k,mutate:D}=(0,i.useCurrentDashboardDeploymentInterval)(),{permissions:S}=I({project:w,deployment:k}),A=(0,T.useIsCurrentProductionDeployment)(),{modal:N,open:E}=(0,r.default)(w),{canRollbackDeployment:P,rollbackModal:M,openRollbackModal:L}=(0,o.useInstantRollbackModal)(w),{modal:R,open:O}=function(e){let[i,a]=(0,n.useState)(!1),[r,l]=(0,n.useState)(!1),[o,s]=(0,n.useState)(null),[v,w]=(0,n.useState)(null),k=(0,h.useToasts)(),{team:C}=(0,j.useTeam)(),D=C?.id,S=(0,f.getGitMeta)(o?.meta),A=(0,n.useCallback)(e=>{s(e),a(!0)},[]),I=(0,n.useCallback)(()=>{a(!1)},[]),T=(0,n.useCallback)(()=>{l(!1),s(null),w(null)},[]),N=(0,n.useCallback)(()=>{if(!e)throw w({message:"projectIdOrName is required to save skew protection"}),Error("projectIdOrName is required to save skew protection");if(!o)throw w({message:"deployment is required to save skew protection"}),Error("deployment is required to save skew protection");l(!0),w(null),(0,y.fetchAPI)(`${(0,g.API_PROJECTS_VERSION)("v9")}/${encodeURIComponent(e)}${D?`?teamId=${D}`:""}`,{method:"PATCH",body:JSON.stringify({skewProtectionBoundaryAt:o.createdAt}),throwOnHTTPError:!0}).then(e=>{e&&(k.success("Successfully configured Skew Protection."),I())}).catch(e=>{w(e)}).finally(()=>{l(!1)})},[e,o,D,k,I]);return{modal:(0,n.useMemo)(()=>(0,t.jsxs)(u.Modal.Modal,{active:i,"data-testid":(0,x.tid)("skew-protection-modal","modal"),onAnimationDone:T,onClickOutside:I,width:"500px",children:[(0,t.jsxs)(u.Modal.Body,{children:[(0,t.jsx)(u.Modal.Header,{children:(0,t.jsx)(u.Modal.Title,{children:"Skew Protection Threshold"})}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsxs)(m.Text,{children:["Deployments created before"," ",S?(0,t.jsx)(c.Link,{external:!0,href:S.commitUrl,title:"Open git commit in a new window",type:"highlight",children:S.sha.slice(0,7)}):"the selected deployment"," ","(",(0,t.jsx)("em",{children:(0,b.formatDateAndTime)(new Date(o?.createdAt??0))}),")"," ","will no longer use Skew Protection."]}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)(m.Text,{children:"This overrides the maximum age set in your project settings to define a specific deployment as the cutoff."}),(0,t.jsx)(p.Spacer,{y:1}),(0,t.jsx)(m.Text,{children:"While uncommon, this may be necessary if there is a specific problematic deployment you want to ensure no longer resolves requests from any other active clients."}),(0,t.jsx)(p.Spacer,{y:1}),v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Error,{error:v}),(0,t.jsx)(p.Spacer,{y:1})]}):null,(0,t.jsxs)(m.Text,{children:["Learn more about"," ",(0,t.jsx)(c.Link,{external:!0,href:"https://vercel.com/docs/skew-protection",type:"highlight",children:"Skew Protection"})]})]}),(0,t.jsxs)(u.Modal.Actions,{children:[(0,t.jsx)(u.Modal.Action,{loading:!1,onClick:I,type:"secondary",children:"Cancel"}),(0,t.jsx)(u.Modal.Action,{"data-testid":(0,x.tid)("skew-protection-modal","save-button"),loading:r,onClick:N,children:"Set"})]})]}),[I,T,i,r,v,N,o,S]),close:I,open:A}}(w.id),B=(0,n.useCallback)(()=>{D()},[D]),{modal:F,open:_}=(0,s.default)(k.projectId,w,{onDeploymentPromoted:B}),[U,H]=(0,n.useState)(!1),[z,V]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{a(!1),v({openRedeployModal:()=>E(k),openCancelDeploymentModal:()=>H(!0),openPromoteToProductionModal:()=>_(k),openInstantRollbackModal:()=>L(k),openSkewProtectionModal:()=>O(k),openDeleteDeploymentModal:()=>V(!0),canRollbackDeployment:P,isLoadingModals:!1})},[P,k,A,L,_,E,O,v,a]),(0,t.jsxs)(t.Fragment,{children:[M,R,F,N,(0,t.jsx)(l.default,{active:U,deployment:k,onClose:()=>H(!1),teamId:k.team?k.team.id:null}),S.canDeleteDeployment?(0,t.jsx)(C,{active:z,deployment:k,onClose:()=>V(!1),teamId:k.team?.id}):null]})}N.displayName="DeploymentModalsContext";let L=()=>{let e=(0,n.useContext)(N);if(!e)throw Error("useDeploymentRedeployModal must be used within a DeploymentModalsProvider");return e}},5998703,e=>{"use strict";e.s(["DeploymentMetadataMenuSkeleton",()=>R,"DeploymentMoreMenu",()=>L]);var t=e.i(751170),n=e.i(4099374),i=e.i(3679047),a=e.i(4004502),r=e.i(8893913),l=e.i(3753138),o=e.i(8876434),s=e.i(9508212),c=e.i(5255926),d=e.i(2504781),u=e.i(1344973),p=e.i(5468328),m=e.i(8674454),h=e.i(4991687),x=e.i(6694387),y=e.i(8459493),g=e.i(7448864),j=e.i(5326905),b=e.i(455575),f=e.i(7151748),v=e.i(3870297),w=e.i(3981247),k=e.i(1857939),C=e.i(57106),D=e.i(545405),S=e.i(475038),A=e.i(946578),I=e.i(380513),T=e.i(6293744),N=e.i(472117),E=e.i(4443312),P=e.i(6619197),M=e.i(9365163);function L(e){let{project:c,deployment:d}=e,{permissions:C,isLoading:L}=(0,T.useDeploymentPermissions)({project:c,deployment:d}),{data:B}=(0,w.useRollingRelease)({teamIdOrSlug:c?.accountId,projectSlug:c?.name}),F=(0,N.useCiChecksAndPoliciesFlag)(),{data:_}=(0,I.useFeatureFlag)("enable-team-deployments-page"),{isLoggedOut:U}=(0,k.useIsLoggedIn)(),H=(0,S.useIsViewingPublicDeployment)(),z=(0,b.useToasts)(),{openRedeployModal:V,openPromoteToProductionModal:$,openSkewProtectionModal:q,openInstantRollbackModal:G,openDeleteDeploymentModal:Y,canRollbackDeployment:W,isLoadingModals:K}=(0,A.useDeploymentModals)(),Q=(0,n.useCallback)(e=>{(0,D.copyToClipboard)(e),z.message("Copied to clipboard!"),f.analytics.track(v.AnalyticsEvent.DEPLOYMENT_OVERVIEW_COPIED_DEPLOYMENT_URL,{projectId:d.projectId,deploymentId:d.id,deploymentTarget:d.target})},[d,z]),Z=Object.values(C).every(e=>!e),J=Object.values(C).every(e=>e),{teamSlug:X,project:ee}=(0,i.useParams)()??{},et=(0,n.useMemo)(()=>{if(!X||!ee)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${X}/${ee}/deployments?${e.toString()}`):null},[X,ee,d]),en=(0,n.useMemo)(()=>{if(!X)return null;let e=new URLSearchParams,t=d.gitSource?.ref;return t?(e.set("filterBranch",t),`/${X}/~/deployments?${e.toString()}`):null},[X,d]),ei=_&&en?en:et,ea=!!(c?.link?.type==="github"&&c.link.org&&c.link.repo&&d.meta?.githubCommitSha),{data:er}=(0,E.useProjectCheckRuns)({deploymentId:d.id,enableCiChecksAndPolicies:F}),el=!!ea&&!!er&&!er.runs.every(e=>"succeeded"===e.conclusion&&"completed"===e.status),eo=(0,P.usePromoteTooltip)(d),es=(0,M.useRollbackTooltip)(d);if(Z)return(0,t.jsx)(O,{});if(!H&&L&&!U)return(0,t.jsx)(R,{});let ec=null;W&&(ec=es?(0,t.jsx)(s.Stack,{children:(0,t.jsx)(p.Tooltip,{position:"top",boxAlign:"center",style:{width:"100%"},text:es,children:(0,t.jsx)(y.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(r.RotateCounterClockwise,{color:"gray-600"}),children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})})})}):(0,t.jsx)(y.MenuItem,{onClick:G,suffix:(0,t.jsx)(r.RotateCounterClockwise,{color:"gray-900"}),title:es,children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:"Instant Rollback"})})}));let ed=null;if(C.canPromoteToProduction){let e=!!eo,n="production"===d.target,i=e?"Promote":B?.rollingRelease?.state==="ACTIVE"?"Queue for Promotion":n&&el&&F?"Force Promote":n?"Promote":el?"Force Promote to Production":"Promote to Production";ed=e?(0,t.jsx)(s.Stack,{children:(0,t.jsx)(p.Tooltip,{boxAlign:"center",position:"top",style:{width:"100%"},text:eo,children:(0,t.jsx)(y.MenuItem,{disabled:!0,style:{width:"100%"},suffix:(0,t.jsx)(l.ArrowCircleUp,{color:"gray-600"}),children:(0,t.jsx)(s.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(u.Text,{as:"span",style:{fontSize:"inherit",color:"inherit"},children:i})})})})}):(0,t.jsx)(y.MenuItem,{disabled:K,onClick:$,suffix:(0,t.jsx)(l.ArrowCircleUp,{color:"gray-900"}),children:i})}return(0,t.jsxs)(h.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(x.MenuButton,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!d,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(o.MoreHorizontal,{})}),(0,t.jsxs)(m.Menu,{width:"auto",children:[H?null:(0,t.jsxs)(t.Fragment,{children:[ec,ed,C.canCreateDeployment?(0,t.jsx)(y.MenuItem,{disabled:H||K,onClick:V,children:"Redeploy"}):null]}),C.canReadDeployment?(0,t.jsx)(y.MenuItem,{onClick:()=>Q(`https://${d.host}`),children:"Copy URL"}):null,!H&&ei?(0,t.jsx)(y.MenuItem,{href:ei,isLink:!0,children:"View All Branch Deployments"}):null,!H&&C.canUpdateSkewProtection?(0,t.jsx)(y.MenuItem,{disabled:K||!c?.skewProtectionMaxAge,onClick:q,children:"Skew Protection Threshold"}):null,!H&&C.canDeleteDeployment?(0,t.jsx)(y.MenuItem,{disabled:!function(e){let{readyState:t}=e;return"QUEUED"!==t&&"BUILDING"!==t}(d)||K,onClick:Y,type:"error",children:"Delete"}):null,!J&&!U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.MenuDivider,{}),H?null:(0,t.jsxs)(t.Fragment,{children:[W?null:(0,t.jsx)(g.MenuItemLocked,{children:"Instant Rollback"}),C.canPromoteToProduction?null:(0,t.jsx)(g.MenuItemLocked,{children:"Promote"}),C.canCreateDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Redeploy"})]}),C.canReadDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Copy URL"}),H||C.canUpdateSkewProtection?null:(0,t.jsx)(g.MenuItemLocked,{children:"Skew Protection Threshold"}),H||C.canDeleteDeployment?null:(0,t.jsx)(g.MenuItemLocked,{children:"Delete"})]})]})]})}function R(){return(0,t.jsx)(c.Skeleton,{children:(0,t.jsx)(O,{})})}function O(){return(0,t.jsx)(p.Tooltip,{position:"bottom",text:(0,t.jsxs)(t.Fragment,{children:["Additional permissions are required to manage Deployment."," ",(0,t.jsx)(C.Link,{href:"/docs/deployments",variant:"highlight",children:"Learn More →"})]}),children:(0,t.jsx)(d.Button,{"aria-label":"Deployment Actions","data-testid":(0,a.tid)("deployment-actions","more-button"),disabled:!0,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(o.MoreHorizontal,{})})})}},1585391,e=>{"use strict";e.s(["useCurrentDashboardDeploymentDomains",()=>r],1585391);var t=e.i(3679047),n=e.i(215852),i=e.i(1988648),a=e.i(5709282);function r(e){let{teamSlug:r,id:l}=(0,t.useParams)()??{};if(!r||!l)throw Error("Missing params");let o=(0,i.getDashboardDeploymentDomainsEndpoint)({deploymentId:l,teamSlug:r});return(0,n.useIsomorphicSuspenseSWR)(o,async(e,t)=>{let n=await t(e);return{...n,aliases:n.aliases.sort(a.domainStringCompare)}},e)}},1593195,e=>{"use strict";e.s(["ActionSkeleton",()=>tO,"CurrentDeploymentActionButton",()=>tB,"CurrentDeploymentMoreMenu",()=>tF],1593195);var t=e.i(751170),n=e.i(5255926),i=e.i(8159863),a=e.i(3212616),r=e.i(5998703),l=e.i(9722978),o=e.i(2504781),s=e.i(5468328),c=e.i(7917902),d=e.i(5044530),u=e.i(8893913),p=e.i(475038),m=e.i(100247),h=e.i(946578),x=e.i(4099374),y=e.i(9166951),g=e.i(5585544),j=e.i(3353711),b=e.i(8735244),f=e.i(6891161),v=e.i(9668517),w=e.i(2695633),k=e.i(3089600),C=e.i(5229375),D=e.i(4896636),S=e.i(1585391),A=e.i(243249);let I=e=>{let{team:t,user:n,projectName:i}=e,a=t?.slug||n?.username;return a&&i?`/${a}/${i}/settings/deployment-protection`:""};var T=e.i(5499338),N=e.i(8674454),E=e.i(6694387),P=e.i(4991687),M=e.i(8459493),L=e.i(8522580),R=e.i(7087273),O=e.i(9508212),B=e.i(1344973),F=e.i(455575),_=e.i(57106),U=e.i(1438473),H=e.i(6318858),z=e.i(2560270),V=e.i(4345845),$=e.i(5479400),q=e.i(3228096),G=e.i(9138164),Y=e.i(2375916),W=e.i(2563635),K=e.i(3814652),Q=e.i(7151748),Z=e.i(3870297),J=e.i(7780974),X=e.i(7837522),ee=e.i(3322724),et=e.i(1717203),en=e.i(7557283),ei=e.i(3679047),ea=e.i(2882012);e.i(6483798);var er=e.i(8287059),el=e.i(1475969),eo=e.i(4595422),es=e.i(9481787),ec=e.i(1136434),ed=e.i(1201436),eu=e.i(5366204),ep=e.i(5756088);let em=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M14 6V4.5C14 3.39543 13.1046 2.5 12 2.5C10.8954 2.5 10 3.39543 10 4.5V6H10.5H12V7.5V12.5C12 13.8807 10.8807 15 9.5 15H2.5C1.11929 15 0 13.8807 0 12.5V7.5V6H1.5H8.5V4.5C8.5 2.567 10.067 1 12 1C13.933 1 15.5 2.567 15.5 4.5V6H14ZM10.5 7.5H10H8.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H9.5C10.0523 13.5 10.5 13.0523 10.5 12.5V7.5Z" fill="currentColor"/>');var eh=e.i(198667),ex=e.i(5326905),ey=e.i(4670733),eg=e.i(1138941),ej=e.i(8529990),eb=e.i(5955443),ef=e.i(7764310),ev=e.i(691329);let ew={visible:{opacity:1,scale:1},hidden:{opacity:0,scale:.5}};function ek(e){let{"aria-label":n,children:i,classNameSuccess:a,textToCopy:r,onClick:s,...c}=e,d=(0,F.useToasts)(),[u,p]=(0,x.useState)(!1),[m,h]=(0,x.useState)(!1),y=(0,x.useRef)(null);return(0,x.useEffect)(()=>{u&&r&&(p(!1),y.current&&clearTimeout(y.current),h(!0),navigator.clipboard.writeText(r).catch(()=>d.error("Failed to copy to clipboard")),y.current=setTimeout(()=>{h(!1)},1e3))},[d,r,u]),(0,t.jsx)(o.Button,{"aria-label":n,disabled:c.disabled||u,onClick:()=>{p(!0),s?.()},...c,className:(0,l.clsx)(c.className,{[a||""]:m}),children:(0,t.jsx)(ef.MotionConfig,{transition:{duration:.15},children:(0,t.jsx)(eb.AnimatePresence,{initial:!1,mode:"wait",children:m?(0,t.jsx)(ev.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ew,children:i(m)},"check"):(0,t.jsx)(ev.motion.div,{animate:"visible",exit:"hidden",initial:"hidden",variants:ew,children:i(m)},"copy")})})})}var eC=e.i(1681029);function eD(e){let{alias:t,protectionBypass:n,protectionEnabledForDeployment:i}=e;if(!t)return;let a=(0,eC.domainToUrl)(t);return n&&i?(0,eo.createShareableLink)(a,n):a}var eS=e.i(4123527);function eA(e){let{alias:n,deployment:i,isLoading:a,previewCommentsEnabledForDeployment:r,protectionBypass:l,protectionEnabledForDeployment:s,git:d,onCreateShareableLink:u,onDeleteShareableLink:p,onRegenerateShareableLink:m,openUpgradeModal:h,canUpdateShareableLink:y,viewAndCommentDescription:g}=e,j=(0,ee.useIsMobile)(),f=(0,ee.useMediaQuery)(430),{team:v,account:w}=(0,c.useAccount)(),k=(0,eg.useProjectIdOrName)(),C=w?.billing?.plan==="hobby",[D,S]=(0,x.useState)(l?"anyone":"team"),[A,I]=(0,x.useState)(!1),T=n&&eD({alias:n,protectionBypass:l,protectionEnabledForDeployment:s||!!l}),E=f?"Link":"Copy Link",L=!s&&!r,R=(0,t.jsx)(ek,{"aria-label":"Copy Link",className:"!h-8 !w-auto !justify-start !px-1",classNameSuccess:"!text-white !bg-blue-900",disabled:a||!n||A,onClick:()=>Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_COPY_LINK,{projectId:k,deploymentType:"alias"}),textToCopy:T||"",type:"secondary",children:e=>(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,justify:"start",children:[(a||A?(0,t.jsx)(b.Spinner,{}):e&&(0,t.jsx)(H.Check,{}))||(0,t.jsx)(ed.Copy,{}),e?"Copied!":E]})}),F=(0,ej.getGitInfoFromDeployment)(i),U=(0,ey.useNewFeedbackSharingModal)().value||!1,z=F&&!F.isPublic,V=!!(U&&z&&C),$=(0,x.useCallback)(()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:k,isHobbyPrivate:V}),h()},[V,h,k]),q=(0,x.useCallback)(e=>{if("anyone"===e&&C||S(e),"anyone"!==e||l)l&&p();else{if(C)return void I(!0);u()}},[C,l,u,p]);(0,x.useEffect)(()=>{A&&l&&I(!1)},[A,I,l,D]),(0,x.useEffect)(()=>{a||S(l?"anyone":"team")},[l,a]);let G=U&&V&&!!v&&(0,t.jsxs)(t.Fragment,{children:["To allow external collaborators to comment on the Hobby plan, the repository"," ",(0,t.jsx)("span",{style:{display:"inline-block",transform:"scale(0.85) translateY(2px)"},children:d?.logo})," ",F?.repoName," ",(0,t.jsx)(ep.LockClosed,{size:12})," visibility must be public."]}),Y=(0,x.useMemo)(()=>{if(!y)return"You need additional permissions to manage sharing"},[y]),W="Only people with access",K=s?"Anyone with the link":"Publicly accessible",J=(l||a)&&s;return L?(0,t.jsxs)(eI,{notActionable:!0,children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eE,{}),(0,t.jsx)(B.Text,{align:"left",className:"text-pretty [&_svg]:align-text-top",children:"Publicly accessible"})]}),R]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(P.MenuContainer,{children:["team"===D?(0,t.jsxs)(eI,{disabled:a||A,notActionable:!!Y,children:[(0,t.jsx)(eN,{disabled:a||A,isActionable:!Y,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eE,{}),(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsxs)(B.Text,{align:"left",className:"flex flex-nowrap items-center gap-1 text-pretty",children:[W,f?null:` can ${g}`,Y?null:(0,t.jsx)(ec.ChevronDownSmall,{})]})})]})}),R]}):(0,t.jsxs)(eI,{disabled:a,notActionable:!!Y,children:[(0,t.jsx)(eN,{disabled:a,isActionable:!Y,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2.5,children:[(0,t.jsx)(eE,{success:s}),(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsxs)(O.Stack,{align:"start",children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsxs)(B.Text,{align:"left",className:"text-pretty [&_svg]:align-text-top",color:Y?"gray-800":void 0,children:[K,s&&!f?` can ${g}`:null]}),Y?null:(0,t.jsx)(ec.ChevronDownSmall,{})]}),r?(0,t.jsxs)(B.Text,{color:Y?"gray-800":"gray-900",size:13,children:["Visitors must"," ",(0,t.jsx)("span",{className:"geist-hide-on-mobile",children:"be logged in"})," ",(0,t.jsx)("span",{className:"geist-show-on-mobile",children:"log in"})," to comment"]}):null]})})]})}),R]}),(0,t.jsxs)(N.Menu,{width:300,children:[(0,t.jsx)(eT,{forceHide:!Y,text:Y,children:(0,t.jsx)(M.MenuItem,{disabled:a||!!Y,onClick:()=>q("team"),prefix:(0,t.jsx)(ep.LockClosed,{}),style:{width:"100%"},suffix:"team"===D?(0,t.jsx)(H.Check,{}):null,children:W})}),(0,t.jsx)(eT,{forceHide:!(Y||G),text:Y||G,children:(0,t.jsx)(M.MenuItem,{disabled:a||V||!!Y||A,innerMenuItemClassName:"!pointer-events-auto",onClick:()=>{q("anyone")},prefix:(0,t.jsx)(em,{}),style:{width:"100%"},suffix:"anyone"===D?(0,t.jsx)(H.Check,{}):null,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",style:{width:"100%"},children:[K,V?(0,t.jsx)(o.Button,{onClick:$,size:"small",style:{cursor:"pointer",background:"var(--geist-foreground)",color:"var(--geist-background)"},children:"Upgrade"}):null]})})}),J?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ex.MenuDivider,{}),(0,t.jsx)(eT,{text:"Regenerate shareable link",children:(0,t.jsx)(M.MenuItem,{onClick:m,prefix:(0,t.jsx)(eh.RefreshClockwise,{}),style:{width:"100%"},children:"Reset link"})})]}):null]})]}),(0,t.jsx)(eS.ToastMobileAware,{actionText:"Confirm",active:A,cancelActionText:"Cancel",onAction:()=>{S("anyone"),u()},onCancelAction:()=>{I(!1)},preserve:!0,toastKey:"create-shareable-link-hobby-confirmation",children:(0,t.jsxs)(O.Stack,{direction:"column",gap:3,children:[(0,t.jsxs)(B.Text,{children:["You can only have 1 shareable link at a time on Hobby."," ",(0,t.jsx)(_.Link,{external:!0,icon:!1,onClick:()=>{I(!1),$()},underline:!j||void 0,variant:j?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited shareable links."]}),(0,t.jsx)(B.Text,{children:"Continuing will revoke any existing shareable links."})]})})]})}function eI(e){let{disabled:n=!1,children:i,notActionable:a}=e;return(0,t.jsx)(O.Stack,{className:"w-full",children:(0,t.jsx)(O.Stack,{style:{width:"100%"},children:(0,t.jsx)(O.Stack,{className:(0,l.clsx)("w-full py-2.5 pl-0.5 pr-2",{"cursor-not-allowed":n,"cursor-default":a&&!n}),children:(0,t.jsx)(O.Stack,{direction:"row",justify:"space-between",style:{width:"100%"},children:i})})})})}function eT(e){let{children:n,forceHide:i,text:a}=e;return(0,t.jsx)(s.Tooltip,{desktopOnly:!0,forceHide:i,maxWidth:350,padding:10,style:{width:"100%"},text:a,children:n})}function eN(e){let{isActionable:n,children:i,disabled:a}=e;return n?(0,t.jsx)(E.MenuButton,{disabled:a,variant:"unstyled",children:i}):(0,t.jsx)(O.Stack,{paddingLeft:1.5,children:i})}function eE(e){let{success:n}=e;return(0,t.jsx)(O.Stack,{align:"center",direction:"row",gap:{sm:2,md:3,lg:3},children:(0,t.jsx)(O.Stack,{align:"center",className:(0,l.clsx)("size-8 shrink-0 rounded-full text-white",{"bg-blue-900":n,"bg-gray-700":!n}),justify:"center",children:(0,t.jsx)(eu.Link,{})})})}var eP=e.i(4585051),eM=e.i(6942035),eL=e.i(2988836),eR=e.i(4519214),eO=e.i(681883),eB=e.i(7898658),eF=e.i(9523111);function e_(){return(0,t.jsx)(O.Stack,{align:"center",className:"max-w-max overflow-hidden rounded-full border border-gray-400 bg-gray-700 p-2 font-bold text-white",justify:"center",children:(0,t.jsx)(eF.Email,{size:16})})}var eU=e.i(7901966);function eH(e){let{target:n,canUpdateProtectionBypass:i=!0,hideStaticTeamMembersBanner:a=!1,onUpgradeClick:r,project:l,revalidateAlias:o,branchAliasId:s,branchName:c}=e;return n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ez,{branchAliasId:s,branchName:c,canUpdateProtectionBypass:i,filter:"requests",onUpgradeClick:r,project:l,revalidateAlias:o,target:n}),(0,t.jsx)(ez,{canUpdateProtectionBypass:i,filter:"granted",hideStaticTeamMembersBanner:a,onUpgradeClick:r,project:l,revalidateAlias:o,target:n})]}):null}function ez(e){let{target:n,canUpdateProtectionBypass:i=!0,filter:a,hideStaticTeamMembersBanner:r=!1,onUpgradeClick:l,project:o,revalidateAlias:d,branchAliasId:u,branchName:p}=e,{team:m,user:h}=(0,c.useAccount)(),{data:y}=(0,eO.default)({limit:1},{revalidateIfStale:!1,revalidateOnFocus:!1}),g=(0,x.useMemo)(()=>Object.entries(n.protectionBypass??{}).map(e=>{let[t,n]=e;return"user"===n.scope?{...n,userId:t}:"email_invite"===n.scope?{...n,email:t}:void 0}).filter(e=>void 0!==e).sort((e,t)=>t.createdAt>e.createdAt?1:-1),[n.protectionBypass]),j=a?g.filter(e=>("user"===e.scope&&"requested"===e.access)==("requests"===a)):g,b=(0,x.useCallback)(async e=>{await (0,ea.updateAliasProtectionBypass)({aliasId:n.id,teamId:m?.id,body:e}),await d()},[n.id,m?.id,d]),f=(0,x.useMemo)(()=>{if(u&&n.id.startsWith("dpl_"))return async e=>{await (0,ea.insertInviteToAliasProtectionBypass)({aliasId:u,teamId:m?.id,inviteeEmails:[e],message:""}),await d()}},[u,d,n.id,m?.id]);if(0===j.length&&!("granted"===a&&!r))return null;let v=y?.members.length;return(0,t.jsxs)(O.Stack,{gap:2,children:[(0,t.jsx)(B.Text,{size:16,weight:500,children:"requests"===a?"Access requests":"People with access"}),(0,t.jsx)(O.Stack,{gap:4,children:(0,t.jsxs)(O.Stack,{gap:3,children:[r||"granted"!==a?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e$,{thumbnail:(0,t.jsx)(eP.Avatar,{size:32,teamId:m?.id,username:m?void 0:h?.username}),title:(0,t.jsxs)(O.Stack,{as:"span",direction:"row",gap:1,children:[(0,t.jsx)(B.Text,{as:"span",weight:500,children:m?.name||"You"}),m?(0,t.jsx)(t.Fragment,{children:/\bteam\b/i.test(m.name)?" members":" team members"}):null,v?(0,t.jsx)(s.Tooltip,{text:"Excluding contributors without access to this project.",children:(0,t.jsx)(eL.InformationFillSmall,{})}):null]})}),v?(0,t.jsx)(e$,{thumbnail:(0,t.jsx)(eW,{project:o}),title:(0,t.jsxs)(B.Text,{as:"span",children:[(0,t.jsx)(B.Text,{as:"span",weight:500,children:o.name})," ",(0,t.jsx)(B.Text,{as:"span",children:"project contributors"})]})}):null]}),j.map(e=>(0,t.jsx)(eV,{branchName:p,canUpdateProtectionBypass:i,onUpgradeClick:l,targetUrl:n.url,updateBranchAccess:f,updateUserAccess:b,user:e},"user"===e.scope?e.userId:e.email))]})})]})}function eV(e){let{canUpdateProtectionBypass:n,onUpgradeClick:i,user:a,updateUserAccess:r,updateBranchAccess:l,branchName:o,targetUrl:s}=e,d=(0,F.useToasts)(),{account:u}=(0,c.useAccount)(),[p,m]=(0,x.useState)(void 0),h=u?.billing?.plan==="hobby",[y,g]=(0,x.useState)(!1),j="user"===a.scope,b=async(e,t)=>{m(e);try{let n=j?{scope:{userId:a.userId,access:e}}:{scope:{email:a.email,access:"denied"}};await Promise.all([r(n),a.email&&t&&l&&"granted"===e?l(a.email):void 0])}catch(e){d.error("An error occured, please try again later.")}finally{m(void 0)}},f=async e=>{if(h)return void g(!0);await b("granted",e)},v=void 0!==p;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e$,{actions:(0,t.jsx)(eq,{branchName:o,canUpdateProtectionBypass:n,isAccessRequested:!!j&&"requested"===a.access,isInvitationFlagEnabled:!0,isLoading:v,isUpdating:p,onAccessGranted:f,showBranchOption:!!(l&&a.email)&&!h,showHobbyLimitAction:y,targetUrl:s,updateAccess:b}),description:j?a.email:void 0,thumbnail:"user"===a.scope?(0,t.jsx)(eP.Avatar,{size:32,username:j?a.username:void 0}):(0,t.jsx)(e_,{}),title:j?a.username??a.userId:a.email}),(0,t.jsx)(eG,{isInvitationFlagEnabled:!0,isLoading:v,onUpgradeClick:i,setShowHobbyLimitAction:g,showHobbyLimitAction:y,updateAccess:b})]})}function e$(e){let{actions:n,description:i,thumbnail:a,title:r}=e;return(0,t.jsxs)(O.Stack,{align:"center",className:"h-9",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[a,(0,t.jsxs)(O.Stack,{children:[(0,t.jsx)(B.Text,{lineHeight:20,size:14,children:r}),(0,t.jsx)(B.Text,{color:"gray-900",lineHeight:16,size:13,children:i})]})]}),n]})}function eq(e){let{canUpdateProtectionBypass:n=!0,isAccessRequested:i,isInvitationFlagEnabled:a,isLoading:r,isUpdating:l,onAccessGranted:c,showHobbyLimitAction:d,updateAccess:u,showBranchOption:p,branchName:m,targetUrl:h}=e,x=(0,t.jsx)(eM.Cross,{}),y=(0,t.jsx)(H.Check,{}),g=n?void 0:"You need additional permissions to manage access requests",j=d||!n,f=p?(0,t.jsxs)(P.MenuContainer,{children:[(0,t.jsx)(E.MenuButton,{"aria-label":"Approve",disabled:j,shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:y}),(0,t.jsxs)(N.Menu,{width:"auto",children:[(0,t.jsx)(M.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(),prefix:(0,t.jsx)($.GitCommit,{}),children:(0,t.jsxs)(O.Stack,{direction:"column",gap:1,children:[(0,t.jsx)(B.Text,{children:"Approve for Deployment"}),(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:h})]})}),(0,t.jsx)(M.MenuItem,{innerMenuItemClassName:"h-auto py-2",onClick:()=>void c(!0),prefix:(0,t.jsx)(V.GitBranch,{}),children:(0,t.jsxs)(O.Stack,{direction:"column",gap:1,children:[(0,t.jsx)(B.Text,{children:"Approve for Deployment and Branch"}),(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:m})]})})]})]}):(0,t.jsx)(o.Button,{"aria-label":"Approve",disabled:j,onClick:()=>void c(),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:y});return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:g??(i?"Decline":"Revoke"),children:r?(0,t.jsx)(O.Stack,{className:"mx-2",children:"denied"===l?(0,t.jsx)(b.Spinner,{size:16}):x}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.Button,{"aria-label":"Decline",disabled:!n,onClick:()=>void u("denied"),shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:x})})}),i?(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:g??"Approve",children:r?(0,t.jsx)(O.Stack,{className:"mx-2",children:"granted"===l?(0,t.jsx)(b.Spinner,{size:16}):y}):f}):null]})}function eG(e){let{isInvitationFlagEnabled:n,isLoading:i,onUpgradeClick:a,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o}=e;return n&&a?(0,t.jsx)(eU.HobbyLimitAction,{onUpgradeClick:a,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o}):(0,t.jsx)(eY,{isLoading:i,setShowHobbyLimitAction:r,showHobbyLimitAction:l,updateAccess:o})}function eY(e){let{isLoading:n,setShowHobbyLimitAction:i,showHobbyLimitAction:a,updateAccess:r}=e;return(0,t.jsx)(eb.AnimatePresence,{children:a&&!n?(0,t.jsx)(eR.m.div,{animate:{height:"auto"},className:"relative box-border rounded border border-gray-400 bg-gray-100 dark:bg-gray-100",exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsxs)(O.Stack,{align:"center",className:"px-4",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsx)(B.Text,{color:"gray-900",size:13,children:"Hobby plans have a limit of 1 external collaborator at a time. Confirm to remove any existing user access."}),(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:"Cancel",children:(0,t.jsx)(o.Button,{"aria-label":"Cancel",onClick:()=>{i(!1)},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(eM.Cross,{})})}),(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:"Confirm",children:(0,t.jsx)(o.Button,{"aria-label":"Confirm",onClick:()=>{i(!1),r("granted")},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(H.Check,{})})})]})]})},"hobby-limit-actions"):null})}function eW(e){let{size:i=32,style:a,project:r,title:l}=e,{data:o,isLoading:s}=(0,eB.default)({project:r}),c=(0,eg.useFramework)(r);return!s&&(c||o)?(0,t.jsx)(eP.Avatar,{size:i,src:o?.src||c?.logo,style:a,title:l??c?.name}):(0,t.jsx)(n.Skeleton,{height:i,rounded:!0,style:{flexShrink:0},width:i})}var eK=e.i(8248823),eQ=e.i(4030453),eZ=e.i(9334091),eJ=e.i(8384463),eX=e.i(6734680),e0=e.i(8587921),e1=e.i(5071474);function e5(e){let{inputText:n,navIndex:i,onPicked:a,setNavIndex:r,suggestions:l}=e;return n?(0,t.jsxs)(O.Stack,{gap:3,children:[(0,t.jsx)(e4,{index:-1,isSelected:-1===i,onClick:()=>{a({label:n,value:n})},onMouseMove:()=>{r(-1)},option:{label:n,value:n}}),l?.map((e,n)=>(0,t.jsx)(e4,{index:n,isSelected:n===i,onClick:()=>{a(e)},onMouseMove:()=>{r(n)},option:e},e.value))]}):null}function e4(e){let{index:n,isSelected:i,onClick:a,onMouseMove:r,option:o}=e,{member:s}=o,c=(0,x.useRef)(null);(0,x.useEffect)(()=>{c.current&&i&&c.current.scrollIntoView({behavior:"smooth",block:-1===n?"end":"nearest"})},[n,i]);let d=s?.name||s?.username,u=d||o.value;return(0,t.jsxs)(O.Stack,{align:"center",className:(0,l.clsx)("relative cursor-default rounded-md transition-colors duration-150 hover:bg-gray-100",{'after:content-["_"] after:box-content after:absolute after:-left-2 after:bg-gray-alpha-100 after:w-full after:h-full after:rounded after:p-2':i}),direction:"row",gap:2,onClick:a,onMouseMove:r,ref:c,children:[s?(0,t.jsx)(eP.Avatar,{size:32,username:s.username}):(0,t.jsx)(e_,{}),(0,t.jsxs)(O.Stack,{style:{overflow:"hidden"},children:[(0,t.jsx)(B.Text,{lineHeight:20,size:14,truncate:!0,children:u}),d?(0,t.jsx)(B.Text,{color:"gray-900",lineHeight:16,size:13,children:o.value}):null]})]})}var e3=e.i(2081849),e2=e.i(5592888),e7=e.i(4788600),e9=e.i(1122492),e8=e.i(2203852),e6=e.i(712031),te=e.i(7033292),tt=e.i(2366181),tn=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],ti=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=String(e).toLowerCase(),a=String(n.getOptionValue(t)).toLowerCase(),r=String(n.getOptionLabel(t)).toLowerCase();return a===i||r===i},ta={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n,i){return!(!e||t.some(function(t){return ti(e,t,i)})||n.some(function(t){return ti(e,t,i)}))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}};e.i(7828999),e.i(643180),e.i(7966790),e.i(5653849),e.i(7909138),e.i(6623660),e.i(9404324),e.i(7792275),e.i(4668404),e.i(5436857);var tr=(0,x.forwardRef)(function(e,t){var n,i,a,r,l,o,s,c,d,u,p,m,h,y,g,j,b,f,v,w,k,C,D,S,A,I,T,N,E=(a=void 0!==(i=(n=(0,e9.u)(e)).allowCreateWhileLoading)&&i,l=void 0===(r=n.createOptionPosition)?"last":r,s=void 0===(o=n.formatCreateLabel)?ta.formatCreateLabel:o,d=void 0===(c=n.isValidNewOption)?ta.isValidNewOption:c,p=void 0===(u=n.getNewOptionData)?ta.getNewOptionData:u,m=n.onCreateOption,y=void 0===(h=n.options)?[]:h,g=n.onChange,f=void 0===(b=(j=(0,te.default)(n,tn)).getOptionValue)?e7.g:b,w=void 0===(v=j.getOptionLabel)?e7.b:v,k=j.inputValue,C=j.isLoading,D=j.isMulti,S=j.value,A=j.name,I=(0,x.useMemo)(function(){return d(k,(0,tt.H)(S),y,{getOptionValue:f,getOptionLabel:w})?p(k,s(k)):void 0},[s,p,w,f,k,d,y,S]),T=(0,x.useMemo)(function(){return(a||!C)&&I?"first"===l?[I].concat((0,e6.default)(y)):[].concat((0,e6.default)(y),[I]):y},[a,l,C,I,y]),N=(0,x.useCallback)(function(e,t){if("select-option"!==t.action)return g(e,t);var n=Array.isArray(e)?e:[e];if(n[n.length-1]===I){if(m)m(k);else{var i=p(k,k);g((0,tt.D)(D,[].concat((0,e6.default)((0,tt.H)(S)),[i]),i),{action:"create-option",name:A,option:i})}return}g(e,t)},[p,k,D,A,I,m,g,S]),(0,e8.default)((0,e8.default)({},j),{},{options:T,onChange:N}));return x.createElement(e7.S,(0,e2.default)({ref:t},E))}),tl=e.i(6401841),to=e.i(9096446),ts=e.i(3617058);let tc={control:e=>(0,ts.twMerge)("w-full border border-solid border-gray-alpha-400 bg-white rounded min-h-10 transition-colors duration-200",e.isFocused&&"hover:border-gray-alpha-600 bg-white shadow-focus-border",e.isDisabled&&"bg-gray-100"),valueContainer:()=>"px-2 py-1.5",input:()=>"py-0.5 m-0.5 text-gray-1000 text-base lg:text-sm",placeholder:()=>"mx-0.5 text-gray-600",indicatorsContainer:()=>"flex items-center px-2",indicatorSeparator:()=>"hidden",dropdownIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150",clearIndicator:()=>"text-gray-600 hover:text-gray-800 transition-colors duration-150 cursor-pointer",menu:()=>"bg-white border border-gray-alpha-400 rounded-md shadow-lg mt-1 z-50",menuList:()=>"py-1 max-h-60 overflow-auto",option:e=>(0,ts.twMerge)("px-3 py-2 text-sm cursor-pointer transition-colors duration-150 text-gray-1000 hover:bg-gray-100",e.isFocused&&"bg-gray-alpha-100",e.isSelected&&"bg-blue-500 text-white"),multiValue:()=>"inline-flex items-center bg-gray-200 rounded text-sm",multiValueLabel:()=>"pl-1 pr-0 py-1 flex font-medium text-xs",multiValueRemove:()=>"pl-0.5 pr-1 cursor-pointer rounded-xs flex items-center text-inherit box-border hover:bg-transparent hover:text-inherit"},td=(0,x.forwardRef)(function(e,n){let{disabled:i,disabledText:a,inputText:r,invitationFocused:l,invitees:o,onInputBlur:c,onInputChangeHandler:d,onInputFocused:u,onKeyDown:p,placeholder:m,setInvitees:h}=e,y=(0,x.useCallback)((e,t)=>{e&&Array.isArray(e)&&h(e)},[h]),g=(0,t.jsx)(tr,{autoFocus:l,classNames:tc,components:{MultiValue:tu,MultiValueRemove:tm,Option:th,NoOptionsMessage:tg,DropdownIndicator:()=>null},formatCreateLabel:e=>e,inputValue:r,isClearable:!1,isDisabled:i,isLoading:!1,isMulti:!0,isSearchable:!0,menuIsOpen:!1,onBlur:()=>c(),onChange:y,onFocus:()=>u(),onInputChange:d,onKeyDown:p,openMenuOnClick:!1,placeholder:m,ref:n,value:o,unstyled:!0});return i?(0,t.jsx)(s.Tooltip,{desktopOnly:!0,style:{width:"100%",display:"block"},text:a,children:g}):g});function tu(e){let n=e.data,i=!(0,eX.default)(n.value),a={...{innerProps:{className:(0,l.clsx)(e.className,"m-0.5 flex min-h-6 items-center overflow-hidden rounded-full leading-none",{"bg-red-300 hover:bg-red-400 text-red-900 [&_span>div>svg]:hover:stroke-red-500":i,"bg-gray-300 text-gray-1000 hover:bg-gray-400":!i})}},...e};return(0,t.jsx)(e3.components.MultiValue,{...a,children:(0,t.jsx)(tp,{isEmailInvalid:i,option:n})})}function tp(e){let{isEmailInvalid:n,option:i}=e;return n?(0,t.jsx)(s.Tooltip,{text:"Not a valid email address",children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(ty,{}),i.value]})}):(0,t.jsxs)(O.Stack,{align:"center",className:(0,l.clsx)({"ml-0.5":!i.member}),direction:"row",gap:1,children:[i.member?(0,t.jsx)(eP.Avatar,{className:"border-none",size:16,username:i.member.username}):null,i.value]})}function tm(e){let{innerProps:n}=e;return(0,t.jsx)("div",{...n,children:(0,t.jsx)(to.CrossSmall,{})})}function th(e){let n=e.data;return(0,t.jsx)(e3.components.Option,{...e,children:(0,t.jsx)(tx,{text:n.label})})}function tx(e){let{text:n}=e;return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(e_,{}),(0,t.jsx)(B.Text,{children:n})]})}function ty(){return(0,t.jsx)(tl.Stop,{"aria-hidden":!0,className:"fill-red-900 stroke-red-300",size:19})}function tg(){return(0,t.jsx)(O.Stack,{align:"center",className:"flex min-h-[70px] items-center justify-center text-sm text-gray-600",children:(0,t.jsx)(B.Text,{color:"gray-700",children:"No options ..."})})}function tj(e){let{canUpdateProtectionBypass:n,git:i,header:a,branchAliasId:r,selectedTarget:l,invitationFocused:d,onCancel:u,onFinished:p,onFocus:m,openUpgradeModal:h,previewCommentsEnabledForDeployment:y,revalidateAlias:g,teamId:j,viewAndCommentDescription:v,deployment:w}=e,{track:k}=(0,X.useTrackActivity)(),C=(0,F.useToasts)(),D=(0,ee.useIsMobile)(),{account:S}=(0,c.useAccount)(),A=(0,eg.useProjectIdOrName)(),I=S?.billing?.plan==="hobby",[T,N]=(0,x.useState)(!1),E=(0,x.useRef)(null),[P,M]=(0,x.useState)(!1),[R,H]=(0,x.useState)(""),[z,q]=(0,x.useState)([]),[G,Y]=(0,x.useState)(""),[W,K]=(0,x.useState)(null),et=I&&z.length>1,en=z.some(e=>!(0,eX.default)(e.value)),ei=G.length>250,er=(0,x.useMemo)(()=>ei||en?"Please correct the form input errors to continue":z.length?et?"Upgrade your plan to invite multiple external collaborators":void 0:"Input must not be empty",[en,z.length,et,ei]),el=(0,x.useCallback)(()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:A}),h()},[h,A]),eo=()=>{E.current&&E.current.focus()},es=(0,x.useCallback)(async()=>{k(J.VercelActivityAction.DeploymentInviteSent,{count:z.length,teamMemberCount:z.filter(e=>void 0!==e.member).length}),K(null),M(!0);try{await (0,ea.insertInviteToAliasProtectionBypass)({aliasId:l.id,teamId:j,inviteeEmails:z.map(e=>e.value),message:G});let e=1===z.length?"Invite was sent":"Invites were sent";C.message({text:e}),q([]),Y(""),p(),await g()}catch(e){K((0,eK.normalizeError)(e))}M(!1)},[l.id,z,G,p,g,j,C,k]),[,{isLagging:ec,members:ed}]=(0,e0.useMembersInfinite)({revalidateIfStale:!1},{search:R},!0),eu=(0,x.useMemo)(()=>ed.map(e=>({label:e.name,value:e.email,member:e})).filter(e=>!z.some(t=>t.value===e.value)),[z,ed]),ep=function(e){let[t,n]=(0,x.useState)(-1);return{lowBorder:-1,highBorder:e-1,navIndex:t,resetNavIndex:()=>n(-1),setNavIndex:n}}(eu.length),{navIndex:em,resetNavIndex:eh,setNavIndex:ex}=ep,ey=(0,x.useCallback)((e,t)=>{"input-change"===t.action&&!(e.length>320)&&(z.length>50||(H(e),K(null)))},[z.length]),ej=(0,x.useCallback)(()=>{R||z.length||u()},[R,z.length,u]),ef=(0,x.useCallback)(()=>{if(!R&&!z.length)return void u();H(""),eo(),eh()},[R,z.length,u,eh]),ev=(0,x.useCallback)(e=>{z.some(t=>t.value===e.value)||(q([...z,e.member?e:eu.find(t=>t.value===e.value)||e]),H(""),eo(),eh())},[z,eh,eu]),{onInputKeyDownHandler:ew}=function(e){let{inputText:t,navIndexState:n,onEscape:i,onPicked:a,suggestions:r}=e,{lowBorder:l,highBorder:o,navIndex:s,setNavIndex:c}=n;return{onInputKeyDownHandler:e=>{switch(e.key){case"Escape":e.stopPropagation(),i();break;case"Enter":case"Tab":if(!t)break;e.preventDefault(),-1===s?a({label:t,value:t}):a(r[s]);break;case"ArrowUp":e.preventDefault(),c(s>l?s-1:o);break;case"ArrowDown":e.preventDefault(),c(s<o?s+1:l)}}}}({inputText:R,navIndexState:ep,onEscape:ef,onPicked:ev,suggestions:eu});(0,x.useEffect)(()=>{R||eh()},[R,eh]);let ek=l.id===w.id?(0,e1.default)(w).hash:void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(tb,{header:a,invitationFocused:d,children:[(0,t.jsxs)(O.Stack,{gap:3,children:[(0,t.jsxs)(B.Text,{as:"span",children:[n?"Choose":"People"," who can"," ",(0,t.jsx)(B.Text,{as:"span",weight:500,children:v})," ",y?"on":null," ",l.id===r&&i?.branchName?(0,t.jsxs)(_.Link,{className:"mt-1 flex flex-nowrap items-start gap-1 pb-2 pt-1",href:i.branchUrl,title:"Git Branch",children:[(0,t.jsx)(V.GitBranch,{className:"mb-[-3px]"})," ",(0,t.jsx)(B.Text,{truncate:!0,as:"span",style:{lineHeight:"13px",fontFamily:"var(--font-mono)",fontSize:"13px",fontWeight:"500"},children:i.branchName})]}):(0,t.jsx)(B.Text,{as:"span",weight:500,children:ek?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.GitCommit,{className:"align-sub"})," ",(0,t.jsx)(B.Text,{as:"span",monospace:!0,size:13,children:ek})]}):l.url})]}),(0,t.jsx)("form",{children:(0,t.jsx)(td,{disabled:!n,disabledText:"You need additional permissions to invite collaborators",inputText:R,invitationFocused:d,invitees:z,onInputBlur:ej,onInputChangeHandler:ey,onInputFocused:m,onKeyDown:ew,placeholder:"Add team members or emails...",ref:E,setInvitees:q})}),(0,t.jsx)(eb.AnimatePresence,{children:et?(0,t.jsx)(eR.m.div,{animate:{height:"auto"},exit:{height:0},initial:{height:0},style:{padding:0},transition:{ease:"easeInOut"},children:(0,t.jsx)(L.Note,{action:(0,t.jsx)(o.Button,{"aria-label":"Upgrade your plan to invite multiple external collaborators.",onClick:()=>{N(!1),el()},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(U.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Upgrade your plan to invite multiple external collaborators."})},"hobby-limit-actions"):null})]}),d?(0,t.jsxs)(O.Stack,{className:"h-[132px]",gap:3,children:[(0,t.jsx)(e5,{inputText:R,navIndex:em,onPicked:ev,setNavIndex:ex,suggestions:eu}),R||z.length?null:(0,t.jsxs)(O.Stack,{align:"center",className:"px-6 py-8 text-gray-600",gap:4,children:[(0,t.jsx)(O.Stack,{align:"center",className:"size-8 overflow-hidden rounded-sm border border-solid border-gray-300 font-bold text-gray-600",justify:"center",children:(0,t.jsx)(eJ.UserPlus,{})}),(0,t.jsx)(B.Text,{color:"inherit",children:"Search team members or enter an email to invite collaborators."})]}),R&&ec?(0,t.jsx)(O.Stack,{align:"center",children:(0,t.jsx)(b.Spinner,{})}):null,!R&&z.length?(0,t.jsx)(eZ.Textarea,{onChange:e=>{Y(e.target.value)},placeholder:"Add an optional message",resize:"vertical",rows:3,value:G}):null,ei?(0,t.jsx)(eQ.Error,{error:`The message should be 250 characters or less (current length: ${G.length})`,size:"small"}):null,W?(0,t.jsx)(eQ.Error,{error:W}):null]}):null,(0,t.jsx)(eS.ToastMobileAware,{actionText:"Confirm",active:T,cancelActionText:"Cancel",onAction:()=>{es(),N(!1)},onCancelAction:()=>{N(!1)},preserve:!0,toastKey:"invite-hobby-confirmation",children:(0,t.jsxs)(O.Stack,{direction:"column",gap:3,children:[(0,t.jsxs)(B.Text,{children:["You can only share with 1 external collaborator at a time on Hobby."," ",(0,t.jsx)(_.Link,{external:!0,icon:!1,onClick:()=>{N(!1),el()},underline:!D||void 0,variant:D?"highlight":void 0,children:"Upgrade to Pro"})," ","for unlimited external collaborators."]}),(0,t.jsx)(B.Text,{children:"Continuing will remove any existing user access."})]})})]}),d?(0,t.jsxs)(f.Modal.Actions,{children:[(0,t.jsx)(f.Modal.Action,{onClick:()=>{if(T)return void N(!1);K(null),q([]),Y(""),u()},type:"secondary",children:"Cancel"}),(0,t.jsx)(f.Modal.Action,{disabled:et||T||P||en||ei||!z.length,loading:P||T,onClick:()=>{if(I)return void N(!0);es()},children:(0,t.jsx)(s.Tooltip,{text:er,children:"Invite"})})]}):null]})}function tb(e){let{children:n,header:i,invitationFocused:a}=e;return a?(0,t.jsx)(f.Modal.Body,{className:"px-0 py-3.5",padding:!1,children:(0,t.jsx)(R.Scroller,{overflow:"y",scrollerClassName:"px-1 py-2.5",children:(0,t.jsxs)(O.Stack,{className:"min-h-[285px] px-5",gap:6,children:[i,n]})})}):(0,t.jsx)(t.Fragment,{children:n})}var tf=e.i(545405);function tv(e){let{targets:n,branchAliasId:i,deployment:a,git:r,isLoading:l,isPreviewDeployment:o,modalClose:s,previewCommentsEnabledForBranch:c,previewCommentsEnabledForDeployment:d,productionProtectionEnabled:u,project:p,protectionEnabledForDeployment:m,protectionEnabledForProject:h,revalidateAlias:y,setIsLoading:g,team:j,user:b,branchAlias:v}=e,{track:w}=(0,X.useTrackActivity)(),{teamSlug:k,project:C}=(0,ei.useParams)()??{},[D,S]=(0,x.useState)(()=>n.find(e=>e.pendingRequests>0)?.id??n.find(e=>!(e.url.endsWith("vercel.app")||j?.previewDeploymentSuffix&&e.url.endsWith(j.previewDeploymentSuffix)))?.id??(i?n.find(e=>e.id===i)?.id:void 0)??n.find(e=>e.id!==a.id)?.id??a.id),A=n.find(e=>e.id===D),T=(0,eo.getProtectionBypass)(A??{},"shareable-link");(0,x.useEffect)(()=>{w(J.VercelActivityAction.DeploymentShareOpened,{})},[w]);let[N,E]=(0,x.useState)(!1);(0,x.useEffect)(()=>{N&&w(J.VercelActivityAction.DeploymentInviteScreenOpened,{})},[N,w]);let P=(0,x.useMemo)(()=>(e=>{let{previewCommentsEnabledForDeployment:t,protectionEnabledForDeployment:n}=e;return!t&&n?"view":t&&!n?"comment":"view and comment"})({previewCommentsEnabledForDeployment:d,protectionEnabledForDeployment:!!m}),[d,m]),M=(0,F.useToasts)(),H=(0,x.useCallback)(async e=>{if(!l&&A&&("create"===e||T)){switch(e){case"create":Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_GENERATE_EXTERNAL_LINK,{projectId:p.id});break;case"delete":Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_DISABLE_EXTERNAL_LINK,{projectId:p.id});break;case"regenerate":Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_REGENERATE_EXTERNAL_LINK,{projectId:p.id})}g(!0);try{let t=await (0,ea.updateAliasProtectionBypass)({teamId:j?.id,aliasId:A.id,body:"create"!==e?{revoke:{secret:T||"",regenerate:"regenerate"===e}}:{}});if("create"===e){let e=eD({alias:A.url,protectionBypass:(0,eo.getProtectionBypass)(t,"shareable-link"),protectionEnabledForDeployment:!0});e&&(0,tf.copyToClipboard)(e),M.success("A shareable link was generated and copied to your clipboard.")}}catch(e){M.error("An error occured, please try again later.")}await y(),g(!1)}},[A,l,p.id,T,y,M,j?.id,g]),{can:z}=(0,et.default)(),$=z(en.Action.Update,"production"===a.target?en.Resource.ProductionAliasProtectionBypass:en.Resource.AliasProtectionBypass),q=(0,er.useOpenUpgradeModal)(),Y=(0,el.getAliasDeploymentProtectionException)(A?.protectionBypass),W=(0,t.jsx)(tw,{branchAliasId:i,canUpdateProtectionBypass:$,getLinkToProtectionSettingsInner:()=>I({team:j,user:b,projectName:p.name}),isPreviewDeployment:o,productionProtectionEnabled:u,protectionBypass:T,protectionEnabledForDeployment:m,selectedTargetId:D,setSelectedTargetId:S,targets:n}),K=k&&C&&v?.deploymentId?(0,es.getDashboardHref)(`/${C}/${v.deploymentId.replace("dpl_","")}`,k):void 0,ee=D===a.id&&v?.deploymentId&&v.deploymentId!==a.id&&K?(0,t.jsxs)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Go to latest branch deployment",href:K,shape:"square",size:"small",svgOnly:!0,children:(0,t.jsx)(U.ArrowRight,{})}),className:"!text-gray-1000",fill:!0,type:"secondary",children:["There is a newer deployment for"," ",r?.branchName?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.GitBranch,{className:"mr-0.5 align-middle",size:14}),(0,t.jsx)(B.Text,{as:"span",monospace:!0,children:r.branchName})]}):"this branch",". To share it go to the latest."]}):null;return N&&(d||m)&&A?(0,t.jsx)(tj,{branchAliasId:i,canUpdateProtectionBypass:$,deployment:a,git:r,header:W,invitationFocused:N,onCancel:()=>E(!1),onFinished:()=>E(!1),onFocus:()=>void 0,openUpgradeModal:()=>{s(),q({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:P}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Modal.Body,{className:"px-5 py-6",padding:!1,children:(0,t.jsx)(R.Scroller,{overflow:"y",scrollerClassName:"px-1 max-h-[80vh]",children:(0,t.jsxs)(O.Stack,{gap:6,children:[W,ee,Y?(0,t.jsxs)(L.Note,{fill:!0,type:"warning",variant:"contrast",children:["This domain is listed in"," ",(0,t.jsx)(_.Link,{href:`${I({team:j,user:b,projectName:p.name})}#deployment-protection-exceptions`,variant:"underline",children:"Deployment Protection Exceptions"}),", making it is currently"," ",(0,t.jsx)(B.Text,{as:"span",color:"inherit",weight:600,children:"unprotected"})," ","and"," ",(0,t.jsx)(B.Text,{as:"span",color:"inherit",weight:600,children:"publicly available"}),"."]}):null,d||m?A&&(0,t.jsx)(tj,{branchAliasId:i,canUpdateProtectionBypass:$,deployment:a,git:r,header:W,invitationFocused:N,onCancel:()=>void 0,onFinished:()=>void 0,onFocus:()=>E(!0),openUpgradeModal:()=>{s(),q({source:"Hobby account email invite limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d,revalidateAlias:y,selectedTarget:A,teamId:j?.id,viewAndCommentDescription:P}):null,(0,t.jsx)(eH,{branchAliasId:i,branchName:r?.branchName,canUpdateProtectionBypass:$,hideStaticTeamMembersBanner:!m&&!d,onUpgradeClick:()=>{s(),Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_UPGRADE_TO_PRO_CLICKED,{projectId:p.id}),q({source:"Hobby account approve request limit call to upgrade",trialBehavior:"choose"})},project:p,revalidateAlias:y,target:A}),!d&&o?(0,t.jsx)(t.Fragment,{children:c?(0,t.jsx)(L.Note,{className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,size:"small",type:"secondary",children:"Comments will be available for new builds."}):(0,t.jsx)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Enable Comments",href:(e=>{let{team:t}=e;return t?`/${t.slug}/~/settings/general#toolbar`:"/account/general#toolbar"})({team:j}),onClick:()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_PREVIEW_COMMENTS,{projectId:p.id})},shape:"square",size:"tiny",svgOnly:!0,tab:!0,type:"tertiary",children:(0,t.jsx)(G.SettingsGear,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable comments for this deployment."})}):null,h?null:(0,t.jsx)(L.Note,{action:(0,t.jsx)(_.ButtonLink,{"aria-label":"Enable Deployment Protection",href:I({team:j,user:b,projectName:p.name}),onClick:()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_SHARE_CLICK_ON_ENABLE_VERCEL_AUTHENTICATION,{projectId:p.id})},shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(U.ArrowRight,{})}),className:"rounded-md !px-1 !py-0 !pl-2 !text-[13px]",fill:!0,label:!1,size:"small",type:"secondary",children:"Enable Deployment Protection for this project."})]})})}),(0,t.jsx)(f.Modal.Actions,{children:(0,t.jsx)(eA,{alias:A?.url,canUpdateShareableLink:$,deployment:a,git:r,isLoading:l,onCreateShareableLink:()=>void H("create"),onDeleteShareableLink:()=>void H("delete"),onRegenerateShareableLink:()=>void H("regenerate"),openUpgradeModal:()=>{s(),q({source:"Hobby account shareable link limit call to upgrade",trialBehavior:"choose"})},previewCommentsEnabledForDeployment:d??!1,protectionBypass:T,protectionEnabledForDeployment:m,viewAndCommentDescription:P})})]})}function tw(e){let{canUpdateProtectionBypass:n,getLinkToProtectionSettingsInner:i,isPreviewDeployment:a,productionProtectionEnabled:r,protectionBypass:l,protectionEnabledForDeployment:o,targets:s,selectedTargetId:c,setSelectedTargetId:d,branchAliasId:u}=e,p=s.some(e=>e.pendingRequests>0&&e.id!==c);return(0,t.jsxs)(O.Stack,{align:"center",direction:"row",justify:"space-between",children:[(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(B.Text,{size:24,weight:600,children:"Share"}),s.length>1?(0,t.jsxs)(P.MenuContainer,{children:[(0,t.jsxs)(E.MenuButton,{"aria-label":"Select URL",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:[(0,t.jsx)(z.ChevronDown,{}),p?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-green-500"}):null]}),(0,t.jsx)(N.Menu,{width:"auto",children:s.map(e=>{var n,i;let a=(n=e,i=u,n.id===i?V.GitBranch:n.id.startsWith("dpl_")?$.GitCommit:q.Globe);return(0,t.jsx)(M.MenuItem,{onClick:()=>{d(e.id)},prefix:(0,t.jsx)(a,{}),suffix:e.id===c?(0,t.jsx)(H.Check,{}):null,children:(0,t.jsxs)(O.Stack,{align:"center",direction:"row",gap:2,children:[e.url,e.pendingRequests>0?(0,t.jsx)(T.Badge,{className:"min-w-5",size:"sm",variant:"blue",children:e.pendingRequests}):null]})},e.id)})})]}):null]}),n&&(a||o)?(0,t.jsx)(tk,{getLinkToProtectionSettingsInner:i,isProtectionBypassShareableLink:!!l,productionProtectionEnabled:r,protectionEnabledForDeployment:o}):null]})}function tk(e){let{getLinkToProtectionSettingsInner:n,productionProtectionEnabled:i,isProtectionBypassShareableLink:a,protectionEnabledForDeployment:r}=e,l=(0,ee.useIsMobile)(),o=a?"Deployment Protection can be bypassed with the Shareable Link":`${i?"All":"Preview"} deployments ${!l?"in this project ":""}are protected`,c=a?(0,t.jsx)(W.ShieldGlobe,{}):(0,t.jsx)(Y.Shield,{}),d=r?c:(0,t.jsx)(K.ShieldOff,{});return(0,t.jsx)(s.Tooltip,{desktopOnly:!0,text:r?o:"Deployment Protection is not enabled and deployments are publicly accessible",children:(0,t.jsx)(_.ButtonLink,{align:"center","aria-label":"Settings",href:n(),label:"Settings",shape:"circle",size:"small",svgOnly:!0,type:"tertiary",children:d})})}function tC(e){let{deployment:i,project:a,mutateDeployment:r,...l}=e,{user:s,team:d,account:u}=(0,c.useAccount)(),p=u?.billing?.plan==="hobby",m=!!i.buildSkipped,{targets:h,branchAliasId:I,branchAlias:T,isLoading:N,mutate:E}=function(e){let{data:t}=(0,S.useCurrentDashboardDeploymentDomains)({revalidateIfStale:!1,revalidateOnFocus:!1}),n=(0,v.useTeamSlug)(),{data:i,mutate:a,isLoading:r}=(0,C.useAliasesV2)({deploymentId:e?.id,teamId:n??void 0}),l=t.branch??e?.meta.branchAlias??(e?.alias?e.alias[e.alias.length-1]:void 0),o=(0,x.useMemo)(()=>{let n,a=e?[{id:e.id,url:e.url,protectionBypass:e.protectionBypass,pendingRequests:tD(e)}]:[];if(!i)return{targets:a};for(let e of i.aliases)e.redirect||(e.alias===l&&(n=e.uid),a.push({id:e.uid,url:e.alias,protectionBypass:e.protectionBypass,pendingRequests:tD(e)}));let r=[t.commit,t.branch??"",...t.aliases].filter(Boolean);return a.sort((e,t)=>r.indexOf(e.url)-r.indexOf(t.url)),{targets:a,branchAliasId:n}},[l,i,e,t]),s=l&&!o.branchAliasId,{data:c,mutate:d,isLoading:u}=(0,D.default)({domain:s?l:void 0});return{isLoading:r||u,mutate:async()=>{await a(),await d()},targets:o.targets,branchAliasId:o.branchAliasId||c?.uid,branchAlias:c}}(i),P=(0,w.getGitMeta)(i.meta),M=(0,x.useMemo)(()=>h.some(e=>e.pendingRequests>0),[h]),L="production"!==i.target,{value:R}=(0,A.useArePreviewCommentsEnabled)({target:L?"preview":"production",branch:P?.branchName}),[O,B]=(0,x.useState)(!1),{protectionEnabledForDeployment:F,protectionEnabledForProject:_,isLoading:U,productionProtectionEnabled:H}=(e=>{let{deployment:t,project:n,isProjectLoading:i=!1}=e;if(!t||!n)return i?{isLoading:!0,protectionEnabledForDeployment:null,protectionEnabledForProject:null,productionProtectionEnabled:null}:{isLoading:!1,protectionEnabledForDeployment:!1,protectionEnabledForProject:!1,productionProtectionEnabled:!1};let{passwordProtection:a,ssoProtection:r,trustedIps:l}=n,o="production"!==t.target,s=["preview","prod_deployment_urls_and_all_previews","all_except_custom_domains"],c=a?.deploymentType==="all"||o&&a?.deploymentType&&s.includes(a.deploymentType),d=r?.deploymentType==="all"||o&&r?.deploymentType&&s.includes(r.deploymentType),u=l?.deploymentType==="all"||!o&&l?.deploymentType==="production"||o&&l?.deploymentType&&s.includes(l.deploymentType);return{productionProtectionEnabled:a?.deploymentType==="all"||r?.deploymentType==="all"||l?.deploymentType==="all",protectionEnabledForProject:!!(a||r||l),protectionEnabledForDeployment:!!(c||d||u),isLoading:!1}})({deployment:i,project:a}),z=(0,A.useCommentsEnabledForDeployment)(i),V=(0,x.useMemo)(()=>O?(0,t.jsx)(b.Spinner,{}):F?p?(0,t.jsx)(y.User,{}):(0,t.jsx)(g.Users,{}):(0,t.jsx)(j.Share,{}),[F,p,O]),[$,q,G]=(()=>{let[e,t]=(0,x.useState)(!1);return[e,(0,x.useCallback)(()=>t(!0),[]),(0,x.useCallback)(()=>t(!1),[])]})();return((0,k.default)("openSharing",()=>{q()}),N||U)?L||z?(0,t.jsx)(n.Skeleton,{className:l.className,height:40,width:"100%"}):null:z||F?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Button,{disabled:m||0===h.length,onClick:q,prefix:V,style:{color:m||0===h.length?void 0:"gray-900"},type:"secondary",typeName:"button",...l,children:["Share",M?(0,t.jsx)("div",{className:"absolute -right-0.5 -top-0.5 size-2 rounded-full bg-geist-success"}):null]}),(0,t.jsx)(f.Modal.Modal,{active:$,disableFocusTrap:!0,onClickOutside:G,children:(0,t.jsx)(tv,{branchAlias:T,branchAliasId:I,deployment:i,git:P,isLoading:O,isPreviewDeployment:L,modalClose:G,previewCommentsEnabledForBranch:R??z,previewCommentsEnabledForDeployment:z,productionProtectionEnabled:H,project:a,protectionEnabledForDeployment:F,protectionEnabledForProject:_,revalidateAlias:async()=>{await E(),await r()},setIsLoading:B,targets:h,team:d,user:s})})]}):null}function tD(e){return Object.values(e?.protectionBypass??{}).filter(e=>"user"===e.scope&&"requested"===e.access).length}var tS=e.i(6613731),tA=e.i(4478191),tI=e.i(4110415),tT=e.i(6293744);function tN(e){let{className:n,...i}=e;return(0,t.jsx)(_.ButtonLink,{className:(0,l.clsx)(n,"min-w-[80px] flex-1"),...i})}function tE(e){let{className:n,...i}=e;return(0,t.jsx)(o.Button,{className:(0,l.clsx)(n,"min-w-[96px] flex-1"),...i})}function tP(e){let{deployment:n,project:i}=e,{user:a,team:r}=(0,c.useAccount)(),{areChecksRunning:l,areDomainsAssigning:o}=(0,m.getDeploymentStatus)(n),s=(0,tI.useShouldVisitWithTheToolbar)(n),{permissions:d}=(0,tT.useDeploymentPermissions)({project:i,deployment:n}),u=n.readyState,h=(0,p.useIsViewingPublicDeployment)(),{onClick:x,...y}=(0,tS.useWrappedToolbarAuthLinkHandler)({via:"deployment-visit-button",deployment:h?void 0:n});return l?(0,t.jsx)(tE,{disabled:!0,children:"Waiting for Checks"}):o?(0,t.jsx)(tE,{disabled:!0,children:"Waiting for Domains"}):(a||r)&&d.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?null:"READY"===u?s&&"production"===n.target?(0,t.jsx)(tI.VisitWithToolbarButton,{Component:tN,buttonProps:{href:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||i?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:x,...y,target:"_blank"},className:"flex-1",page:n.defaultRoute?.startsWith("/")?n.defaultRoute:`/${n.defaultRoute??""}`,url:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),via:"deployment-visit-button",children:"Visit"}):(0,t.jsx)(tN,{href:(0,tA.withDefaultRoute)((0,eC.domainToUrl)(n.url),n.defaultRoute),onClick:()=>{Q.analytics.track(Z.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_VISIT_BUTTON,{projectId:n.projectId||i?.id,deploymentId:n.id,deploymentTarget:n.target})},passthroughOnClick:x,...y,target:"_blank",children:"Visit"}):(0,t.jsx)(tN,{disabled:!0,href:`https://${n.host}`,...y,children:"Visit"})}let tM="min-w-[96px] flex-1 px-[10px]";function tL(e){let{className:n,...i}=e;return(0,t.jsx)(o.Button,{className:(0,l.clsx)(tM,n),...i})}function tR(e){let{deployment:n,project:i,mutateDeployment:a}=e,{user:r,team:l}=(0,c.useAccount)(),{areChecksRunning:o,areDomainsAssigning:x}=(0,m.getDeploymentStatus)(n),{permissions:y}=(0,tT.useDeploymentPermissions)({project:i,deployment:n}),{openRedeployModal:g,openCancelDeploymentModal:j,isLoadingModals:b}=(0,h.useDeploymentModals)(),f=n.readyState,v=(0,p.useIsViewingPublicDeployment)();return o?(0,t.jsx)(tL,{disabled:!0,children:"Waiting for Checks"}):x?(0,t.jsx)(tL,{disabled:!0,children:"Waiting for Domains"}):"ERROR"===f?v||!y.canCreateDeployment?(0,t.jsx)(s.Tooltip,{className:"min-w-x[96px] flex-1",position:"top",text:"You are not the owner of this deployment. In turn, you cannot re-deploy it.",children:(0,t.jsx)(tL,{disabled:!0,prefix:(0,t.jsx)(u.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"})}):(0,t.jsx)(tL,{disabled:b,onClick:g,prefix:(0,t.jsx)(u.RotateCounterClockwise,{}),type:"secondary",children:"Redeploy"}):(r||l)&&y.canUpdateDeployment&&!["READY","ERROR","CANCELED"].includes(n.readyState)?(0,t.jsx)(tL,{onClick:j,prefix:(0,t.jsx)(d.StopCircle,{}),style:{paddingInline:6},type:"secondary",children:"Cancel"}):(0,t.jsxs)(t.Fragment,{children:[i?(0,t.jsx)(tC,{className:tM,deployment:n,mutateDeployment:a,project:i}):null,(0,t.jsx)(tP,{deployment:n,project:i})]})}function tO(){return(0,t.jsx)(n.Skeleton,{className:"min-w-[96px] flex-1 px-[10px]",height:40,width:"100%"})}function tB(){let{data:e,mutate:n}=(0,i.useCurrentDashboardDeploymentInterval)(),{data:r}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(tR,{deployment:e,mutateDeployment:n,project:r})}function tF(){let{data:e}=(0,i.useCurrentDashboardDeploymentInterval)(),{data:n}=(0,a.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(r.DeploymentMoreMenu,{deployment:e,project:n})}},2887949,e=>{"use strict";e.s(["CurrentDeploymentScreenshot",()=>c]);var t=e.i(751170),n=e.i(4099374),i=e.i(5255926),a=e.i(8159863),r=e.i(1776423),l=e.i(3748432);function o(){let{data:e}=(0,a.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(l.NavigationMarker,{phase:"content",label:"DeploymentScreenshot",children:(0,t.jsx)("div",{className:"aspect-[16/10] lg:w-[400px] md:w-[320px] w-full overflow-hidden ",children:(0,t.jsx)(r.ScreenshotOrStatus,{deployment:e,ignoreAliasWarning:!1,placeholder:!1,showError:!0,toolbarVia:"deployment-screenshot",useDeploymentUrl:!0})})})}function s(){return(0,t.jsx)(i.Skeleton,{autoSize:!0,className:"aspect-[16/10] lg:w-[400px] md:w-[320px] w-full border border-solid rounded-sm overflow-hidden border-gray-alpha-400"})}function c(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)(l.NavigationMarker,{phase:"skeleton",label:"DeploymentScreenshot",children:(0,t.jsx)(s,{})}),children:(0,t.jsx)(o,{})})}},9411547,e=>{"use strict";e.s(["CurrentDeploymentConfiguration",()=>r]);var t=e.i(751170),n=e.i(4099374),i=e.i(3679047),a=e.i(5566974);function r(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)(a.DeploymentConfigurationSkeleton,{className:"rounded-b"}),children:(0,t.jsx)(l,{})})}function l(){let{id:e=""}=(0,i.useParams)()??{};return(0,t.jsx)(a.DeploymentConfiguration,{className:"rounded-b",deploymentId:e})}},3294071,e=>{"use strict";e.s(["CurrentDeploymentCreator",()=>ei,"CurrentDeploymentDomains",()=>ea,"CurrentDeploymentDuration",()=>X,"CurrentDeploymentEnvironment",()=>en,"CurrentDeploymentSource",()=>et,"CurrentDeploymentStatus",()=>ee],3294071);var t=e.i(751170),n=e.i(4099374),i=e.i(3679047),a=e.i(5468328),r=e.i(4004502),l=e.i(7218483),o=e.i(2940029),s=e.i(2982888);function c(e){let{deployment:n,...i}=e,{createdAt:c,createdAgo:d}=function(e){let t=e.undeleted||e.deleted||e.createdAt||e.created;return{createdAt:t?new Date(t).toLocaleDateString(void 0,{hour:"numeric",minute:"2-digit",second:"2-digit",year:"numeric",month:"short",day:"numeric",timeZoneName:"short"}):"",createdAgo:(0,l.useAgo)(t)}}(n);return(0,t.jsxs)(o.Attribute.Item,{"data-testid":(0,r.tid)("deployment","creator"),...i,children:[(0,t.jsx)("span",{className:"flex-none",children:(0,t.jsx)(s.DeploymentCreatorAvatar,{deployment:n,iconBackground:!1,showIcon:!1,size:18})}),(0,t.jsx)("span",{className:"text-label-14 -ml-px shrink truncate",children:(0,s.getDeploymentCreatorUsername)({deployment:n})}),(0,t.jsx)(a.Tooltip,{className:"flex-none",text:c,children:(0,t.jsx)("span",{className:"text-gray-900 tabular-nums",children:d})})]})}var d=e.i(85019),u=e.i(8735244),p=e.i(3978547),m=e.i(4641028),h=e.i(5356862);function x(e){let{deployment:n,icon:s,onlyBuild:c=!1,...h}=e,{deleted:x,inProgress:g,finishedAgo:j,ageSinceBuilding:b,deploymentDuration:f,finishedAgoTitle:v}=function(e,t){let{teamSlug:n}=(0,i.useParams)()??{},a=(0,l.useAge)(e.buildingAt||void 0,{includeSeconds:!0}),r="id"in e?e.id:e.uid,o="READY"===e.readyState&&e.checksState,{checks:s}=(0,m.default)({deploymentId:o?r:void 0,teamId:n}),c=y(e,s,t)||0,u=c&&e.buildingAt?e.buildingAt+c:void 0,p=void 0!==e.deleted,h=u?new Date(u).toLocaleDateString(void 0,{hour:"numeric",minute:"2-digit",second:"2-digit",year:"numeric",month:"short",day:"numeric",timeZoneName:"short"}):"",x=(0,l.useAgo)(u,{suffix:" ago",alwaysRelative:!0}),g=e.checksState&&!e.checksConclusion,j=!!("BUILDING"===e.readyState||"READY"===e.readyState&&!e.aliasAssigned&&g);return{ageSinceBuilding:a,deploymentDuration:function(e,t,n){let i=y(e,t,n);return(0,d.age)(i,{includeSeconds:!0})}(e,s,t)||"—",finishedAgo:x,finishedAgoTitle:h,inProgress:j,finishedAt:u,deleted:p}}(n,c),w=null;return s&&!g&&(w=(0,t.jsx)(p.ClockDashed,{color:"gray-900"})),g&&(w=(0,t.jsx)(u.Spinner,{size:16})),(0,t.jsxs)(o.Attribute.Item,{"aria-label":v,"data-testid":(0,r.tid)("deployment","duration"),className:"tabular-nums",...h,children:[w,x?j:(0,t.jsxs)(t.Fragment,{children:[g?b:f,!g&&j?(0,t.jsx)(a.Tooltip,{text:v,children:(0,t.jsx)("span",{className:"text-gray-900",children:j})}):null]})]})}function y(e,t,n){if(!e||"BUILDING"===e.readyState||!("buildingAt"in e))return;let i="readyStateAt"in e?e.readyStateAt:e.ready;if(!i||!e.buildingAt)return;let a=i-e.buildingAt;if(n)return a;let r=t?.length?(0,h.getChecksTimes)(t,e):void 0,l=r?.checksFinishedAt&&r.checksStartedAt?r.checksFinishedAt-r.checksStartedAt:0,o=e.aliasAssignedAt??("number"==typeof e.aliasAssigned?e.aliasAssigned:void 0),s=0;if(o){let e=r?.checksFinishedAt?o-r.checksFinishedAt:o-i;e<18e5&&(s=e)}return a+l+s}var g=e.i(8216525),j=e.i(57106),b=e.i(5479400),f=e.i(4345845),v=e.i(3228096),w=e.i(9386557),k=e.i(5499338),C=e.i(5797774),D=e.i(6613731),S=e.i(475038),A=e.i(4478191),I=e.i(1681029),T=e.i(822157),N=e.i(2405448),E=e.i(542164);function P(e){let i,{url:a,defaultRoute:r}=e,[l,o]=(0,n.useState)(!1),s=(0,N.default)(a),c=(0,E.default)(a);return(0,t.jsx)(t.Fragment,{children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Link,{as:"button",className:"hover:underline",onClick:()=>o(!0),children:a}),(0,t.jsx)(T.default,{active:l,onCancel:()=>{o(!1)},url:s})]}):(0,t.jsx)(j.Link,{className:"hover:underline",href:(i=(0,I.domainToUrl)(a),(0,A.withDefaultRoute)(i,r)),children:a})})}var M=e.i(8172029),L=e.i(8785423);function R(e){let{deploymentDomains:n,deployment:r}=e,l=(0,S.useIsViewingPublicDeployment)(),s=(0,D.useWrappedToolbarAuthLinkHandler)({via:"deployment-domains-list",deployment:l?void 0:r}),{branch:c,commit:d,aliases:u,defaultRoute:p}=n,m=e=>(0,A.withDefaultRoute)(e,p),h=(0,L.useDomainConfigs)(u.filter(e=>!e.endsWith(".vercel.app")).slice(0,10),{strict:!1,projectIdOrName:r.projectId}),x=!!h.data?.some(e=>{if(!e.isOk())return!1;let t=e.value,n=!!(t.recommendedIPv4||t.recommendedCNAME);return"required-change"===t.ipStatus&&!!n}),y=(0,i.useParams)(),g=(0,M.getQueryParam)(y?.teamSlug),T=(0,M.getQueryParam)(y?.project),N=`/${g}/${T}/settings/domains`;return(0,t.jsxs)(t.Fragment,{children:[u.length>0?(0,t.jsxs)(o.Attribute.Item,{Icon:v.Globe,children:[(0,t.jsx)(P,{defaultRoute:p,url:u[0]}),u.length>1&&(0,t.jsx)(C.ContextCard.Trigger,{content:(0,t.jsxs)("div",{className:"text-label-13 flex flex-col gap-2",children:[(0,t.jsx)("span",{className:"text-gray-900",children:"Assigned Domains"}),(0,t.jsx)("div",{className:"flex flex-col gap-1.5 hover:[&>a]:underline",children:u.slice(1).map(e=>(0,t.jsx)(P,{defaultRoute:p,url:e},e))})]}),children:(0,t.jsxs)(k.Badge,{size:"sm",variant:"gray-subtle",children:["+",u.length-1]})}),x?(0,t.jsx)(a.Tooltip,{text:(0,t.jsxs)("div",{children:["To avoid downtime, you must change your DNS records for one or more of these domains. Visit the"," ",(0,t.jsx)(j.Link,{href:N,tab:!0,variant:"highlight",children:"domains settings"})," ","for this project for more information."]}),position:"top",children:(0,t.jsx)(w.WarningFill,{color:"red-700",size:"sm"})}):null]}):null,c?(0,t.jsxs)(o.Attribute.Item,{children:[(0,t.jsx)(a.Tooltip,{className:"flex-none",position:"left",text:"Latest deployment on branch—updates automatically",children:(0,t.jsx)(f.GitBranch,{color:"gray-900"})}),(0,t.jsx)(j.Link,{...s,className:"hover:underline",href:m((0,I.domainToUrl)(c)),children:c})]}):null,(0,t.jsxs)(o.Attribute.Item,{children:[(0,t.jsx)(a.Tooltip,{className:"flex-none",position:"left",text:"Deployment associated with this commit",children:(0,t.jsx)(b.GitCommit,{color:"gray-900"})}),(0,t.jsx)(j.Link,{...s,className:"hover:underline",href:m((0,I.domainToUrl)(d)),children:d})]})]})}var O=e.i(8893913),B=e.i(3753138);e.i(3182268);var F=e.i(7849855),_=e.i(9481787),U=e.i(2634426),H=e.i(6107899),z=e.i(3981247),V=e.i(6338279),$=e.i(3349841),q=e.i(5002318),G=e.i(4597921),Y=e.i(4206574);function W(e){let{deployment:n,project:i}=e,r=(0,$.useIsCurrentProductionDeployment)(n),{teamSlug:l,projectSlug:s}=(0,F.useProjectAndTeamSlug)(),c=r&&i?.lastAliasRequest?.type==="rollback"&&i.lastAliasRequest.toDeploymentId===n.id||!1,{deploymentTargetConfigurationUrl:d,deploymentTargetLabel:u}=(0,V.useDeploymentEnvironmentLabel)({deployment:n}),{data:p}=(0,z.useRollingRelease)({teamIdOrSlug:l,projectSlug:s}),m=p?.rollingRelease,h=m?.canaryDeployment?.id===n.id;n.aliasAssignedAt;let x=(0,Y.getPromotionStatusInfo)({deployment:n,rollingRelease:m,project:i}),y=x?(0,t.jsx)(q.DeploymentAliasToolTipText,{...x}):null,g="production"===n.target&&"STAGED"===n.readySubstate,b=(0,G.useServerFlag)("promotion-status-visible",!1),f=!g||r||b?null:(0,t.jsx)("span",{className:"text-label-14 text-gray-900",children:" Staged"}),v=null;if(h){let{activeStage:e}=m;e?.targetPercentage&&(f=null,v=(0,t.jsx)(a.Tooltip,{text:y,children:(0,t.jsx)(k.Badge,{size:"sm",variant:"blue-subtle",children:(0,t.jsx)(j.Link,{className:"hover:underline",href:(0,_.getDashboardHref)(`/${s}/deployments/rolling-release`,l||void 0),children:"Canary"})})}))}(r||c)&&(v=(0,t.jsx)(a.Tooltip,{text:y,children:(0,t.jsxs)(k.Badge,{size:"sm",variant:c?"amber-subtle":"blue-subtle",children:[c?(0,t.jsx)(O.RotateCounterClockwise,{size:12}):null,(0,t.jsx)("span",{style:{paddingLeft:c?.5:void 0},children:"Current"})]})}));let w=U.Layers;return"production"===u.toLowerCase()&&(w=B.ArrowCircleUp),"preview"===u.toLowerCase()&&(w=H.PreviewEye),(0,t.jsxs)(o.Attribute.Item,{Icon:w,className:"flex-wrap",children:[d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Link,{className:"hover:underline",href:d,children:u}),f]}):(0,t.jsxs)(t.Fragment,{children:[u,f]}),v]})}var K=e.i(7952998),Q=e.i(8159863),Z=e.i(1585391),J=e.i(3212616);function X(){let{data:e}=(0,Q.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(x,{deployment:e,icon:!0,onlyBuild:!0})}function ee(){let e=(0,i.useParams)(),{data:n}=(0,Q.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(g.DeploymentStatus,{deployment:n,hint:!0,label:!0,projectSlug:e?.project,teamSlug:e?.teamSlug})}function et(){let{data:e}=(0,Q.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(K.DeploymentSource,{deployment:e})}function en(){let{data:e}=(0,Q.useCurrentDashboardDeploymentInterval)(),{data:n}=(0,J.useCurrentDashboardDeploymentOverviewProject)();return(0,t.jsx)(W,{deployment:e,project:n})}function ei(){let{data:e}=(0,Q.useCurrentDashboardDeploymentInterval)();return(0,t.jsx)(c,{deployment:e})}function ea(){let{data:e}=(0,Q.useCurrentDashboardDeploymentInterval)(),{data:i,mutate:a}=(0,Z.useCurrentDashboardDeploymentDomains)(),{readyState:r,readySubstate:l}=e;return(0,n.useEffect)(()=>{"READY"===r&&a()},[l,r,a]),(0,t.jsx)(R,{deployment:e,deploymentDomains:i})}},4905082,e=>{"use strict";e.s(["DeploymentSWRConfig",()=>a]);var t=e.i(751170),n=e.i(9014736);let i=new Set([400,403,404]);function a(e){let{children:a}=e;return(0,t.jsx)(n.SWRConfig,{value:{shouldRetryOnError:e=>!("status"in e)||!i.has(e.status)},children:a})}}]);

//# sourceMappingURL=f3eef9db2d867396.js.map
//# debugId=86a20c5c-01a5-5a4a-a8f9-95c4bc1aec70
