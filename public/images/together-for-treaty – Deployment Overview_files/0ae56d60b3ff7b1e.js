
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e4432b8c-5beb-535b-a27d-dd4daaf7dae7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3774835,e=>{"use strict";e.s(["useManagedRulesets",()=>r]);var t=e.i(277234),a=e.i(9014736);function r(e){let{projectIdOrName:r,teamIdOrSlug:s}=e;return(0,a.default)(["/v1/security/firewall/managed-rules",new URLSearchParams({projectId:r,teamId:s}).toString()],e=>{let[a,r]=e;return(0,t.default)(`${a}?${r}`)})}},1313611,e=>{"use strict";e.s(["useQuerySelect",()=>i]);var t=e.i(4099374),a=e.i(7432042),r=e.i(1233856),s=e.i(8353464);function i(e){let s=(0,t.useMemo)(()=>"live"===e.range?{seconds:10}:{minutes:"1h"===e.range?1:15},[e.range]),i=(0,t.useMemo)(()=>{let t=new Date,i="live"===e.range?(0,a.default)("10m"):(0,a.default)(e.range);return{end:(0,r.endOfDuration)(t,s),start:(0,r.startOfDuration)(new Date(t.getTime()-i),s)}},[s,e.range]);return(0,t.useMemo)(()=>{let t="default_web_traffic"===e.filter,a="all_rules"===e.filter?500:20;return"BotID"===e.filter?{event:"botIdCheck",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:s,groupBy:n(e),filter:l(e),limit:a,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}:t?{event:"incomingRequest",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:s,groupBy:n(e),filter:l(e),limit:a,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}:{event:"firewallAction",reason:"firewall_tab",rollups:{value:{measure:"count",aggregation:"sum"}},granularity:s,groupBy:n(e),filter:l(e),limit:a,tailRollup:"others",summaryOnly:!1,startTime:i.start,endTime:i.end}},[s,i,e])}function l(e){if("BotID"===e.filter)return"";let t=[];switch(e.action){case"allow":t.push("wafAction eq 'allow'");break;case"challenge":t.push("wafAction in ('challenge', 'challenge-failed', 'challenge-solved')");break;case"all":break;default:t.push(`wafAction eq '${(0,s.denormalizeFirewallAction)(e.action)}'`)}let a=(0,s.wafRuleId)(e.filter);return"all_rules"!==e.filter&&t.push(`wafRuleId eq '${a}'`),t.join(" and ")}function n(e){let t=[];return"BotID"!==e.filter&&t.push("wafAction"),"all_rules"===e.filter?t.unshift("wafRuleId"):t.unshift(e.groupBy),"clientIp"===e.groupBy&&t.push("asnId","asnName","clientIpCountry"),t.map(t=>"sourcePath"===t?"default_web_traffic"===e.filter?"route":"requestPath":t)}},8778858,e=>{"use strict";e.s(["useAttackStatus",()=>s]);var t=e.i(818351),a=e.i(4244280),r=e.i(8042625);function s(e){let{teamId:s,projectId:i}=e;return(0,t.useIsomorphicSWR)(`${a.API_FIREWALL}/firewall/attack-status${(0,r.encode)({teamId:s,projectId:i})}`)}},9782441,e=>{"use strict";e.s(["ProjectCardDetailsContent",()=>o,"ProjectCardDetailsEmptyState",()=>c,"ProjectCardDetailsHeader",()=>n,"ProjectDetailsCard",()=>l]);var t=e.i(751170),a=e.i(57106),r=e.i(199192),s=e.i(6143247),i=e.i(2992903);function l(e){let{allowOverflow:a=!1,children:r,className:i}=e;return(0,t.jsx)("div",{className:(0,s.cn)("flex flex-col isolate shadow-sm rounded-md bg-background-100 h-[240px]",i,a?"overflow-visible":"overflow-hidden"),children:r})}function n(e){let{title:s,children:l,duration:n,href:o}=e;return(0,t.jsxs)("header",{className:"group relative z-[1] flex justify-between gap-x-0.5 px-4 py-3 pr-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1.5 py-0.5",children:[(0,t.jsx)("p",{className:"text-label-14 m-0",children:(0,t.jsx)("strong",{children:s})}),n?(0,t.jsx)("time",{className:"text-label-14 m-0 text-gray-900",children:n}):null,l]}),o?(0,t.jsx)(a.ButtonLink,{"aria-label":"Go to page",className:"z-[2] !text-gray-800 group-hover:!text-gray-1000 group-[&:not(:has(a[target]:hover)):hover]:bg-gray-alpha-200",href:o,prefetch:!1,prefetchStrategy:"hover",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",onClick:()=>{(0,i.track)("Project Card Clicked",{type:s})},children:(0,t.jsx)(r.ChevronRightSmall,{})}):null,o?(0,t.jsx)(a.Link,{className:"absolute inset-0 z-[1] block",href:o,tabIndex:-1,onClick:()=>{(0,i.track)("Project Card Clicked",{type:s})}}):null]})}function o(e){let{children:a,className:r}=e;return(0,t.jsx)("div",{className:(0,s.cn)("relative h-full",r),children:a})}function c(e){let{icon:a,subtitle:r,cta:s}=e;return(0,t.jsxs)("div",{className:"flex h-5/6 flex-col items-center justify-center gap-x-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2 text-gray-900",children:[a,(0,t.jsx)("p",{className:"text-label-14",children:r})]}),s]})}},244384,6944292,e=>{"use strict";e.s(["ProjectFirewallCard",()=>G,"ProjectFirewallCardSkeleton",()=>ea,"StatusBadge",()=>el],244384);var t=e.i(751170),a=e.i(57106),r=e.i(5499338),s=e.i(2504781),i=e.i(5255926),l=e.i(1344973),n=e.i(762945),o=e.i(4141852),c=e.i(2375916),d=e.i(3814652),u=e.i(5756088),m=e.i(9722978),x=e.i(818351),g=e.i(4244280),h=e.i(8042625),j=e.i(5338940),p=e.i(9014736),f=e.i(277234),b=e.i(7712782),y=e.i(1313611),v=e.i(5481907),w=e.i(8353464),C=e.i(8778858),S=e.i(4396019),N=e.i(9334638);let D=(0,N.withNewIcon)('<path fill="currentColor" fill-rule="evenodd" d="M8.125 9.67054V23.8179c0 3.7199 2.0648 7.1323 5.3599 8.8583L20 36.0889l6.5151-3.4127c3.2951-1.726 5.3599-5.1384 5.3599-8.8583V9.67054c-.6207-.181-1.2899-.35565-2.002-.54153-.3642-.09504-.7396-.19301-1.1254-.29626-1.4625-.39131-3.0324-.84866-4.4687-1.47955-1.4334-.62958-2.8155-1.46629-3.844-2.66311-.1542-.17947-.2994-.3658-.4349-.55915-.1355.19335-.2807.37968-.4349.55915-1.0285 1.19682-2.4106 2.03353-3.844 2.66311-1.4363.63089-3.0062 1.08824-4.4687 1.47955-.3858.10325-.7612.20122-1.1254.29626-.71213.18588-1.38133.36053-2.002.54153ZM18.75 0c0 1.31808-.4156 2.28639-1.0809 3.06066-.6904.80329-1.6991 1.4527-2.9534 2.00361-1.2512.54961-2.6657.96712-4.1095 1.35344-.344.09206-.69287.18307-1.0417.27408-1.07623.28078-2.15211.56146-3.08478.87236l-.85472.2849V23.8179c0 4.6498 2.58096 8.9154 6.6999 11.0729l7.0951 3.7165.58.3038.58-.3038 7.0951-3.7165c4.1189-2.1575 6.6999-6.4231 6.6999-11.0729V7.84905l-.8547-.2849c-.9327-.3109-2.0086-.59158-3.0848-.87236-.3488-.09101-.6977-.18202-1.0417-.27408-1.4438-.38632-2.8583-.80383-4.1095-1.35344-1.2543-.55091-2.263-1.20032-2.9534-2.00361C21.6656 2.28639 21.25 1.31808 21.25 0h-2.5Z" clip-rule="evenodd"/>',{size:40,viewBox:"0 0 40 40"}),k=(0,N.withNewIcon)('<path fill="currentColor" fill-rule="evenodd" d="M8.125 23.8179V9.67054c.62067-.18099 1.28985-.35565 2.002-.54152v-.00001c.3642-.09504.7396-.19301 1.1254-.29626 1.4625-.39131 3.0324-.84866 4.4687-1.47955 1.4334-.62958 2.8155-1.46629 3.844-2.66311.1542-.17947.2994-.3658.4349-.55915.1355.19335.2807.37968.4349.55915 1.0285 1.19682 2.4106 2.03353 3.844 2.66311 1.4363.63089 3.0062 1.08824 4.4687 1.47955.3857.10323.761.20118 1.1251.2962l.0003.00006c.7121.18588 1.3813.36053 2.002.54153V23.8179c0 3.7199-2.0648 7.1323-5.3599 8.8583L20 36.0889l-6.5151-3.4127c-3.2951-1.726-5.3599-5.1384-5.3599-8.8583Zm9.5441-20.75724C18.3344 2.28639 18.75 1.31808 18.75 0h2.5c0 1.31808.4156 2.28639 1.0809 3.06066.6904.80329 1.6991 1.4527 2.9534 2.00361 1.2512.54961 2.6657.96712 4.1095 1.35344.3439.09204.6927.18304 1.0415.27403l.0002.00005c1.0762.28078 2.1521.56146 3.0848.87236l.8547.2849V23.8179c0 4.6498-2.581 8.9154-6.6999 11.0729L20.58 38.6073l-.58.3038-.58-.3038-7.0951-3.7165C8.20596 32.7333 5.625 28.4677 5.625 23.8179V7.84905l.85472-.2849c.93267-.3109 2.00855-.59158 3.08478-.87236l.00019-.00005c.34877-.09099.69761-.18199 1.04151-.27403 1.4438-.38632 2.8583-.80383 4.1095-1.35344 1.2543-.55091 2.263-1.20032 2.9534-2.00361Zm9.7773 14.07324.8839-.8839-1.7678-1.7678-.8839.8839-9.1161 9.1161-2.2411-2.2411-.8839-.8839-1.7678 1.7678.8839.8839 3.125 3.125c.4882.4881 1.2796.4881 1.7678 0l10-10Z" clip-rule="evenodd"/>',{size:40,viewBox:"0 0 40 40"}),P=(0,N.withNewIcon)('<path fill="currentColor" fill-rule="evenodd" d="M8.22355 7.04658 3.38991 2.27895l-.88994-.87778L.720093 3.15674l.889937.87778L36.1782 38.1306l.8899.8778 1.7799-1.7556-.89-.8778-5.6898-5.6122c1.3492-2.0194 2.1068-4.4257 2.1068-6.9449V7.84905l-.8547-.2849c-.9327-.3109-2.0086-.59158-3.0848-.87236l-.0002-.00005c-.3488-.09099-.6976-.18199-1.0416-.27403-1.4437-.38632-2.8582-.80383-4.1095-1.35344-1.2542-.55091-2.2629-1.20032-2.9533-2.00361C21.6655 2.28639 21.25 1.31808 21.25 0h-2.5c0 1.31808-.4156 2.28639-1.081 3.06066-.6903.80329-1.699 1.4527-2.9533 2.00361-1.2513.54961-2.6657.96712-4.1095 1.35344-.344.09204-.69277.18304-1.04153.27403l-.00019.00005c-.45054.11754-.901.23506-1.34093.35479Zm2.06775 2.03954L30.4474 28.967c.9176-1.5276 1.4276-3.3004 1.4276-5.1491V9.67054c-.6207-.181-1.2899-.35565-2.0021-.54153l-.0002-.00006c-.3641-.09502-.7394-.19297-1.1252-.2962-1.4624-.39131-3.0323-.84866-4.4687-1.47955-1.4333-.62958-2.8154-1.46629-3.8439-2.66311-.1543-.17947-.2994-.3658-.4349-.55915-.1355.19335-.2807.37968-.4349.55915-1.0286 1.19682-2.4106 2.03353-3.844 2.66311-1.4363.63089-3.0063 1.08824-4.4687 1.47955-.3281.08779-.6486.17177-.9611.25337ZM5.62497 12.5712l2.5 2.4659v8.7808c0 3.7199 2.06473 7.1323 5.35993 8.8583L20 36.0889l6.1841-3.2393 1.8635 1.838c-.1227.0697-.2469.1374-.3725.2032L20.58 38.6073l-.58.3038-.58-.3038-7.0951-3.7165c-4.11897-2.1575-6.69993-6.4231-6.69993-11.0729V12.5712Z" clip-rule="evenodd"/>',{size:40,viewBox:"0 0 40 40"}),L=(0,N.withNewIcon)('<path fill="currentColor" fill-rule="evenodd" d="M8.125 23.8179V9.67054c.62067-.18099 1.28985-.35565 2.002-.54152v-.00001c.3642-.09504.7396-.19301 1.1254-.29626 1.4625-.39131 3.0324-.84866 4.4687-1.47955 1.4334-.62958 2.8155-1.46629 3.844-2.66311.1542-.17947.2994-.3658.4349-.55915.1355.19335.2807.37968.4349.55915 1.0285 1.19682 2.4106 2.03353 3.844 2.66311 1.4363.63089 3.0062 1.08824 4.4687 1.47955.3857.10323.761.20118 1.1251.2962l.0003.00006c.7121.18588 1.3813.36053 2.002.54153V23.8179c0 3.7199-2.0648 7.1323-5.3599 8.8583L20 36.0889l-6.5151-3.4127c-3.2951-1.726-5.3599-5.1384-5.3599-8.8583Zm9.5441-20.75724C18.3344 2.28639 18.75 1.31808 18.75 0h2.5c0 1.31808.4156 2.28639 1.0809 3.06066.6904.80329 1.6991 1.4527 2.9534 2.00361 1.2512.54961 2.6657.96712 4.1095 1.35344.3439.09204.6927.18304 1.0415.27403l.0002.00005c1.0762.28078 2.1521.56146 3.0848.87236l.8547.2849V23.8179c0 4.6498-2.581 8.9154-6.6999 11.0729L20.58 38.6073l-.58.3038-.58-.3038-7.0951-3.7165C8.20596 32.7333 5.625 28.4677 5.625 23.8179V7.84905l.85472-.2849c.93267-.3109 2.00855-.59158 3.08478-.87236l.00019-.00005c.34877-.09099.69761-.18199 1.04151-.27403 1.4438-.38632 2.8583-.80383 4.1095-1.35344 1.2543-.55091 2.263-1.20032 2.9534-2.00361ZM21.25 12.5l-.3125 10h-1.875l-.3125-10h2.5Zm0 13.75c0 .6904-.5596 1.25-1.25 1.25s-1.25-.5596-1.25-1.25S19.3096 25 20 25s1.25.5596 1.25 1.25Z" clip-rule="evenodd"/>',{size:40,viewBox:"0 0 40 40"});var R=e.i(9782441);e.s(["BotProtectionStatusBadge",()=>E,"FirewallStatusBadge",()=>z,"MicrofrontendsFirewallBadge",()=>O],6944292);var I=e.i(5468328),B=e.i(3487134),_=e.i(6675233),T=e.i(8724159),A=e.i(3679047),F=e.i(9148191),M=e.i(421794);function z(e){let{className:a,config:s,project:i,rulesets:n}=e,{isChildMicrofrontend:o}=(0,F.useMicrofrontendsProjectInfo)();return(0,t.jsxs)("div",{className:(0,m.clsx)("flex-row items-center gap-2",a),children:[(0,t.jsx)(T.ShieldCheck,{color:"blue-700"}),(0,t.jsxs)("div",{className:"flex flex-row items-center divide-x",children:[(0,t.jsx)(l.Text,{className:"pr-2",variant:"label-13",weight:500,children:"Firewall is active"}),(0,t.jsx)("div",{className:(0,m.clsx)("pl-2",{"pr-2":o}),children:i?.security?.attackModeEnabled?(0,t.jsx)(r.Badge,{icon:(0,t.jsx)(c.Shield,{color:"blue-900"}),size:"sm",variant:"blue-subtle",children:"Challenge Mode active"}):n&&(0,M.botProtectionFromRulesets)(n)?(0,t.jsx)(E,{config:s,rulesets:n}):(0,t.jsx)(l.Text,{color:"gray-900",variant:"label-13",children:"All systems normal"})}),o?(0,t.jsx)("div",{className:"pl-2",children:(0,t.jsx)(O,{})}):null]})]})}function E(e){let{config:s,rulesets:i}=e,l=(0,A.useParams)(),n=(0,M.botProtectionFromConfig)(s?.currentConfig),o=(0,M.botProtectionFromRulesets)(i),c=n?.active??o?.active,d=n?.action??o?.defaultAction;return(0,t.jsx)(a.Link,{canPrefetch:()=>!0,isDifferentZone:!1,href:l?.teamSlug&&l?.project?`/${l.teamSlug}/${l.project}/firewall/configure#bot-management`:"#",children:c?"log"===d?(0,t.jsx)(r.Badge,{icon:(0,t.jsx)(_.Robot,{size:10}),size:"sm",variant:"gray-subtle",children:"Monitoring Bot Activity"}):(0,t.jsx)(r.Badge,{size:"sm",variant:"blue-subtle",icon:(0,t.jsx)(_.Robot,{size:10,color:"blue-900"}),children:"Bot Protection Enabled"}):(0,t.jsx)(r.Badge,{size:"sm",variant:"pill",className:"",icon:(0,t.jsx)(_.Robot,{size:10,color:"gray-900"}),children:"Enable Bot Protection"})})}function O(){let{defaultProjectBaseUrl:e,isChildMicrofrontend:s}=(0,F.useMicrofrontendsProjectInfo)();return s?(0,t.jsx)(a.Link,{href:`${e}/firewall`,icon:!1,children:(0,t.jsx)(I.Tooltip,{text:"Firewall rules for the default app are also run for this microfrontend.",children:(0,t.jsx)(r.Badge,{icon:(0,t.jsx)(B.Microfrontends,{}),size:"sm",variant:"blue-subtle",children:"View Parent Firewall"})})}):null}var $=e.i(594750),H=e.i(3774835),V=e.i(6060673),U=e.i(609109),q=e.i(1717203),Z=e.i(7557283),W=e.i(4723202);function Y(e){return new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:0,compactDisplay:"short"}).format(e)}function G(e){let{teamSlug:s,projectSlug:i}=e,{data:l,isLoading:o}=function(e){let t=(0,A.useParams)();return(0,V.useProject)(t?.project,{apiVersion:"v10",latestDeployments:10,activeBranches:!0,config:void 0,fetchParams:{rollbackInfo:!0}})}(),{deployment:d,isLoading:u}=(0,S.useProjectProductionDeployment)(i),{team:m}=(0,j.useTeam)(s),{data:y,isLoading:v}=(0,x.useIsomorphicSWR)(`${g.API_FIREWALL}/proxy/status${(0,h.encode)({teamId:s,projectId:i})}`),{data:N,isLoading:D,error:k,mutate:P}=(0,p.default)(m&&l?`/api/firewall/project-overview-summary${(0,h.encode)({ownerId:m.id,projectId:l.id})}`:null,e=>(0,f.fetchAPI)(e,{throwOnHTTPError:!0})),{data:L,isLoading:I}=(0,C.useAttackStatus)({teamId:s,projectId:i}),{activeConfig:B,isLoadingConfig:_}=(0,$.useFirewallConfig)({projectId:l?.id}),{data:T,isLoading:F}=(0,H.useManagedRulesets)({projectIdOrName:i,teamIdOrSlug:s}),M=L?.anomalies.find(e=>"active"===e.state&&!e.endTime),z=(l?.latestDeployments??[]).length>0,O=!!(y&&y.length>0),U=l?.security?.attackModeEnabled??!1,W=(0,w.globalBypassStatus)(l),Y=v&&!y||D&&!N||o&&!l||I&&!L||_&&!B||F&&!T||u&&!d,{can:G,isLoading:Q}=(0,q.default)();if(!G(Z.Action.Read,Z.Resource.SeawallConfig)&&!Q)return(0,t.jsx)(er,{});if(Y||Q)return(0,t.jsx)(ea,{});if(k)return(0,t.jsx)(es,{onRetry:()=>{P()},projectSlug:i,teamSlug:s});if(!d)return(0,t.jsx)(J,{hasDeployments:z,projectSlug:i,teamSlug:s});let et=null;return U?et=(0,t.jsx)(a.Link,{className:"z-[2] leading-none",external:!0,href:"/docs/attack-challenge-mode#attack-challenge-mode",icon:!1,children:(0,t.jsx)(r.Badge,{className:"border border-solid border-transparent transition hover:border-blue-400",icon:(0,t.jsx)(c.Shield,{size:12}),size:"sm",variant:"blue-subtle",children:"Challenge Mode active"})}):O?et=(0,t.jsx)(a.Link,{className:"z-[2] leading-none",external:!0,href:"/guides/can-i-use-a-proxy-on-top-of-my-vercel-deployment",icon:!1,children:(0,t.jsx)(r.Badge,{className:"border border-solid border-transparent transition hover:border-amber-400",icon:(0,t.jsx)(n.Warning,{size:12}),size:"sm",variant:"amber-subtle",children:"Reverse Proxy Detected"})}):T&&(et=(0,t.jsx)(E,{config:B,rulesets:T})),(0,t.jsxs)(R.ProjectDetailsCard,{children:[(0,t.jsx)(R.ProjectCardDetailsHeader,{duration:M?.startTime?`Past ${String((0,b.ago)(Date.now()-M.startTime,{suffix:" ",alwaysRelative:!0}))}`:"24h",href:`/${s}/${i}/firewall?range=1d`,title:"Firewall",children:et}),(0,t.jsx)(R.ProjectCardDetailsContent,{className:"flex items-center justify-center",children:M?(0,t.jsx)(K,{anomaly:M}):W.enabled?(0,t.jsx)(X,{ttl:W.ttl}):(0,t.jsx)(ee,{summary:N})})]})}let Q="flex flex-col gap-2 items-center justify-center relative mt-auto mb-9";function X(e){let{ttl:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(el,{className:"absolute left-1/2 top-0 -translate-x-1/2 translate-y-[16px]",variant:"error"}),(0,t.jsxs)("div",{className:Q,children:[(0,t.jsx)(l.Text,{color:"red-900",variant:"label-14",weight:500,children:"System Mitigations Disabled"}),(0,t.jsx)(l.Text,{variant:"label-14",weight:500,children:"You are susceptible to attacks"}),a?(0,t.jsxs)(l.Text,{variant:"label-14",children:["Until ",(0,U.formatDateAndTime)(1e3*a)]}):""]})]})}function K(e){let{anomaly:a}=e,r=(0,y.useQuerySelect)({action:"all",filter:"sys_dos_mitigation",groupBy:"wafAction",range:`${new Date().getTime()-a.startTime}ms`}),{data:s,isLoading:n}=(0,v.useSonarLiveQuery)({...r,summaryOnly:!0}),o=s?.summary.reduce((e,t)=>(e[t.wafAction]=t.value??0,e),{});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(el,{className:"absolute left-1/2 top-0 -translate-x-1/2 translate-y-[16px]",variant:"warning"}),(0,t.jsxs)("div",{className:Q,children:[(0,t.jsx)(l.Text,{color:"amber-900",variant:"label-14",weight:500,children:"DDoS attack is being mitigated"}),n?(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(i.Skeleton,{height:20,width:120}),(0,t.jsx)(i.Skeleton,{height:20,width:120})]}):(0,t.jsx)(et,{summary:o})]})]})}function J(e){let{teamSlug:a,projectSlug:r,hasDeployments:s}=e;return(0,t.jsxs)(R.ProjectDetailsCard,{children:[(0,t.jsx)(R.ProjectCardDetailsHeader,{href:`/${a}/${r}/firewall?range=1d`,title:"Firewall"}),(0,t.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,t.jsxs)("div",{className:"relative -top-5 flex items-center gap-2 text-gray-900",children:[(0,t.jsx)(o.FirewallFlame,{}),(0,t.jsx)(l.Text,{color:"gray-900",variant:"label-14",weight:500,children:s?"Firewall is active":"No live deployments"})]})})]})}function ee(e){let{summary:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(el,{className:"absolute left-1/2 top-0 -translate-x-1/2 translate-y-[16px]",variant:"success"}),(0,t.jsxs)("div",{className:Q,children:[(0,t.jsx)(l.Text,{color:"blue-900",variant:"label-14",weight:500,children:"Firewall is active"}),a&&0===a.deny&&0===a.challenge?(0,t.jsx)(l.Text,{children:"All systems are normal"}):(0,t.jsx)(et,{summary:a})]})]})}function et(e){let{summary:a}=e;return(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-x-4 gap-y-2",children:[a?.deny&&a.deny>0?(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.ShieldOff,{color:"gray-900"}),(0,t.jsxs)(l.Text,{weight:500,children:[Y(a.deny)," denied"]})]}):null,a?.challenge&&a.challenge>0?(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.Shield,{color:"gray-900"}),(0,t.jsxs)(l.Text,{weight:500,children:[Y(a.challenge)," challenged"]})]}):null]})}function ea(){return(0,t.jsxs)(R.ProjectDetailsCard,{children:[(0,t.jsx)(R.ProjectCardDetailsHeader,{duration:"24h",title:"Firewall",children:(0,t.jsx)(i.Skeleton,{height:24,width:160})}),(0,t.jsxs)("div",{className:"relative h-[188px] pt-[115px]",children:[(0,t.jsx)(el,{className:"absolute left-1/2 top-0 -translate-x-1/2 translate-y-[16px]",variant:"disabled"}),(0,t.jsxs)("div",{className:Q,children:[(0,t.jsx)(i.Skeleton,{height:20,width:150}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(i.Skeleton,{height:20,width:120}),(0,t.jsx)(i.Skeleton,{height:20,width:120})]})]})]})]})}function er(){return(0,t.jsxs)(R.ProjectDetailsCard,{children:[(0,t.jsx)(R.ProjectCardDetailsHeader,{title:"Firewall"}),(0,t.jsx)(R.ProjectCardDetailsContent,{children:(0,t.jsx)(R.ProjectCardDetailsEmptyState,{icon:(0,t.jsx)(u.LockClosed,{}),subtitle:"You don't have access to firewall",cta:(0,t.jsx)(W.RequestRoleButton,{teamRole:"MEMBER"})})})]})}function es(e){let{teamSlug:a,projectSlug:r,onRetry:i}=e;return(0,t.jsxs)(R.ProjectDetailsCard,{children:[(0,t.jsx)(R.ProjectCardDetailsHeader,{duration:"24h",href:`/${a}/${r}/firewall?range=1d`,title:"Firewall"}),(0,t.jsx)(R.ProjectCardDetailsContent,{children:(0,t.jsx)(R.ProjectCardDetailsEmptyState,{cta:(0,t.jsx)(s.Button,{className:"text-label-14 font-medium",onClick:i,size:"small",type:"tertiary",children:"Retry"}),icon:(0,t.jsx)(c.Shield,{}),subtitle:"We couldn't load the firewall data"})})]})}let ei={success:k,warning:L,error:P,disabled:D};function el(e){let{className:a,variant:r="success"}=e,s=ei[r];return(0,t.jsx)("div",{className:(0,m.clsx)(a,"p-[10px]",{"text-blue-700 [--status-badge-circle-color:var(--ds-blue-300)] [--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(255,255,255,0.37)_49.5%,rgba(240,247,255,0.37)_100%)] dark:[--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(10,10,10,0.37)_49.5%,rgba(15,27,45,0.37)_100%)]":"success"===r,"text-amber-700 [--status-badge-circle-color:var(--ds-amber-200)] [--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(255,255,255,0.37)_49.5%,rgba(255,244,213,0.37)_100%)] dark:[--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(10,10,10,0.37)_49.5%,rgba(52,28,0,0.37)_100%)]":"warning"===r,"text-red-700 [--status-badge-circle-color:var(--ds-red-300)] [--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(255,255,255,0.22)_49.5%,rgba(255,240,240,0.22)_100%)] dark:[--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(10,10,10,0.22)_49.5%,rgba(42,19,20,0.22)_100%)]":"error"===r,"text-gray-700 [--status-badge-circle-color:var(--ds-gray-300)] [--status-badge-background-gradient:radial-gradient(50%_50%_at_50%_50%,rgba(255,255,255,0.37)_49.5%,rgba(240,247,255,0.37)_100%)] dark:[--status-badge-background-gradient:none]":"disabled"===r}),children:(0,t.jsxs)("div",{className:"relative isolate flex items-center justify-center",children:[(0,t.jsx)(en,{className:"p-[182px] opacity-50"}),(0,t.jsx)(en,{className:"p-[115px] opacity-50"}),(0,t.jsx)(en,{className:"p-[50px]"}),(0,t.jsx)(s,{className:"z-10",size:40})]})})}function en(e){let{className:a}=e;return(0,t.jsx)("div",{className:(0,m.clsx)(a,"absolute block size-0 rounded-full border border-solid text-[var(--status-badge-circle-color)] [background:var(--status-badge-background-gradient)]")})}},4040097,e=>{"use strict";e.s(["ProductionDeploymentCardSkeleton",()=>u]);var t=e.i(751170),a=e.i(7137884),r=e.i(8517043),s=e.i(5255926),i=e.i(9318197),l=e.i(9508212),n=e.i(1344973),o=e.i(9722978),c=e.i(4450569),d=e.i(5566974);function u(e){let{visible:u=!0}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(r.Fieldset,{className:(0,o.clsx)("z-[1]","shadow-[0_1px_0_rgba(0,0,0,0.08),0_2px_2px_rgba(0,0,0,0.04)]","border-none","rounded-lg","bg-clip-padding","[&>div:first-child]:p-4",!u&&"invisible"),children:[(0,t.jsx)(a.FieldsetContent,{children:(0,t.jsxs)(c.default,{direction:["column","row"],children:[(0,t.jsx)(c.default,{className:"w-screen max-w-[38%] flex-none max-[860px]:max-w-full",children:(0,t.jsx)(s.Skeleton,{style:{paddingTop:"62.5%",minHeight:"100%"},width:"100%"})}),(0,t.jsx)(c.default,{className:"justify-start pt-2 max-[860px]:ml-0 max-[860px]:pl-1 max-[860px]:mt-[calc(var(--geist-gap)*var(--gap-ratio))]",children:(0,t.jsxs)(l.Stack,{gap:5.5,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)(l.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",lineHeight:14,children:"Deployment"}),(0,t.jsx)(s.Skeleton,{height:16,width:190})]}),(0,t.jsx)(l.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(s.Skeleton,{boxHeight:32,height:32,rounded:!0,width:32,className:"mr-2"})})]}),(0,t.jsxs)(l.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",lineHeight:14,children:"Domains"}),(0,t.jsx)(s.Skeleton,{boxHeight:20,height:16,width:220})]}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)(l.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",lineHeight:14,children:"Status"}),(0,t.jsx)(s.Skeleton,{boxHeight:22,height:16,width:60})]}),(0,t.jsx)(i.Spacer,{x:1,y:.75}),(0,t.jsxs)(l.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",lineHeight:14,children:"Created"}),(0,t.jsx)(s.Skeleton,{boxHeight:22,height:16,width:180})]})]}),(0,t.jsxs)(l.Stack,{gap:2,children:[(0,t.jsx)(n.Text,{color:"gray-900",lineHeight:14,children:"Source"}),(0,t.jsxs)(l.Stack,{gap:.5,children:[(0,t.jsx)(s.Skeleton,{boxHeight:22,height:16,width:120}),(0,t.jsx)(s.Skeleton,{boxHeight:22,height:16,width:240})]})]})]})})]})}),(0,t.jsx)(d.DeploymentConfigurationSkeleton,{className:"rounded-b"})]})})}},1298796,e=>{"use strict";e.s(["DeploymentCardContainer",()=>l,"DeploymentCardStatusBar",()=>n,"DeploymentCardStatusBarLeft",()=>o,"DeploymentCardStatusBarRight",()=>c,"getStatusBarVariant",()=>i]);var t=e.i(751170),a=e.i(9722978),r=e.i(7137884),s=e.i(8517043);function i(e){let{productionDeploymentIsStale:t,upcomingDeployment:a,isLoading:r}=e;return r?"default":t?"warning":a?.aliasError?"error":"default"}function l(e){let{children:r,variant:s="default"}=e;return(0,t.jsx)("div",{className:(0,a.clsx)("material-base isolate !rounded-md border-x-0 border-b border-t-0","after:absolute after:-inset-px after:bottom-0 after:z-[-2] after:block after:rounded-md after:bg-gradient-to-b after:from-gray-300 after:from-40% after:to-90% after:content-['']","before:absolute before:inset-0 before:bottom-px before:z-[-1] before:block before:rounded-md before:content-['']",{"before:bg-background-100 after:to-gray-200":"light"===s,"before:bg-background-200 after:to-gray-300":"default"===s,"before:bg-red-300 after:to-red-400":"error"===s,"before:bg-amber-300 after:to-amber-400":"warning"===s}),children:r})}function n(e){let{variant:i="default",children:l,...n}=e;return(0,t.jsxs)(s.Fieldset,{className:(0,a.clsx)("relative w-full rounded-b-[7px] rounded-t-none shadow-none",{"bg-background-100":"light"===i,"bg-background-200":"default"===i,"bg-red-300 text-red-900":"error"===i,"bg-amber-200 text-amber-900":"warning"===i}),...n,children:["default"!==i&&"light"!==i?(0,t.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"error"===i?"repeating-linear-gradient(-45deg, transparent, transparent 16px, var(--ds-red-400) 16px, var(--ds-red-400) 32px)":"repeating-linear-gradient(-45deg, transparent, transparent 16px, var(--ds-amber-400) 16px, var(--ds-amber-400) 32px)",maskImage:"linear-gradient(to left, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0) 30%)"}}):null,(0,t.jsx)(r.FieldsetContent,{className:"flex w-full items-center justify-between bg-transparent px-4 py-3 md:py-0 md:pl-4 md:pr-2",children:(0,t.jsx)("div",{className:"space-between text-copy-14 flex w-full flex-col items-start gap-x-2 gap-y-4 md:h-12 md:flex-row md:items-center",children:l})})]})}function o(e){let{children:r,className:s}=e;return(0,t.jsx)("div",{className:(0,a.clsx)("flex min-h-[44px] w-full items-center lg:min-h-full",s),children:r})}function c(e){let{children:a}=e;return(0,t.jsx)("div",{className:"w-full shrink-0 md:ml-auto md:w-auto md:text-right",children:a})}},5143983,e=>{"use strict";e.s(["ProductionDeploymentBar",()=>S]);var t=e.i(751170),a=e.i(4099374),r=e.i(1286423),s=e.i(2504781),i=e.i(5255926),l=e.i(5468328),n=e.i(4161083),o=e.i(4756166),c=e.i(9584456),d=e.i(9386557),u=e.i(57106),m=e.i(4004502),x=e.i(7917902),g=e.i(1717203),h=e.i(7557283),j=e.i(7218483),p=e.i(9668517),f=e.i(9375869),b=e.i(6159310),y=e.i(2982888),v=e.i(1298796),w=e.i(1553329),C=e.i(8216525);function S(e){let{loading:a=!0,project:r,upcomingDeployment:s,onCancelUpcomingDeployment:l,previousDeployment:n,aliasError:o,projectLink:d,productionDeployment:u,productionDeploymentIsStale:x}=e;return(0,t.jsx)(v.DeploymentCardStatusBar,{"data-testid":(0,m.tid)("production-deployment-bar","container",a?"loading":""),variant:(0,v.getStatusBarVariant)({productionDeploymentIsStale:x,upcomingDeployment:s,isLoading:a}),children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentCardStatusBarLeft,{children:(0,t.jsx)(i.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:"40%"})}),(0,t.jsx)(v.DeploymentCardStatusBarRight,{children:(0,t.jsx)("div",{className:"flex h-auto items-center overflow-visible md:h-[20px]",children:(0,t.jsx)(i.Skeleton,{autoSize:!0,className:"h-[32px] w-full md:w-[32px]"})})})]}):o?(0,t.jsxs)(v.DeploymentCardStatusBarLeft,{children:[(0,t.jsx)(c.StopFill,{color:"red-900"}),"Failed to Assign Domain: ",o.message]}):x?(0,t.jsx)(N,{previousDeployment:n,productionDeployment:u,project:r}):s?(0,t.jsx)(k,{onCancelUpcomingDeployment:l,upcomingDeployment:s,project:r}):(0,t.jsx)(D,{project:r,projectLink:d})})}function N(e){let{project:i,productionDeployment:l,previousDeployment:n}=e,o=(0,p.useTeamSlug)(),c=i?.autoAssignCustomDomains??!0,m=i?.autoAssignCustomDomainsUpdatedBy==="system",x=`/${o??""}/${i?.name||""}/settings/environments/production`,[g,h]=(0,a.useState)(!1),j=(0,a.useCallback)(()=>c?(0,t.jsxs)("span",{className:"text-label-14",children:["Pushing a new deployment to production will remove the rollback."," ",(0,t.jsx)(u.Link,{className:"font-medium underline",external:!0,href:"https://vercel.com/docs/deployments/instant-rollback",children:"Learn More"})]}):m?(0,t.jsxs)("span",{className:"text-label-14",children:["To undo the rollback"," ",(0,t.jsx)(u.Link,{className:"font-medium underline",external:!0,href:"https://vercel.com/docs/deployments/promoting-a-deployment#promote-a-deployment-from-preview-to-production",children:"promote to production"})," ","or"," ",(0,t.jsx)(u.Link,{className:"font-medium underline",external:!0,href:x,children:"re-enable auto-assigning custom domains"})]}):(0,t.jsxs)("span",{className:"text-label-14",children:["Auto-assigning production domains is disabled for this project. To undo the rollback"," ",(0,t.jsx)(u.Link,{className:"font-medium underline",external:!0,href:"https://vercel.com/docs/deployments/promoting-a-deployment#promote-a-deployment-from-preview-to-production",children:"promote to production"})]}),[c,m,x,g]),f=new URLSearchParams;return f.set("environment","production"),f.set("status","ready,error,canceled"),n&&l&&f.set("range",JSON.stringify({start:new Date(l.createdAt).toISOString(),end:(0,r.addSeconds)(new Date(n.createdAt),1).toISOString()})),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentCardStatusBarLeft,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.WarningFill,{color:"amber-900"}),(0,t.jsx)(j,{})]})}),(0,t.jsx)(v.DeploymentCardStatusBarRight,{children:(0,t.jsx)("div",{className:"flex h-auto items-center overflow-visible md:h-[20px]",children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.UndoRollbackModal,{open:g,setOpen:h}),(0,t.jsx)(s.Button,{className:"w-full",onClick:()=>{h(e=>!e)},size:"small",type:"secondary",children:"Undo Rollback"})]})})})]})}function D(e){let{project:a,projectLink:r}=e,s=(0,x.useAccount)(),i=s.team?.slug||s.user?.username,l=i&&a?`/${i}/${a.name}/settings/git`:void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentCardStatusBarLeft,{children:r?(0,t.jsxs)("span",{className:"text-gray-900",children:["To update your Production Deployment, push to the"," ",a?.link?.productionBranch?(0,t.jsx)("span",{className:"font-mono",children:a.link.productionBranch}):"Repository Default"," ","branch."]}):(0,t.jsxs)("span",{className:"text-gray-900",children:["To deploy to Production, connect to git, or run"," ",(0,t.jsx)("span",{className:"font-mono",children:"vercel --prod"})," via the CLI."]})}),(0,t.jsxs)(v.DeploymentCardStatusBarRight,{children:[(0,t.jsxs)("div",{className:"flex w-full items-center gap-3 md:hidden",children:[(0,t.jsx)(b.DashboardButtonLink,{className:"w-full shrink",prefix:(0,t.jsx)(o.ListFilter,{color:"gray-900"}),route:"/[teamSlug]/[project]/deployments",search:{environment:"production"},size:"small",type:"secondary",children:"Deployments"}),(0,t.jsx)(u.ButtonLink,{as:l,className:"w-full shrink",href:"/docs/git#production-branch",prefix:(0,t.jsx)(n.BookOpen,{color:"gray-900"}),size:"small",tab:!0,type:"secondary",children:"Learn More"})]}),(0,t.jsxs)("div",{className:"hidden h-[20px] shrink-0 items-center gap-2 overflow-visible md:flex",children:[(0,t.jsx)(b.DashboardButtonLink,{prefix:(0,t.jsx)(o.ListFilter,{color:"gray-900"}),route:"/[teamSlug]/[project]/deployments",search:{environment:"production"},size:"small",type:"secondary",children:"Deployments"}),(0,t.jsx)(u.ButtonLink,{"aria-label":"Learn more",as:l,href:"/docs/git#production-branch",shape:"square",size:"small",svgOnly:!0,tab:!0,type:"secondary",children:(0,t.jsx)(n.BookOpen,{color:"gray-900"})})]})]})]})}function k(e){let{upcomingDeployment:a,onCancelUpcomingDeployment:r,project:i}=e,{user:n,team:o}=(0,x.useAccount)(),c=(0,j.useAgo)(a.createdAt),{can:d,isLoading:u}=(0,g.default)({projectIdOrName:i?.name}),m=null!==a.target?h.Resource.DeploymentFromProductionBranch:h.Resource.DeploymentPreview,p=d(h.Action.Update,m),f=!u&&p&&("QUEUED"===a.readyState||"BUILDING"===a.readyState);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentCardStatusBarLeft,{className:"md:truncate",children:(0,t.jsx)("div",{className:"text-label-14 flex min-w-0 flex-1 items-center gap-2",children:(0,t.jsxs)("div",{className:"flex min-w-0 flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex min-w-0 items-center gap-2",children:[(0,t.jsx)(C.DeploymentStatus,{deployment:a,label:!0,labelClassName:"[&>*]:font-normal"}),(0,t.jsx)("span",{children:"Â·"}),(0,t.jsx)(P,{deployment:a,team:o,user:n})]}),(0,t.jsx)("div",{className:"flex md:hidden",children:(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:[(0,t.jsx)("span",{className:"text-gray-900",children:c}),(0,t.jsx)(y.DeploymentCreatorAvatar,{deployment:a,showIcon:!1,size:20}),(0,t.jsx)("span",{className:"text-gray-1000",children:(0,y.getDeploymentCreatorUsername)({deployment:a})})]})})]})})}),(0,t.jsx)(v.DeploymentCardStatusBarRight,{children:(0,t.jsxs)("div",{className:"text-label-14 flex flex-1 shrink-0 items-center gap-2",children:[(0,t.jsxs)("div",{className:"hidden items-center gap-1 md:flex",children:[(0,t.jsx)("span",{className:"text-gray-900",children:c}),(0,t.jsx)(y.DeploymentCreatorAvatar,{deployment:a,showIcon:!1,size:20}),(0,t.jsx)("span",{className:"text-gray-1000",children:(0,y.getDeploymentCreatorUsername)({deployment:a})})]}),(0,t.jsx)("div",{className:"flex h-auto w-full items-center overflow-visible md:h-[20px] md:w-auto",children:(0,t.jsx)(l.Tooltip,{className:"w-full md:w-auto",desktopOnly:!0,forceHide:f,text:"Missing permissions to cancel",children:(0,t.jsx)(s.Button,{className:"w-full md:w-auto",disabled:!f,onClick:r,size:"small",type:"secondary",children:"Cancel"})})})]})})]})}function P(e){let{deployment:r,user:s,team:i}=e,l=(0,f.pathFromDeployment)(r,{user:s,team:i}),n=(0,a.useMemo)(()=>{let{meta:e,source:t}=r;return e.githubDeployment&&e.githubCommitMessage?e.githubCommitMessage:e.bitbucketDeployment&&e.bitbucketCommitMessage?e.bitbucketCommitMessage:e.gitlabDeployment&&(e.gitlabCommitMessage||e.gitCommitMessage)?e.gitlabCommitMessage||e.gitCommitMessage:"cli"===t?"New Deployment created with Vercel CLI":t?null:"New Deployment created"},[r]);return(0,t.jsx)(u.Link,{className:"text-label-14 truncate",href:l,variant:"secondary",children:n})}},1391409,e=>{"use strict";e.s(["ProjectAnalyticsCard",()=>D,"ProjectAnalyticsCardNoAccess",()=>R,"ProjectAnalyticsCardSkeleton",()=>L]);var t=e.i(751170),a=e.i(1344973),r=e.i(5499338),s=e.i(5255926),i=e.i(2504781),l=e.i(2640326),n=e.i(5756088),o=e.i(1604149),c=e.i(818351),d=e.i(57106),u=e.i(8042625),m=e.i(8119470),x=e.i(4826595),g=e.i(7946377),h=e.i(9028632),j=e.i(4394132),p=e.i(8402901),f=e.i(2979333),b=e.i(8633387),y=e.i(85322),v=e.i(4550318),w=e.i(9782441),C=e.i(4723202);let S={good:"green-subtle",bad:"red-subtle",neutral:"gray-subtle","no-data":"gray-subtle"},N={ssr:{timeout:3e3}};function D(e){let{teamSlug:a,projectSlug:r}=e,{data:s,isLoading:i}=(0,b.useDashboardProject)({teamSlug:a,projectSlug:r});return i||!s?(0,t.jsx)(L,{}):(0,y.isFeatureEnabled)(s.webAnalytics)?(0,t.jsx)(P,{project:s,teamSlug:a}):(0,t.jsx)(k,{project:s,teamSlug:a})}function k(e){let{project:a,teamSlug:r}=e,s=(0,p.useCanToggleWebAnalytics)();return(0,t.jsxs)(w.ProjectDetailsCard,{children:[(0,t.jsx)(w.ProjectCardDetailsHeader,{href:`/${r}/${a.name}/analytics`,title:"Analytics"}),(0,t.jsx)(w.ProjectCardDetailsContent,{children:(0,t.jsx)(w.ProjectCardDetailsEmptyState,{cta:(0,t.jsx)(d.ButtonLink,{className:"text-label-14 font-medium",disabled:!s,href:`/${r}/${a.name}/analytics?enable=1&source=project-overview-analytics-card`,size:"small",type:"tertiary",children:"Enable"}),icon:(0,t.jsx)(l.Analytics,{}),subtitle:"Track visitors and page views"})})]})}function P(e){let{teamSlug:s,project:i}=e,l=(0,x.getRangeFromPeriod)("7d"),{data:n,isLoading:d,error:p,mutate:b}=(0,c.useIsomorphicSWR)(`/api/web-analytics/overview${(0,u.encode)({from:l.from.toISOString(),to:l.to.toISOString(),teamId:s,projectId:i.name})}`,N),{data:y}=(0,c.useIsomorphicSWR)(`/api/web-analytics/overview${(0,u.encode)({from:(0,m.subDays)(l.from,7).toISOString(),to:(0,m.subDays)(l.to,7).toISOString(),teamId:s,projectId:i.name})}`,N),{data:C,isLoading:D}=(0,c.useIsomorphicSWR)(`/api/web-analytics/timeseries${(0,u.encode)({from:l.from.toISOString(),to:l.to.toISOString(),teamId:s,projectId:i.name,tz:(0,g.getClientTimezone)()})}`,N),{data:k,isLoading:P}=(0,c.useIsomorphicSWR)(`/api/web-analytics/realtime${(0,u.encode)({teamId:s,projectId:i.name})}`,{...N,refreshInterval:1e4});if(d&&!n||D&&!C)return(0,t.jsx)(L,{});if(p)return(0,t.jsx)(I,{onRetry:()=>{b()},projectSlug:i.name,teamSlug:s});let R=n?.devices??0,B=(0,f.getPercentageTrend)(y?.devices??0,R),_=!!i.webAnalytics?.hasData;return(0,t.jsxs)(w.ProjectDetailsCard,{className:"relative after:pointer-events-none after:absolute after:inset-0 after:rounded-md after:border after:border-solid after:border-[#fff]/15 after:content-[''] dark:after:hidden",children:[(0,t.jsx)(w.ProjectCardDetailsHeader,{duration:"1w",href:`/${s}/${i.name}/analytics`,title:"Analytics"}),(0,t.jsxs)(w.ProjectCardDetailsContent,{children:[(0,t.jsxs)("div",{className:"flex min-h-[44px] flex-col justify-between gap-1 px-4",children:[(0,t.jsxs)("div",{className:"flex h-[20px] items-center gap-2.5 overflow-visible",children:[_?(0,t.jsxs)(a.Text,{variant:"label-14",weight:500,children:[new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1,compactDisplay:"short"}).format(R)," Visitors"]}):(0,t.jsx)(a.Text,{color:"gray-900",variant:"label-14",children:"No data"}),"no-data"!==B.type?(0,t.jsxs)(r.Badge,{variant:S[B.type],children:[B.value,B.unit]}):null]}),(0,t.jsx)(v.VisitorCount,{count:k?.devices??0,loading:P})]}),(0,t.jsx)("div",{className:"mt-2.5 h-[138px] w-full",children:(0,t.jsx)(o.ParentSize,{children:e=>{let{width:a,height:r}=e;return(0,t.jsx)(h.Graph,{data:C?.data??[],height:r,margin:{top:0,left:0,right:0,bottom:0},range:l,type:j.AnalyticsType.Visitors,variant:"minimal",width:a})}})})]})]})}function L(){return(0,t.jsxs)(w.ProjectDetailsCard,{children:[(0,t.jsx)(w.ProjectCardDetailsHeader,{duration:"1w",title:"Analytics"}),(0,t.jsx)(w.ProjectCardDetailsContent,{children:(0,t.jsxs)("div",{className:"flex flex-col justify-between gap-1 px-4",children:[(0,t.jsxs)("div",{className:"flex gap-2.5",children:[(0,t.jsx)(s.Skeleton,{height:20,width:100}),(0,t.jsx)(s.Skeleton,{height:20})]}),(0,t.jsx)(s.Skeleton,{height:20,width:100})]})})]})}function R(){return(0,t.jsxs)(w.ProjectDetailsCard,{children:[(0,t.jsx)(w.ProjectCardDetailsHeader,{title:"Analytics"}),(0,t.jsx)(w.ProjectCardDetailsContent,{children:(0,t.jsx)(w.ProjectCardDetailsEmptyState,{icon:(0,t.jsx)(n.LockClosed,{}),subtitle:"You don't have access to analytics",cta:(0,t.jsx)(C.RequestRoleButton,{teamRole:"MEMBER"})})})]})}function I(e){let{teamSlug:a,projectSlug:r,onRetry:s}=e;return(0,t.jsxs)(w.ProjectDetailsCard,{children:[(0,t.jsx)(w.ProjectCardDetailsHeader,{duration:"1w",href:`/${a}/${r}/analytics`,title:"Analytics"}),(0,t.jsx)(w.ProjectCardDetailsContent,{children:(0,t.jsx)(w.ProjectCardDetailsEmptyState,{cta:(0,t.jsx)(i.Button,{className:"text-label-14 font-medium",onClick:s,size:"small",type:"tertiary",children:"Retry"}),icon:(0,t.jsx)(l.Analytics,{}),subtitle:"We couldn't load analytics data"})})]})}},3645729,e=>{"use strict";e.s(["ProjectObservabilityCard",()=>g,"ProjectObservabilityCardNoAccess",()=>p,"ProjectObservabilityCardSkeleton",()=>j]);var t=e.i(751170),a=e.i(4099374),r=e.i(5255926),s=e.i(1192207),i=e.i(5756088),l=e.i(7946377),n=e.i(9782441),o=e.i(5481907),c=e.i(5182595),d=e.i(8443460),u=e.i(3888017),m=e.i(3851902),x=e.i(4723202);function g(e){let{teamSlug:r,projectSlug:i}=e,x=(0,a.useRef)((0,s.subHours)(new Date,6)),g=(0,a.useRef)(new Date),j=x.current,p=g.current,{data:f,isLoading:b}=(0,o.useSonarQuery)({event:"incomingRequest",granularity:{minutes:15},rollups:{count:{measure:"count",aggregation:"sum"}},startTime:j,endTime:p},{disableRefetch:!0}),{data:y,isLoading:v,isRelativeTime:w}=(0,o.useSonarQuery)({event:"serverlessFunctionInvocation",granularity:{minutes:15},rollups:{total:{measure:"count",aggregation:"sum"},errors:{measure:"count",aggregation:"sum",filter:d.SERVERLESS_DEFAULT_ERROR_FILTER},timeouts:{measure:"count",aggregation:"sum",filter:d.SERVERLESS_TIMEOUT_FILTER}},limit:500,tailRollup:"truncate",summaryOnly:!1,startTime:j,endTime:p},{disableRefetch:!0}),C=f?.data?.map(e=>({name:e.timestamp.toISOString(),Requests:e.count}))??[],S=(0,a.useMemo)(()=>y?.data?y.data.map(e=>{let{timestamp:t,errors:a,timeouts:r,total:s}=e;return{name:t.toISOString(),Error:0===s?null:(0,u.calculatePercentage)(a,s),Timeout:0===s?null:(0,u.calculatePercentage)(r,s)}}):[],[y?.data]),N=Math.max(...S.flatMap(e=>[e.Error||0,e.Timeout||0])),D=Math.max(...C.map(e=>e.Requests)),k=(0,a.useMemo)(()=>y?.data?y.data.map(e=>{let{timestamp:t,total:a}=e;return{name:t.toISOString(),Invocations:a}}):[],[y?.data]);return(0,t.jsxs)(n.ProjectDetailsCard,{allowOverflow:!0,children:[(0,t.jsx)(n.ProjectCardDetailsHeader,{duration:"6h",href:`/${r}/${i}/observability?period=6h`,title:"Observability"}),(0,t.jsx)(n.ProjectCardDetailsContent,{className:"px-4 pt-0",children:(0,t.jsxs)("div",{className:"grid grid-cols-[auto_1fr] gap-4",children:[(0,t.jsx)(h,{isLoading:b,title:"Edge Requests",value:(0,l.formatNumberCompact)(f?.summary[0]?.count??0)}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full",children:(0,t.jsx)(c.LineChart,{data:C,isLoading:b,isRelativeTime:w,emptyState:"",hideXAxis:!0,hideYAxis:!0,disableLegend:!0,disableZoom:!0,hideGrid:!0,syncId:"edge-requests",getColor:()=>"var(--geist-success)"})}),(0,t.jsx)(h,{isLoading:v,title:"Function Invocations",value:(0,l.formatNumberCompact)(y?.summary[0]?.total??0)}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full",children:(0,t.jsx)(c.LineChart,{data:k,disableLegend:!0,disableZoom:!0,isLoading:v,isRelativeTime:w,syncId:"function-invocations",emptyState:"",hideXAxis:!0,hideYAxis:!0,hideGrid:!0,getColor:()=>"var(--geist-success)",...D>0?{yAxisDomain:[0,D]}:{}})}),(0,t.jsx)(h,{isLoading:v,title:"Error Rate",value:(0,m.formatPercentage)(y?.summary[0]?.errors??0,y?.summary[0]?.total??0)}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full",children:(0,t.jsx)(c.LineChart,{data:S,disableLegend:!0,disableZoom:!0,emptyState:"",isLoading:v,isRelativeTime:w,getColor:e=>"Error"===e?"var(--geist-error)":"Timeout"===e?"var(--geist-warning)":"var(--geist-success)",syncId:"error-rate",hideXAxis:!0,hideTooltip:0===S.length,hideYAxis:!0,formatValue:u.formatPercentageChart,hideGrid:!0,yAxisDomain:[0,Math.max(5,N)]})})]})})]})}function h(e){let{title:a,value:s,isLoading:i}=e;return(0,t.jsxs)("div",{className:"self-center",children:[(0,t.jsx)("div",{className:"whitespace-nowrap text-gray-800",children:a}),(0,t.jsx)("div",{className:"font-gray-1000 font-medium",children:i?(0,t.jsx)(r.Skeleton,{}):s})]})}function j(){return(0,t.jsxs)(n.ProjectDetailsCard,{allowOverflow:!0,children:[(0,t.jsx)(n.ProjectCardDetailsHeader,{duration:"6h",href:"#",title:"Observability"}),(0,t.jsx)(n.ProjectCardDetailsContent,{className:"px-4 pt-0",children:(0,t.jsxs)("div",{className:"tailwind grid grid-cols-[auto_1fr] gap-4",children:[(0,t.jsx)(h,{isLoading:!0,title:"Edge Requests",value:""}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full border-b border-gray-200"}),(0,t.jsx)(h,{isLoading:!0,title:"Function Invocations",value:""}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full border-b border-gray-200"}),(0,t.jsx)(h,{isLoading:!0,title:"Error Rate",value:""}),(0,t.jsx)("div",{className:"mt-2.5 h-[35px] w-full border-b border-gray-200"})]})})]})}function p(){return(0,t.jsxs)(n.ProjectDetailsCard,{children:[(0,t.jsx)(n.ProjectCardDetailsHeader,{title:"Observability"}),(0,t.jsx)(n.ProjectCardDetailsContent,{children:(0,t.jsx)(n.ProjectCardDetailsEmptyState,{icon:(0,t.jsx)(i.LockClosed,{}),subtitle:"You don't have access to observability",cta:(0,t.jsx)(x.RequestRoleButton,{teamRole:"MEMBER"})})})]})}}]);

//# sourceMappingURL=9a2f3dd9b5fde5e9.js.map
//# debugId=e4432b8c-5beb-535b-a27d-dd4daaf7dae7
