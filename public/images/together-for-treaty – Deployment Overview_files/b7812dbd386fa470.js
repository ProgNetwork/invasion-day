
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="95327c4b-6403-59c8-9f71-81ee38db76dd")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4252765,e=>{e.v({container:"styled-combobox-module__ucBlrG__container"})},4942679,e=>{"use strict";e.s(["FirewallOverview",()=>ty],4942679);var t=e.i(751170),l=e.i(4099374),i=e.i(2504781),a=e.i(9508212),s=e.i(5255926),r=e.i(4991687),n=e.i(8674454),o=e.i(6694387),c=e.i(8459493),u=e.i(5257834),d=e.i(1344973),m=e.i(5499338),x=e.i(5232300),f=e.i(5326905),h=e.i(940143),g=e.i(57106),p=e.i(2375916),j=e.i(3814652),b=e.i(6198010),v=e.i(7749365),y=e.i(137239),w=e.i(8876434),C=e.i(1991452),k=e.i(972022),S=e.i(9943777),N=e.i(1717203),_=e.i(7557283),A=e.i(7151748),R=e.i(3870297),M=e.i(7917902),B=e.i(4597921),T=e.i(6060673),L=e.i(9367781),P=e.i(6319736),I=e.i(5481907),F=e.i(594750),$=e.i(9465698),D=e.i(8778858),O=e.i(8122440),z=e.i(1283928),U=e.i(588428),E=e.i(7432042),q=e.i(409142);e.i(1667062),e.i(1233856);var H=e.i(9507427);let G=[{value:"group_by_category",label:"Group by Category"},{value:"group_by_action",label:"Group by Action"}],V=[{label:"User Agent",value:"clientUserAgent"},{label:"Country",value:"clientIpCountry"},{label:"IP Address",value:"clientIp"},{label:"Request Path",value:"requestPath"},{label:"Route",value:"route"},{label:"JA4 Digest",value:"clientJa4Digest"},{label:"Host",value:"requestHostname"}],W=[{value:"botCheckResult",label:"Check Result"},...V],Z=[{icon:v.Clock,label:"Live",value:"live"},{label:"Past Hour",value:"1h"},{label:"Past Day",value:"1d"},{label:"Past 3 Days",value:"3d"}];function Q(e){let{isReady:t,value:i}=(0,U.useIPBlockingTeamFlag)(),{set:a,state:s}=(0,q.useSearchParamsState)({action:{defaultValue:"all"},filter:{defaultValue:"all_rules"},groupBy:{defaultValue:G[0].value,parseFromUrl:e=>(0,z.tryNormalizeDimension)(e)||e},range:{defaultValue:"1h"}});"BotID"===s.filter?s={...s,groupBy:s.groupBy===G[0].value?W[0].value:s.groupBy}:"botCheckResult"===s.groupBy&&"BotID"!==s.filter&&(s={...s,groupBy:V[0].value});let r=(0,l.useCallback)(l=>{let r=e?.hideIpAddresses||!i||!t;if("filter"===l.type){if("all_rules"===s.filter&&"all_rules"!==l.value){let e=(0,H.isLimitedSystemRule)(l.value)?H.systemFilter:H.defaultFilter;r&&(e=e.filter(e=>"clientIp"!==e.value)),a({filter:l.value,groupBy:e[0].value});return}if("all_rules"!==s.filter&&"all_rules"===l.value)return void a({filter:l.value,groupBy:G[0].value});if(!(0,H.isLimitedSystemRule)(s.filter)&&(0,H.isLimitedSystemRule)(l.value)){let e=r?H.systemFilter.filter(e=>"clientIp"!==e.value):H.systemFilter;a({filter:l.value,groupBy:e[0].value});return}a({filter:l.value})}else a({[l.type]:l.value})},[a,s,e,i,t]),n=(0,l.useMemo)(()=>{let l=e?.hideIpAddresses||!i||!t;if("all_rules"===s.filter)return G;if("BotID"===s.filter)return W;let a=(0,H.isLimitedSystemRule)(s.filter)?H.systemFilter:H.defaultFilter;return l?a.filter(e=>"clientIp"!==e.value):a},[s.filter,e,i,t]);return[s,r,n]}var J=e.i(1313611),K=e.i(2449862),Y=e.i(2480776),X=e.i(7666999);let ee=(0,l.createContext)({});function et(){return(0,l.useContext)(ee)}function el(e){let{children:i,formatter:a,series:s}=e,r=(0,X.default)(),[n,o]=Q(),[c,u]=(0,l.useState)(null),d=(0,l.useMemo)(()=>Array.from(s.values()).reduce((e,t)=>e.concat(t),[]),[s]),m=(0,l.useMemo)(()=>{let e={};return d.forEach(t=>{e[t.key]?e[t.key]+=t.value??0:e[t.key]=t.value??0}),e},[d]),x=(0,l.useMemo)(()=>[...s.keys()].sort((e,t)=>m[t]-m[e]),[s,m]);(0,l.useEffect)(()=>{!c||x.includes(c)||u(null)},[x,c]);let f=(0,l.useMemo)(()=>(0,Y.scaleOrdinal)({domain:x.sort(H.stableSort),range:[700,600,400,200].flatMap(e=>[`var(--ds-blue-${e})`,`var(--ds-amber-${e})`,`var(--ds-green-${e})`,`var(--ds-teal-${e})`,`var(--ds-purple-${e})`,`var(--ds-pink-${e})`,`var(--ds-red-${e})`,`var(--ds-gray-${e})`])}),[x]),h=(0,l.useMemo)(()=>Object.fromEntries(x.map(e=>[e,f(e)])),[x,f]),g=(0,l.useCallback)(e=>{"all_rules"===n.filter?e&&o({type:"filter",value:e.split("$")[0]}):u(e)},[o,n.filter]),p=(0,l.useMemo)(()=>({activeDataKey:c,allData:d,allKeys:x,colorScale:f,formatter:a,maxByKeys:m,seriesColor:h,setActiveDataKey:g,tooltip:r}),[c,d,x,f,a,m,g,h,r]);return(0,t.jsx)(ee.Provider,{value:p,children:i})}ee.displayName="VisualizationContext",e.i(2318668);var ei=e.i(8114796),ea=e.i(8353464),es=e.i(9722978),er=e.i(3228096),en=e.i(8724159),eo=e.i(4738733),ec=e.i(9658738);function eu(){return(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:gap-[unset] lg:divide-x lg:[&>*:not(:first-child)]:pl-3 lg:[&>*:not(:last-child)]:pr-3",children:[(0,t.jsx)("div",{className:"flex w-full flex-col gap-4 lg:flex-row lg:gap-3",children:(0,t.jsx)("div",{className:"w-full lg:w-[226px]",children:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"})})}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-4 lg:flex-row lg:gap-3",children:[(0,t.jsx)("div",{className:"w-full lg:w-[176px]",children:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"})}),(0,t.jsx)("div",{className:"w-full lg:w-[146px]",children:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"})})]})]})}function ed(e){let{height:l}=e;return(0,t.jsxs)("div",{className:"flex w-full flex-col",style:{height:l},children:[(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex h-36 flex-row items-center gap-5",children:[(0,t.jsx)(s.Skeleton,{height:16,width:28}),(0,t.jsx)("hr",{className:"w-full"})]}),(0,t.jsxs)("div",{className:"flex flex-row justify-around",children:[(0,t.jsx)(s.Skeleton,{height:16,width:48}),(0,t.jsx)(s.Skeleton,{height:16,width:48}),(0,t.jsx)(s.Skeleton,{className:"xs:block hidden",height:16,width:48}),(0,t.jsx)(s.Skeleton,{className:"hidden sm:block",height:16,width:48}),(0,t.jsx)(s.Skeleton,{className:"hidden md:block",height:16,width:48}),(0,t.jsx)(s.Skeleton,{className:"hidden lg:block",height:16,width:48})]})]})}var em=e.i(6881349),ex=e.i(8148719),ef=e.i(691329),eh=e.i(7993600),eg=e.i(2560270),ep=e.i(6318858),ej=e.i(3496900),eb=e.i(3679047),ev=e.i(4252765),ey=e.i(4004502),ew=e.i(421794);function eC(e){let l,{toolbarState:i,setToolbarState:a,rules:s,options:u,isCustomRuleSelected:d,team:m,managedRulesets:x}=e,f=Z.filter(e=>"live"===e.value||function(e,t){let l=e?.billing?.plan==="enterprise"?(0,E.default)("7d"):(0,E.default)("24h");return t<=l+l/12}(m,(0,E.default)(e.value))),h=f.find(e=>e.value===i.range),p=h?.icon||null,j=(0,eb.useParams)(),b=s.find(e=>e.value===i.filter);if("all_rules"===i.filter)l="Overview";else if(b)l=b.label;else if(i.filter.startsWith("managed_")){let e=i.filter.slice(8);if(l=e,x){let t=(0,ew.getRulesetFromRulesets)(x,e);t&&(l=t.name)}}else l=i.filter;let v=u.find(e=>e.value===i.groupBy);return(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:gap-[unset] lg:divide-x lg:[&>*:not(:first-child)]:pl-3 lg:[&>*:not(:last-child)]:pr-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:gap-3",children:[(0,t.jsxs)(em.Combobox,{"data-testid":(0,ey.tid)("firewall","graph-toolbar","filters"),"aria-label":"Select firewall filter option",className:(0,es.clsx)(ev.default.container,"w-full lg:w-[226px]"),clearable:"all_rules"!==i.filter,onChange:e=>{a({type:"filter",value:e||"all_rules"})},value:l,children:[(0,t.jsx)(em.Combobox.Input,{}),(0,t.jsx)(em.Combobox.List,{children:s.map(e=>(0,t.jsx)(em.Combobox.Option,{"data-testid":(0,ey.tid)("firewall","graph-toolbar","filter-value"),value:e.value,children:e.label},e.value))})]}),d?(0,t.jsx)(g.ButtonLink,{href:`/${j?.teamSlug}/${j?.project}/firewall/configure/rule/${i.filter}`,prefix:(0,t.jsx)(ej.PencilEdit,{}),type:"secondary",children:"Edit Rule"}):null]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:gap-3",children:[(0,t.jsxs)(r.MenuContainer,{children:[(0,t.jsx)(o.MenuButton,{align:"flex-grow",className:"w-full text-left font-normal lg:w-[176px]",style:{fontWeight:400},suffix:(0,t.jsx)(eg.ChevronDown,{}),type:"secondary",children:v?.label??""}),(0,t.jsx)(n.Menu,{className:"overflow-y-auto md:max-h-[250px] md:max-w-[200px] lg:min-w-[200px]",portalClassName:"tailwind-preflight",children:u.map(e=>{let{value:l,label:i}=e;return(0,t.jsx)(c.MenuItem,{label:i,onClick:()=>a({type:"groupBy",value:l}),suffix:v?.value===l?(0,t.jsx)(ep.Check,{size:16}):null,value:l,children:(0,t.jsx)("span",{children:i})},l)})})]}),(0,t.jsxs)(r.MenuContainer,{children:[(0,t.jsx)(o.MenuButton,{align:"flex-grow",className:"w-full text-left lg:w-[146px]",prefix:p?(0,t.jsx)(p,{}):null,style:{fontWeight:400},suffix:(0,t.jsx)(eg.ChevronDown,{}),type:"secondary",children:h?.label||"live"}),(0,t.jsx)(n.Menu,{className:"overflow-y-auto md:max-h-[250px] md:max-w-[200px] lg:min-w-[200px]",portalClassName:"tailwind-preflight",children:f.map(e=>{let{value:l,label:i}=e;return(0,t.jsx)(c.MenuItem,{label:i,onClick:()=>a({type:"range",value:l}),suffix:h?.value===l?(0,t.jsx)(ep.Check,{size:16}):null,value:l,children:(0,t.jsx)("span",{children:i})},l)})})]})]})]})}function ek(e){let{positionTop:i=0,...a}=e,[s,r]=(0,l.useState)(!1),{scrollY:n}=(0,ex.useScroll)(),o=(0,l.useRef)(null);return(0,eh.useMotionValueEvent)(n,"change",e=>{o.current&&r(e>(0,ea.getOffsetTop)(o.current)-56)}),(0,t.jsxs)("div",{ref:o,children:[(0,t.jsx)(ef.motion.div,{className:"z-[12]",style:{position:s?"fixed":void 0,top:s?i-56:0,left:0,right:0,paddingTop:8*!!s,paddingBottom:8*!!s,borderBottom:s?"1px solid var(--ds-gray-alpha-400)":void 0,background:s?"var(--ds-background-100)":void 0},children:(0,t.jsx)("div",{className:(0,es.clsx)({container:s}),children:(0,t.jsx)(eC,{...a})})}),s?(0,t.jsx)("div",{className:"h-[150px] lg:h-[40px]"}):null]})}var eS=e.i(5182595),eN=e.i(8690335);function e_(e){let{height:i,data:a,query:s,error:r,width:n,isLoading:o}=e,{allData:c,allKeys:u,colorScale:m,formatter:x}=et(),f=(0,l.useMemo)(()=>(function(e,t){let l=new Map(e.map(e=>{let{date:l}=e;return[l.toISOString(),{time:l.toISOString(),name:l.toISOString(),date:l,...Object.fromEntries(t.map(e=>[e,0]))}]}));return e.forEach(e=>{let{date:t,key:i,value:a}=e,s=l.get(t.toISOString());s&&(s[i]=a)}),[...l.values()].sort((e,t)=>e.date.getTime()-t.date.getTime())})(c.filter(e=>!(0,ea.isOthersAggregate)(e.key)),u),[c,u]);return n<10?null:r?(0,t.jsxs)("div",{"data-testid":(0,ey.tid)("firewall","graph","error"),className:"border-border flex flex-col items-center justify-center gap-2 rounded-md border border-gray-400 bg-[var(--accents-1)]",style:{height:i},children:[(0,t.jsx)(d.Text,{className:"capitalize",weight:500,children:r.code}),(0,t.jsx)(d.Text,{className:"max-w-[400px] text-gray-800",children:r.message})]}):!a||o&&0===a.size?(0,t.jsx)(ed,{height:i}):0===a.size?(0,t.jsxs)("div",{"data-testid":(0,ey.tid)("firewall","graph","empty"),className:"border-border flex flex-col items-center justify-center gap-2 rounded-md border border-gray-400 bg-[var(--accents-1)]",style:{height:i},children:[(0,t.jsx)(d.Text,{weight:500,children:"No Data"}),(0,t.jsx)(d.Text,{className:" max-w-[400px] text-gray-800",children:"There's no data available for your selection."})]}):(0,t.jsx)("div",{style:{height:i},children:(0,t.jsx)(eS.LineChart,{agentWorkflow:"firewall-investigation",data:f,categories:u,getColor:m,isLoading:o,syncId:"firewall",disableLegend:!0,formatValue:e=>x(e),formatXAxisValue:eR,xTickCount:5,yTickCount:5,builderQuery:(0,eN.fromSonarQuery)(s),tooltipStyle:"dots",disableZoom:!0})})}let eA={hour:"numeric",minute:"2-digit",second:"numeric"};function eR(e){return e.toLocaleTimeString(void 0,eA)}var eM=e.i(7511103),eB=e.i(3869281),eT=e.i(6891161),eL=e.i(3500331),eP=e.i(1438473);function eI(e){let{open:i,isEnabled:s,isLoading:r,onClose:n,onSubmit:o,confirmText:c}=e,[u,m]=(0,l.useState)(""),[x,f]=(0,l.useState)(!1),h=s?"Resume":"Pause",p=s?(0,t.jsx)("p",{children:"Are you sure you want to resume all system mitigations?"}):(0,t.jsxs)(a.Stack,{gap:1,children:[(0,t.jsxs)(d.Text,{size:14,children:["You are pausing ",(0,t.jsx)("strong",{children:"all DDoS protections"}),". Here's what to expect:"]}),(0,t.jsxs)(a.Stack,{className:"pl-3 pt-3",children:[(0,t.jsxs)(a.Stack,{direction:"row",gap:2,align:"flex-start",children:[(0,t.jsx)(d.Text,{size:14,color:"gray-600",children:"•"}),(0,t.jsxs)(d.Text,{size:14,children:["All traffic will be accepted by your project over the"," ",(0,t.jsx)("strong",{children:"next 24 hours"})]})]}),(0,t.jsxs)(a.Stack,{direction:"row",gap:2,align:"flex-start",children:[(0,t.jsx)(d.Text,{size:14,color:"gray-600",children:"•"}),(0,t.jsx)(d.Text,{size:14,children:"You will incur usage fees for all malicious traffic, including failed requests"})]}),(0,t.jsxs)(a.Stack,{direction:"row",gap:2,align:"flex-start",children:[(0,t.jsx)(d.Text,{size:14,color:"gray-600",children:"•"}),(0,t.jsx)(d.Text,{size:14,children:"Malicious traffic and associated fees will continue until DDoS protection is manually resumed or after 24 hours elapses"})]})]}),(0,t.jsx)(a.Stack,{className:"pt-2",gap:1,children:(0,t.jsxs)(d.Text,{children:["System mitigations should be paused as a temporary measure. Permanent system bypasses may be applied through the firewall configuration page."," ",(0,t.jsxs)(g.Link,{href:"./firewall/configure",variant:"blend",className:"inline-flex items-center gap-1",children:["Configure ",(0,t.jsx)(eP.ArrowRight,{size:12})]})]})})]});return(0,l.useEffect)(()=>{i||m("")},[i]),(0,t.jsxs)(eT.Modal.Modal,{active:i,onClickOutside:n,children:[(0,t.jsx)(eT.Modal.Body,{children:(0,t.jsxs)(a.Stack,{gap:2,children:[(0,t.jsx)(eT.Modal.Title,{children:`${h} System Mitigations`}),(0,t.jsx)(eT.Modal.P,{children:p}),s?null:(0,t.jsx)(eT.Modal.Inset,{last:!0,children:(0,t.jsxs)(a.Stack,{gap:3,children:[(0,t.jsxs)(d.Text,{color:"gray-900",size:14,weight:400,children:["To confirm, enter the project name"," ",(0,t.jsxs)("b",{style:{},children:[c," "]})," below:"]}),(0,t.jsx)(eL.Input,{"aria-label":"Project name",disabled:r,name:"projectName",onChange:e=>m(e.target.value),value:u}),(0,t.jsx)(eB.Checkbox,{checked:x,onChange:e=>f(e.target.checked),children:"I understand that pausing system mitigations may result in additional fees due to unmitigated attack traffic."})]})})]})}),(0,t.jsxs)(eT.Modal.Actions,{children:[(0,t.jsx)(eT.Modal.Action,{onClick:n,type:"secondary",children:"Cancel"}),(0,t.jsx)(eT.Modal.Action,{disabled:r||!s&&(u!==c||!x),loading:r,onClick:o,children:h})]})]})}function eF(e){let{onActionClick:l,query:i,state:a}=e,{can:s}=(0,N.default)(),r=(0,ea.wafRuleId)(a.filter),{currentData:n}=(0,I.useSonarLiveQuery)({...i,filter:"all_rules"===a.filter?void 0:`wafRuleId eq '${r}'`,groupBy:["wafAction"],summaryOnly:!0},"live"===a.range&&(s(_.Action.Read,_.Resource.SeawallConfig)||s(_.Action.List,_.Resource.SeawallConfig))),o=(n?.summary??[]).reduce((e,t)=>{let l="allow"===t.wafAction?"allow":(0,ea.normalizeFirewallAction)(t.wafAction);return l in e&&(e[l]+=t.value??0),e.all+=t.value??0,e},{all:0,allow:0,challenge:0,deny:0,log:0,rate_limit:0});return(0,t.jsx)("div",{className:"relative overflow-hidden rounded-t-md @container before:pointer-events-none before:absolute before:inset-0 before:shadow-[inset_-30px_0_20px_-20px_var(--ds-background-200)] before:content-[''] @[966px]:before:shadow-none",children:(0,t.jsxs)("div",{className:"flex flex-1 flex-row overflow-x-scroll divide-x [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[(0,t.jsx)(e$,{active:"all"===a.action,icon:(0,t.jsx)(er.Globe,{}),label:"All Traffic",onClick:()=>l("all"),children:o.all}),(0,t.jsx)(e$,{active:"allow"===a.action,icon:(0,t.jsx)(en.ShieldCheck,{}),label:"Allowed",onClick:()=>l("allow"),children:o.allow}),(0,t.jsx)(e$,{active:"deny"===a.action,icon:(0,t.jsx)(j.ShieldOff,{}),label:"Denied",onClick:()=>l("deny"),children:o.deny}),(0,t.jsx)(e$,{active:"challenge"===a.action,icon:(0,t.jsx)(p.Shield,{}),label:"Challenged",onClick:()=>l("challenge"),children:o.challenge}),(0,t.jsx)(e$,{active:"log"===a.action,icon:(0,t.jsx)(eo.CodeWrap,{}),label:"Logged",onClick:()=>l("log"),children:o.log}),(0,t.jsx)(e$,{active:"rate_limit"===a.action,icon:(0,t.jsx)(ec.Gauge,{}),label:"Rate Limited",onClick:()=>l("rate_limit"),children:o.rate_limit})]})})}function e$(e){let{active:l,children:i,icon:s,label:r,onClick:n}=e;return(0,t.jsxs)(a.Stack,{as:"button",className:(0,es.clsx)("min-w-[166px] cursor-pointer",{"bg-background-100 border-b-2 border-b-gray-1000":l,"bg-background-200 border-b border-b-gray-200":!l}),flex:1,gap:1,onClick:n,padding:5,children:[(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,className:l?"text-gray-1000":"text-gray-800",children:[s,(0,t.jsx)(d.Text,{className:"whitespace-nowrap",variant:"label-14",weight:500,children:r})]}),(0,t.jsx)(d.Text,{align:"left",variant:"heading-24",weight:500,children:0===i?"-":(0,ea.formatShortPrecision)(i)})]})}var eD=e.i(8835183),eO=e.i(5797774),ez=e.i(192211);let eU=(0,e.i(9334638).withNewIcon)(`<g clip-path="url(#clip0_4628_1818)">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0932 7.64904C14.8377 3.56123 11.3168 0.454519 7.22898 0.710006C5.45234 0.821046 3.8593 1.54996 2.64882 2.67365L3.66933 3.77299C4.63533 2.87625 5.90403 2.29574 7.32254 2.20709C10.5835 2.00327 13.3923 4.48161 13.5961 7.74261C13.663 8.81244 14.0605 10.1035 15.1336 10.8299L15.9745 9.58773C15.4544 9.23567 15.1467 8.50463 15.0932 7.64904ZM1.21934 4.48945C0.544864 5.69225 0.197633 7.09732 0.28994 8.57425C0.414316 10.5643 0.700415 12.5343 1.14241 14.4655L2.6046 14.1308C2.1807 12.2786 1.90631 10.3893 1.78702 8.48068C1.71326 7.30048 1.99016 6.18167 2.52767 5.22312L1.21934 4.48945ZM11.9314 8.14996C11.7883 5.86143 9.81714 4.12215 7.5286 4.26518C5.24007 4.40822 3.50079 6.3794 3.64382 8.66793C3.6894 9.3971 3.75974 10.1232 3.85448 10.845L5.34173 10.6498C5.25141 9.9617 5.18435 9.2695 5.1409 8.57437C5.04955 7.11264 6.16045 5.85362 7.62217 5.76226C9.0839 5.67091 10.3429 6.78181 10.4343 8.24353C10.4726 8.85698 10.5332 9.46767 10.6157 10.0745L12.102 9.87246C12.0244 9.30161 11.9674 8.72708 11.9314 8.14996ZM13.0024 13.8749C12.7538 13.0919 12.5457 12.2962 12.379 11.4908L10.9101 11.7947C11.0749 12.5911 11.2779 13.3786 11.5181 14.1546L13.0024 13.8749ZM14.6499 24.8207L10.8508 25.5691C11.9295 25.8912 13.1347 25.7761 14.176 25.1513C14.3437 25.0507 14.5018 24.94 14.6499 24.8207ZM4.79771 15.421C4.62667 14.8172 4.47329 14.2083 4.33781 13.5951C4.27053 13.2906 4.20767 12.985 4.14924 12.6784L5.62272 12.3976C5.67842 12.6899 5.73835 12.9812 5.80249 13.2715C5.94137 13.9001 6.09998 14.5239 6.27803 15.142L4.79771 15.421ZM8.11677 14.7955L8.0783 14.6651L8.0775 14.6624C7.46325 12.5503 7.08106 10.3695 6.94287 8.1585C6.91703 7.7451 7.23122 7.38902 7.64463 7.36318C8.05803 7.33734 8.41411 7.65153 8.43995 8.06494C8.57119 10.1649 8.93413 12.2361 9.51744 14.2421L9.51783 14.2435L9.5983 14.5164L8.11677 14.7955Z" fill="currentColor" />
  </g>
  <defs>
  <clipPath id="clip0_4628_1818">
  <rect width="16" height="16" fill="white" style="fill:white;fill-opacity:1;"/>
  </clipPath>
  </defs>`);var eE=e.i(6675233),eq=e.i(5169576),eH=e.i(9339975),eG=e.i(1637579),eV=e.i(5338940),eW=e.i(9961052),eZ=e.i(4138437),eQ=e.i(3672946);let eJ=(0,l.createContext)({});function eK(e){let{children:i,className:a}=e,[s,r]=(0,l.useState)(!1),n=(0,l.useMemo)(()=>({expanded:s,setExpanded:r}),[s,r]);return(0,t.jsx)(eZ.Card,{border:!0,className:(0,es.clsx)("relative overflow-hidden",a),children:(0,t.jsx)(eJ.Provider,{value:n,children:i})})}eJ.displayName="ExpandablePanelContext",eK.Header=function(e){let{children:l,className:i}=e;return(0,t.jsx)("div",{className:(0,es.clsx)("border-b px-5 py-3",i),children:l})},eK.Footer=function(e){let{children:l}=e;return(0,t.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 flex flex-row items-center justify-center bg-gradient-to-t from-background-200 to-background-200/0 pb-4",children:l})},eK.Expand=function(){let{setExpanded:e}=(0,l.useContext)(eJ);return(0,t.jsx)(i.Button,{className:"pointer-events-auto mr-[3px]",onClick:()=>e(!0),shadow:!0,shape:"rounded",size:"small",suffix:(0,t.jsx)(eQ.Fullscreen,{}),type:"secondary",children:"View All"})},eK.Expanded=function(e){let{children:i,...a}=e,{expanded:s,setExpanded:r}=(0,l.useContext)(eJ);return(0,t.jsxs)(eT.Modal.Modal,{...a,active:s,onClickOutside:()=>r(!1),style:{height:"80vh"},width:600,children:[(0,t.jsx)(eT.Modal.Body,{className:"flex-1 p-0",children:i}),(0,t.jsx)(eT.Modal.Actions,{children:(0,t.jsx)(eT.Modal.Action,{fullWidth:!0,onClick:()=>r(!1),children:"Close"})})]})};var eY=e.i(3863657),eX=e.i(9264886),e0=e.i(5433449);function e1(e){let{isOpen:l,onClose:i}=e;return(0,t.jsxs)(eT.Modal.Modal,{active:l,onClickOutside:i,children:[(0,t.jsxs)(eT.Modal.Body,{children:[(0,t.jsxs)(eT.Modal.Header,{children:[(0,t.jsx)(eT.Modal.Title,{children:(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(e0.FileText,{size:20}),"Deployment Rules"]})}),(0,t.jsxs)(eT.Modal.Subtitle,{children:["Rules defined in ",(0,t.jsx)("code",{children:"vercel.json"})," files, created at build time."]})]}),(0,t.jsxs)(eT.Modal.P,{children:["Deployment rules are firewall rules that are automatically created from your project's ",(0,t.jsx)("code",{children:"vercel.json"})," configuration file. They are generated at build time and run at the edge before your application code executes to protect your deployment."]}),(0,t.jsxs)(eT.Modal.P,{children:["Each action type is shown separately and these rules are automatically generated from your ",(0,t.jsx)("code",{children:"vercel.json"}),"."]}),(0,t.jsxs)(eT.Modal.P,{children:["Learn more about configuring deployment rules in"," ",(0,t.jsx)(g.Link,{href:"/docs/project-configuration",target:"_blank",external:!0,variant:"highlight",children:"project configuration"})," ","or read about the"," ",(0,t.jsx)(g.Link,{href:"/docs/vercel-firewall",target:"_blank",external:!0,variant:"highlight",children:"Vercel firewall"}),"."]})]}),(0,t.jsx)(eT.Modal.Actions,{children:(0,t.jsx)(eT.Modal.Action,{onClick:i,type:"secondary",children:"Close"})})]})}function e4(e){let{config:i,project:a,rulesets:s}=e,{hoveredTimestamp:r}=(0,eX.useSonarContext)(),[n,o,c]=Q(),{maxByKeys:u,allData:d}=et(),m=(0,eb.useParams)(),x=function(e,t){let[i,a]=(0,l.useState)(e7(e,t)),s=(0,l.useRef)(e7(e,t));return(0,l.useEffect)(()=>{let l=performance.now(),i=e7(e,t),r=s.current,n=r.length===i.length,o=0,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),t=Math.sin(Math.min((e-l)/100,1))*Math.PI*.5;if(!n||t>=1){a(i),Object.assign(r,i);return}o=requestAnimationFrame(c);let s=Array(i.length);for(let e=i.length;e--;){let l=i[e],a=r[e];s[e]={name:l.name,total:l.total,value:e8(a.value,l.value,t),ratio:e8(a.ratio,l.ratio,t)}}a(s)};return c(),()=>{cancelAnimationFrame(o),a(l=>(Object.assign(r,l),e7(e,t)))}},[e,t]),i}(u,(0,l.useMemo)(()=>{if(r)return Object.fromEntries(d.filter(e=>e.date.getTime()===r.getTime()).map(e=>[e.key,e.value]))},[r,d])),f=(0,l.useCallback)(e=>{let t="all_rules"===n.filter;if("BotID"===n.filter)return`/${m?.teamSlug}/${m?.project}/observability?builder=true&${new URLSearchParams({time:"1d",metric:"botIdCheck.count",by:"botCheckResult",aggregate:"sum"}).toString()}`;let l=(0,ea.wafRuleId)(t?e:n.filter),i={time:"1d",by:"wafAction",filter:[a?.id&&`projectId eq '${a.id}'`,`wafRuleId eq '${l}'`].filter(e=>!!e).join(" and "),aggregate:"sum"};(0,H.isLimitedSystemRule)(l)?(i.metric="blockedConnection.count","clientIp"===n.groupBy&&(i.by="clientIp",i.where=`clientIp eq '${e}'`)):(i.metric="incomingRequest.count",t||(i.filter=[i.filter,`${n.groupBy} eq '${e}'`].join(" and ")));let s=new URLSearchParams(i);return`/${m?.teamSlug}/${m?.project}/observability?builder=true&${s.toString()}`},[m,a?.id,n.filter,n.groupBy]),h=(0,l.useCallback)(e=>{let t,l,[i]=e.split(eY.SEPARATOR);switch(n.groupBy){case"clientIp":t="ip_address",l="IP Address";break;case"clientIpCountry":t="geo_country",l="Country";break;case"clientAsn":t="geo_as_number",l="ASN";break;case"requestPath":t="path",l="Request Path";break;case"edgeNetworkRegion":t="region",l="Vercel Region";break;case"clientUserAgent":t="user_agent",l="User Agent";break;case"sourcePath":t="target_path",l="Route";break;case"clientJa4Digest":t="ja4_digest",l="JA4";break;case"requestHostname":t="host",l="Host";break;default:return null}let a=[{conditions:[{type:t,op:"eq",value:i}]}],s=i;s&&s.length>60&&(s=s.slice(0,60));let r=JSON.stringify({name:`Rule for ${l}: ${s}`,description:`Automatically created from firewall table for ${l} ${s}`,conditionGroup:a,active:!0,action:{mitigate:{action:"log"}}}),o=(0,S.getRuleTemplateSignature)(r),c=new URLSearchParams({template:r,sig:o});return`/${m?.teamSlug}/${m?.project}/firewall/configure/rule/new?${c.toString()}`},[m?.teamSlug,m?.project,n.groupBy]),g=Object.fromEntries(Object.entries((0,l.useMemo)(()=>"all_rules"===n.filter?"group_by_category"===n.groupBy?x.reduce((e,t)=>{let[l,i]=t.name.split(eY.SEPARATOR),a=H.ruleToMappings[l];if(a?.groupBy){let l=e[a.groupBy];l?l.push(t):l=[t],e[a.groupBy]=l}else(0,ea.isCustomRuleId)(l)?e["Custom Rules"].push(t):e.System.push(t);return e},{System:[],"Custom Rules":[]}):x.reduce((e,t)=>{let[,l]=t.name.split(eY.SEPARATOR),i=(0,ea.formatFirewallActionForDisplay)(l),a=e[i];return a?a.push(t):a=[t],e[i]=a,e},{}):{[n.groupBy]:x},[x,n.filter,n.groupBy])).filter(e=>{let[,t]=e;return t.length>0}));return(0,t.jsx)("div",{className:(0,es.clsx)("grid w-full grid-cols-1 gap-3",{"lg:grid-cols-2":Object.keys(g).length>1}),children:Object.entries(g).map(e=>{let[l,a]=e;return(0,t.jsx)(e2,{config:i,createMonitoringSearchParams:f,createRuleBuilderLink:h,header:l,params:m,rulesets:s,segment:a,toolbarState:n,ruleOptions:c},l)})})}function e2(e){let{config:i,header:a,rulesets:s,segment:r,toolbarState:n,ruleOptions:o,createMonitoringSearchParams:c,createRuleBuilderLink:u,params:m}=e,[x,f]=(0,l.useState)(""),[h,g]=(0,l.useState)(!1),p=e9(i,s,n),j=r;x&&(j=j.filter(e=>{let{label:t,suffix:l}=p(e.name);return t.toLowerCase().includes(x.toLowerCase())||l?.toLowerCase().includes(x.toLowerCase())}));let b=e=>{let t=e.name.replace(/\$\$.*/,""),l=i?.ruleMap.get(t),a=i?.ruleMap.get(t)?.type==="custom_rule";return{config:i,createMonitoringSearchParams:c,createRuleBuilderLink:u,fieldId:t,isCustomRule:a,params:m,point:e,ruleFields:l,rulesets:s,toolbarState:n,onDeploymentRuleInfoClick:()=>{g(!0)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(eK,{children:[(0,t.jsxs)(eK.Header,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(d.Text,{className:"leading-6",variant:"label-14",weight:500,children:(0,ea.formatTableHeader)(o,a)}),"Custom Rules"===a?(0,t.jsx)(e3,{}):null]}),(0,t.jsx)("div",{className:"p-2 [&>*:nth-child(odd)]:bg-background-200",children:r.slice(0,5).map(e=>(0,t.jsx)(e6,{...b(e)},e.name))}),r.length>5&&(0,t.jsx)(eK.Footer,{children:(0,t.jsx)(eK.Expand,{})}),(0,t.jsx)(eK.Expanded,{disableFocusTrap:!0,children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"border-b border-red-100 p-5",children:(0,t.jsx)(d.Text,{variant:"heading-16",weight:500,children:(0,ea.formatTableHeader)(o,a)})}),(0,t.jsx)("div",{className:"px-2",children:(0,t.jsx)(eD.SearchInput,{clearable:!1,onChange:e=>f(e.target.value),placeholder:"Search",value:x})}),(0,t.jsx)("div",{className:"p-2",children:j.map(e=>(0,t.jsx)(e6,{...b(e)},e.name))})]})})]}),(0,t.jsx)(e1,{isOpen:h,onClose:()=>g(!1)})]})}function e3(){let e=(0,eb.useParams)(),{isLoading:l,team:i}=(0,eV.useTeam)(),{can:a,isLoading:r}=(0,N.default)(),{data:n,isLoading:o}=(0,T.useProject)(e?.project,{apiVersion:"v13"}),{config:c,isLoadingConfig:u}=(0,F.useFirewallConfig)({projectId:n?.id});if(r||u||o||l)return(0,t.jsx)(s.Skeleton,{height:24,width:24});let d=a(_.Action.All,_.Resource.SeawallConfig),m=n?.microfrontends!==void 0&&!n.microfrontends.isDefaultApp,x=(0,ea.isPlanLimitReached)({config:c,teamPlan:i?.billing?.plan,type:"customRules"});return(0,t.jsx)(g.ButtonLink,{"aria-label":"Add a custom rule",disabled:!d||m||x,href:"firewall/configure/rule/new",size:"tiny",style:{"--height":"24px"},svgOnly:!0,type:"secondary",children:(0,t.jsx)(b.Plus,{})})}function e6(e){let{config:l,createMonitoringSearchParams:i,createRuleBuilderLink:a,fieldId:s,isCustomRule:m,params:x,point:f,ruleFields:h,rulesets:g,toolbarState:p,onDeploymentRuleInfoClick:j}=e,{activeDataKey:b,formatter:v,seriesColor:y,setActiveDataKey:C}=et(),k=!(0,ea.isOthersAggregate)(f.name),S=a(s),N=!(0,ea.isOthersAggregate)(f.name)&&null!==S,_=()=>{k&&C(b===f.name?null:f.name)};return(0,t.jsxs)("div",{className:(0,es.clsx)("flex min-h-[36px] flex-1 items-center gap-5 rounded-md p-2",{"transition-colors hover:!bg-gray-100 cursor-pointer":k}),onClick:_,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&_()},role:"button",tabIndex:0,"aria-disabled":!k,children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-2 border-none bg-transparent text-start",children:[(0,t.jsx)("div",{className:"size-[8px] rounded-full",style:{backgroundColor:null!==b&&b!==f.name?"var(--ds-gray-400)":y[f.name]}}),(0,t.jsx)(e5,{config:l,disabled:h?.type==="custom_rule"&&!h.active,rulesets:g,toolbarState:p,children:f.name}),(0,t.jsx)(d.Text,{className:"select-text tabular-nums",color:"gray-900",variant:"label-14",children:v(f.value)})]}),(0,t.jsxs)(r.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(o.MenuButton,{"aria-label":"more menu button",className:"flex max-h-[24px] items-center",shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(w.MoreHorizontal,{})}),(0,t.jsxs)(n.Menu,{className:"min-w-[180px]",portalClassName:"tailwind-preflight",children:[m?(0,t.jsx)(u.MenuLink,{href:`/${x?.teamSlug}/${x?.project}/firewall/configure/rule/${s}`,target:"_blank",children:(0,t.jsx)("span",{children:"Edit Rule"})}):null,(0,t.jsx)(c.MenuItem,{onClick:e=>{e.stopPropagation();let[t]=f.name.split("$$");navigator.clipboard.writeText(t)},children:(0,t.jsx)("span",{children:"Copy Value"})}),"deployment_defined_rules"===s?(0,t.jsx)(c.MenuItem,{onClick:e=>{e.stopPropagation(),j()},children:(0,t.jsx)("span",{children:"What is this?"})}):null,(0,ea.isOthersAggregate)(f.name)?null:(0,t.jsx)(u.MenuLink,{href:i(s),target:"_blank",children:(0,t.jsx)("span",{className:"whitespace-nowrap",children:"Inspect Traffic"})}),N?(0,t.jsx)(u.MenuLink,{href:S,target:"_blank",children:(0,t.jsx)("span",{className:"whitespace-nowrap",children:"Create Custom Rule"})}):null]})]})]})}function e5(e){let{children:l,config:i,disabled:a,rulesets:s,toolbarState:r}=e,{context:n,icon:o,label:c,suffix:u}=e9(i,s,r)(l);return(0,t.jsxs)("div",{className:"flex flex-1 flex-row items-center gap-2",children:[(0,t.jsx)(eO.ContextCard.Trigger,{content:n??null,noPadding:!0,children:(0,t.jsxs)(d.Text,{className:"flex items-center gap-2",color:a?"gray-600":"gray-1000",variant:"label-14",weight:500,children:[c,u?(0,t.jsx)(d.Text,{as:"span",color:a?"gray-600":"gray-900",children:u}):null,o?(0,t.jsx)("span",{className:`flex items-center ${a?"text-gray-600":"text-gray-900"}`,children:o}):null]})}),a?(0,t.jsx)(m.Badge,{variant:"gray-subtle",children:"Disabled"}):null]})}function e9(e,l,i){return a=>{var s,r;if((0,ea.isOthersAggregate)(a))return{label:"Other"};let[n,o,...c]=a.split(eY.SEPARATOR);if("clientIp"===i.groupBy){let e=c[2]?.toUpperCase(),l=eW.countriesByAlpha2[e],i=Array.isArray(l)?l[0]:l||e,a=eW.flagsByAlpha2[e];return{label:n,suffix:(0,ea.formatFirewallActionForDisplay)(o),context:(0,t.jsxs)("div",{className:"flex w-[250px] flex-col",children:[(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)(d.Text,{className:"mb-3",variant:"heading-14",weight:500,children:["Details for ",n]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-1 flex-row items-baseline justify-between gap-6",children:[(0,t.jsx)(d.Text,{className:"shrink-0",variant:"label-13",children:"AS Name"}),(0,t.jsx)(d.Text,{align:"right",color:"gray-800",variant:"label-13",children:c[1]||"N/A"})]}),(0,t.jsxs)("div",{className:"flex flex-1 flex-row items-baseline justify-between gap-6",children:[(0,t.jsx)(d.Text,{variant:"label-13",children:"AS Number"}),(0,t.jsx)(d.Text,{color:"gray-800",variant:"label-13",children:c[0]||"N/A"})]})]})]}),i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ez.Divider,{}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(d.Text,{variant:"label-13",children:[a,i].filter(Boolean).join(" ")})})]}):null]})}}if("clientIpCountry"===i.groupBy){let e=eW.countriesByAlpha2[n.toUpperCase()];return{label:Array.isArray(e)?e[0]:e||a,suffix:(0,ea.formatFirewallActionForDisplay)(o)}}if("clientUserAgent"===i.groupBy&&(0,ew.isBotProtectionData)(i.filter)&&(s=n,te.some(e=>!(!e.must_contain.every(e=>s.includes(e))||e.must_not_contain&&e.must_not_contain.some(e=>s.includes(e)))&&!0)))return{label:n,suffix:(0,ea.formatFirewallActionForDisplay)(o),icon:(0,t.jsx)(eq.Information,{size:14,className:"flex-none"}),context:(0,t.jsx)("div",{className:"flex w-[250px] flex-col",children:(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)(d.Text,{className:"mb-3 flex items-center gap-1",variant:"heading-14",weight:500,children:[(0,t.jsx)(eE.Robot,{className:"flex-none"})," Spoofed or malicious traffic"]}),(0,t.jsxs)(d.Text,{variant:"label-13",children:["These requests claimed to be from a legitimate bot but were flagged because they failed our"," ",(0,t.jsx)(g.Link,{external:!0,href:"/docs/bot-management#verified-bots",isDifferentZone:!0,variant:"highlight",children:"verification"})]})]})})};if("clientUserAgent"===i.groupBy&&(0,ew.isBotProtectionData)(i.filter)&&(r=n).startsWith("Mozilla/")&&!r.includes("Headless")&&!r.includes("bot")&&!r.includes("Bot"))return{label:n,suffix:(0,ea.formatFirewallActionForDisplay)(o),icon:(0,t.jsx)(eq.Information,{size:14,className:"flex-none"}),context:(0,t.jsx)("div",{className:"flex w-[250px] flex-col",children:(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)(d.Text,{className:"mb-3 flex items-center gap-1",variant:"heading-14",weight:500,children:[(0,t.jsx)(eU,{className:"flex-none"})," Likely non-browser traffic"]}),(0,t.jsxs)(d.Text,{variant:"label-13",children:["These requests use browser User-Agents but their HTTP and TLS"," ",(0,t.jsx)(g.Link,{external:!0,href:"/docs/bot-management#bot-protection-managed-ruleset",isDifferentZone:!0,variant:"highlight",children:"fingerprints"})," ","do not match actual browser behavior"]})]})})};if("clientUserAgent"===i.groupBy)return{label:n,suffix:(0,ea.formatFirewallActionForDisplay)(o),context:(0,t.jsx)(eH.UserAgentDetailCard,{value:n})};if("edgeNetworkRegion"===i.groupBy){let e=eG.regions[n];return e?{label:e.name,suffix:e.providerRegion}:{label:a,suffix:(0,ea.formatFirewallActionForDisplay)(o)}}if("wafRuleId"===i.groupBy||"all_rules"===i.filter){if(n.startsWith("managed_")){let[e,t]=n.split("managed_"),i=(0,ew.getRulesetFromRulesets)(l,t);if(i)return{label:i.name,suffix:(0,ea.formatFirewallActionForDisplay)(o)}}let t=[];e&&(t.push(...e.rules),t.push(...e.crsRules),t.push(...e.currentConfig.ips.map(e=>({id:e.id,name:`IP Block ${"*"===e.hostname?"":e.hostname} ${e.ip}`}))));let i=t.find(e=>e.id===n);if(i)return{label:i.name,suffix:(0,ea.formatFirewallActionForDisplay)(o)};let a=H.ruleToMappings[n];if(a)return{label:a.label,suffix:(0,ea.formatFirewallActionForDisplay)(o)};if("deployment_rules"===n)return{label:"Deployment Rules",suffix:(0,ea.formatFirewallActionForDisplay)(o)};if("deployment_defined_rules"===n)return{label:"Deployment Defined Rules",suffix:(0,ea.formatFirewallActionForDisplay)(o)}}return"BotID"===i.filter?{label:n}:{label:n,suffix:(0,ea.formatFirewallActionForDisplay)(o)}}}function e7(e,t){let l=0;return Object.entries(e).map(e=>{let[i,a]=e,s=a;return void 0!==t?.[i]&&(s=t[i]),l+=s,{name:i,value:s,total:a,ratio:0}}).sort((e,t)=>(0,ea.isOthersAggregate)(e.name)?1:(0,ea.isOthersAggregate)(t.name)?-1:t.total-e.total).map(e=>({name:e.name,value:e.value,ratio:e.value/Math.max(l,1)*100,total:e.total}))}function e8(e,t,l){if(null===e)return t;let i=e||0;return Math.max(0,i+(t-i)*l)}let te=[{must_contain:["Googlebot"]},{must_contain:["bingbot/2.0"]},{must_contain:["DuckDuckBot"]},{must_contain:["DuckAssistBot"]},{must_contain:["YandexBot"]},{must_contain:["Applebot"]},{must_contain:["AhrefsBot"]},{must_contain:["AhrefsSiteAudit"]},{must_contain:["SemrushBot"]},{must_contain:["SiteAuditBot"]},{must_contain:["SplitSignalBot"]},{must_contain:["BacklinksExtendedBot"]},{must_contain:["ImagesiftBot"]},{must_contain:["GPTBot"]},{must_contain:["Claude-Web"]},{must_contain:["Claude-Search"]},{must_contain:["PerplexityBot"]},{must_contain:["OAI-SearchBot"]},{must_contain:["AlgoliaBot"]},{must_contain:["AdsBot-Google"]},{must_contain:["Mediapartners-Google"]},{must_contain:["APIs-Google"]},{must_contain:["Google-Safety"]},{must_contain:["Google-Site-Verification"]},{must_contain:["Google-InspectionTool"]},{must_contain:["Google-Read-Aloud"]},{must_contain:["Google-PageRenderer"]},{must_contain:["Google-PublisherCenter"]},{must_contain:["Google-Storebot"]},{must_contain:["Google-CloudVertexBot"]},{must_contain:["facebookexternalhit"],must_not_contain:["facebookexternalhit/1.1 Facebot Twitterbot/1.0"]},{must_contain:["facebookcatalog"]},{must_contain:["Twitterbot"],must_not_contain:["facebookexternalhit/1.1 Facebot Twitterbot/1.0"]},{must_contain:["LinkedInBot"]},{must_contain:["http://www.pinterest.com/bot.html"]},{must_contain:["meta-externalfetcher"]},{must_contain:["meta-externalagent"]},{must_contain:["UptimeRobot"]},{must_contain:["Pingdom"]},{must_contain:["Site24x7"]},{must_contain:["Better Uptime Bot"]},{must_contain:["Datadog/Synthetics"]},{must_contain:["SentryUptimeBot"]},{must_contain:["HetrixTools Uptime Monitoring Bot"]},{must_contain:["StatusCake"]},{must_contain:["Checkly"]},{must_contain:["Hydrozen.io"]},{must_contain:["ChatGPT-User"]},{must_contain:["Perplexity-User"]},{must_contain:["Stripe/"]},{must_contain:["PayPal"]},{must_contain:["GitHub-Hookshot"]},{must_contain:["GitHub-Camo"]},{must_contain:["Amazon-Route53-Health-Check"]},{must_contain:["amazonbot"]},{must_contain:["Amazon-Q"]},{must_contain:["Amazon-Kendra"]},{must_contain:["Cookiebot"]},{must_contain:["lumar.io"]},{must_contain:["deepcrawl.com"]},{must_contain:["inngest.com"]},{must_contain:["hookdeck.com"]},{must_contain:["qstash.com"]},{must_contain:["svix.com"]},{must_contain:["v0.dev"]},{must_contain:["Vercel Screenshot"]},{must_contain:["Vercel Favicon"]},{must_contain:["artemis web reader"]}];var tt=e.i(762945),tl=e.i(609109),ti=e.i(9358876),ta=e.i(244384),ts=e.i(6944292);let tr="z-[11]";function tn(e){let{anomaly:l,className:i,config:a,globalBypass:s,reverseProxies:r,rulesets:n}=e,o=(0,eb.useParams)();return(0,t.jsx)(eZ.Card,{border:!0,className:(0,es.clsx)("relative flex flex-col items-center overflow-hidden bg-background-100 p-6",i),rounded:!0,children:(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(ta.StatusBadge,{className:"mb-12 mt-10",variant:l?"warning":s?.enabled?"error":"success"}),l?(0,t.jsx)(to,{anomaly:l}):s?.enabled?(0,t.jsx)(tc,{globalBypass:s}):(0,t.jsx)(tu,{})]}),(0,t.jsxs)("div",{className:"z-[11] flex flex-col items-center gap-2",children:[n&&(0,ew.botProtectionFromRulesets)(n)?(0,t.jsx)(ts.BotProtectionStatusBadge,{config:a,rulesets:n}):null,(0,t.jsx)(g.Link,{canPrefetch:()=>!0,isDifferentZone:!1,href:o?.teamSlug&&o?.project?`/${o.teamSlug}/${o.project}/firewall/configure#custom-rules`:"#",children:(0,t.jsx)(m.Badge,{size:"sm",variant:"gray-subtle",children:(0,ti.pluralize)("active rule",a?.rules.filter(e=>e.active).length,!0)})}),r?.length?(0,t.jsx)(g.Link,{external:!0,href:"/guides/can-i-use-a-proxy-on-top-of-my-vercel-deployment",icon:!1,isDifferentZone:!0,children:(0,t.jsx)(m.Badge,{icon:(0,t.jsx)(tt.Warning,{}),size:"sm",variant:"amber-subtle",children:"Reverse Proxy detected"})}):null,(0,t.jsx)(ts.MicrofrontendsFirewallBadge,{})]})]})})}function to(e){let{anomaly:l}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Text,{color:"amber-900",className:tr,variant:"label-14",weight:500,children:"DDoS attack is being mitigated"}),(0,t.jsxs)(d.Text,{color:"gray-1000",className:tr,variant:"label-14",children:["since ",(0,tl.formatDateAndTime)(l.startTime)]})]})}function tc(e){let{globalBypass:l}=e,i=l.ttl?"Paused":"Disabled";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.Text,{color:"red-900",className:tr,variant:"label-14",weight:500,children:["System Mitigations ",i]}),(0,t.jsx)(d.Text,{color:"gray-1000",className:tr,variant:"label-14",children:"you are susceptible to attacks"}),l.ttl?(0,t.jsxs)(d.Text,{color:"gray-1000",className:tr,variant:"label-14",children:["until ",(0,tl.formatDateAndTime)(1e3*l.ttl)]}):null]})}function tu(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Text,{color:"blue-900",className:tr,variant:"label-14",weight:500,children:"Firewall is active"}),(0,t.jsx)(d.Text,{color:"gray-1000",className:tr,variant:"label-14",children:"All systems are normal"})]})}var td=e.i(3774835),tm=e.i(3748432);function tx(e){let{totalRequests:l}=e;return(0,t.jsx)("div",{className:"relative overflow-hidden rounded-t-md @container before:pointer-events-none before:absolute before:inset-0 before:shadow-[inset_-30px_0_20px_-20px_var(--ds-background-200)] before:content-[''] @[966px]:before:shadow-none",children:(0,t.jsx)("div",{className:"flex flex-1 flex-row divide-x [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:(0,t.jsx)(tf,{icon:(0,t.jsx)(er.Globe,{}),label:"All Traffic",children:l})})})}function tf(e){let{children:l,icon:i,label:s}=e;return(0,t.jsxs)(a.Stack,{className:"min-w-[166px] border-b-2 border-b-gray-1000 bg-background-100",flex:1,gap:1,padding:5,children:[(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:2,className:"text-gray-1000",children:[i,(0,t.jsx)(d.Text,{className:"whitespace-nowrap",variant:"label-14",weight:500,children:s})]}),(0,t.jsx)(d.Text,{align:"left",variant:"heading-24",weight:500,children:0===l?"-":(0,ea.formatShortPrecision)(l)})]})}e.i(6483798);var th=e.i(8287059);function tg(){return(0,t.jsxs)("div",{className:"grid w-full grid-cols-1 gap-3 lg:grid-cols-2",children:[(0,t.jsx)(tp,{}),(0,t.jsx)(tp,{})]})}function tp(){return(0,t.jsxs)(eZ.Card,{border:!0,className:"relative overflow-hidden",children:[(0,t.jsx)("div",{className:"border-b px-5 py-3",children:(0,t.jsx)(s.Skeleton,{height:20,width:100})}),(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsx)(tj,{}),(0,t.jsx)(tj,{}),(0,t.jsx)(tj,{}),(0,t.jsx)(tj,{}),(0,t.jsx)(tj,{})]})]})}function tj(){return(0,t.jsxs)("div",{className:"flex h-[36px] flex-1 items-center gap-5 p-2",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,t.jsx)(s.Skeleton,{height:8,pill:!0,width:8}),(0,t.jsx)(s.Skeleton,{height:16,width:144})]}),(0,t.jsx)(s.Skeleton,{height:16,width:32})]})}function tb(){return(0,t.jsx)(s.Skeleton,{className:"hidden lg:block",height:24,width:255})}let tv=JSON.stringify({name:"",description:"",active:!0,conditionGroup:[{conditions:[{type:"path",op:"eq",value:""}]}],action:{mitigate:{action:"rate_limit",rateLimit:{action:"rate_limit",algo:"fixed_window",window:"60",limit:"100",keys:["ip"]}}}});function ty(){let{team:e}=(0,eV.useTeam)(),i=(0,eb.useParams)(),a=i?.teamSlug??"",s=i?.project??"",r=(0,B.useServerFlag)("bot-id-ui",!1),{data:n,isLoading:o}=(0,T.useProject)(i?.project,{apiVersion:"v13"}),[c,u,d]=Q(e??void 0),{can:m,isLoading:x}=(0,N.default)(),f=m(_.Action.Read,_.Resource.SeawallConfig)||m(_.Action.List,_.Resource.SeawallConfig),h=(0,l.useRef)(null),{activeConfig:g,isLoadingConfig:p}=(0,F.useFirewallConfig)({projectId:s}),{data:j,isLoading:b}=(0,td.useManagedRulesets)({projectIdOrName:s,teamIdOrSlug:a}),v=(0,J.useQuerySelect)(c),{isLoading:w,error:C,currentData:k}=(0,I.useSonarLiveQuery)(f?v:void 0,"live"===c.range&&f),[S,A]=(0,l.useMemo)(()=>{let e=function(e){let{botIdEnabled:t}=e;return[...tC,...t?[{label:"BotID",value:"BotID",action:"allow",active:!0}]:[],...tw]}({botIdEnabled:r});if(g&&j){for(let[t,l]of Object.entries(g.currentConfig.managedRules??{})){let i=(0,ew.getRulesetFromRulesets)(j,t);if("owasp"===t){let t=(0,H.owaspToCrsConfig)(g.crsRules);e.push(...t.map(e=>({...e,active:l?.active??!1})))}else i&&e.push({label:i.name||t,value:`managed_${t}`,action:l?.action||i.defaultAction||i.actions?.[0]||"log",active:l?.active||i.active||!1})}for(let t of g.rules)e.push({label:t.name,value:t.id,action:t.action,active:t.active})}return[e,e.filter(e=>e.active)]},[r,g,j]),R=(0,l.useMemo)(()=>x&&!k?.data?null:f?k?.data?(0,ea.getSonarSeriesData)(k.data,v.groupBy,S,c):null:new Map,[v.groupBy,S,f,x,k?.data,c]),{totalRequests:M}=function(e,t){let{can:i}=(0,N.default)(),{currentData:a}=(0,I.useSonarLiveQuery)({...e,filter:void 0,groupBy:void 0,summaryOnly:!0},"live"===t.range&&(i(_.Action.Read,_.Resource.SeawallConfig)||i(_.Action.List,_.Resource.SeawallConfig)));return{totalRequests:(0,l.useMemo)(()=>a?.summary[0]?.value??0,[a])}}(v,c),{data:L,isLoading:P}=(0,D.useAttackStatus)({projectId:s,teamId:a}),{data:$,isLoading:z}=(0,O.useReverseProxyStatus)({projectIdOrName:s,teamIdOrSlug:a}),U=L?.anomalies.find(e=>"active"===e.state&&!e.endTime),E=b||P||p||o||z,q=E||w,G=(0,ea.globalBypassStatus)(n);return(0,t.jsx)(tm.ConditionalNavigationMarker,{enabled:!E,phase:"content",label:"FirewallOverview",children:(0,t.jsx)(K.ReviewChangeProvider,{projectIdOrName:s,teamIdOrSlug:a,children:(0,t.jsxs)("div",{"data-testid":(0,ey.tid)("firewall","overview","layout"),className:"tailwind-preflight",ref:h,children:[(0,t.jsx)(tk,{params:{teamSlug:a,project:s}}),(0,t.jsxs)("div",{className:"container flex flex-col gap-3 py-8",children:[(0,t.jsx)("div",{className:"flex flex-1 flex-row items-center justify-between gap-2",children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tb,{}),(0,t.jsx)("div",{className:"flex flex-1 flex-row justify-end",children:(0,t.jsx)("div",{className:"w-full lg:w-auto",children:(0,t.jsx)(eu,{})})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ts.FirewallStatusBadge,{className:"hidden lg:flex",config:g,project:n,rulesets:j}),(0,t.jsx)("div",{className:"flex flex-1 flex-row justify-end",children:(0,t.jsx)("div",{className:"w-full lg:w-auto",children:(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(eu,{}),children:(0,t.jsx)(ek,{isCustomRuleSelected:g?.rules.some(e=>e.id===c.filter),options:d,positionTop:(0,ea.getOffsetTop)(h.current),rules:A,setToolbarState:u,team:e??void 0,toolbarState:c,managedRulesets:j})})})})]})}),(0,t.jsx)(eX.SonarContextProvider,{children:(0,t.jsxs)(el,{formatter:ea.formatShortPrecision,series:R??new Map,children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row",children:[E?null:(0,t.jsx)(tn,{anomaly:U,className:"block w-full lg:h-[388px] lg:w-[300px]",config:g,globalBypass:G,reverseProxies:$,rulesets:j}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col rounded-md border border-gray-alpha-400 bg-background-100",children:["BotID"===c.filter?(0,t.jsx)(tx,{totalRequests:M}):(0,t.jsx)(eF,{onActionClick:e=>u({type:"action",value:e}),query:v,state:c}),(0,t.jsx)("div",{"data-testid":(0,ey.tid)("firewall","graph","container"),className:"flex-1 px-4 pb-4 pt-8",children:(0,t.jsx)(y.default,{children:e=>{let{width:l}=e;return(0,t.jsx)(e_,{data:R,error:C,height:240,isLoading:q,query:v,width:l})}})})]})]}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(tg,{}),children:q?(0,t.jsx)(tg,{}):(0,t.jsx)(e4,{config:g,project:n,rulesets:j??{}})})]})})]})]})})})}let tw=H.defaultShowSystemRules.map(e=>Object.assign({},e,{active:!0})),tC=[{label:"Overview",value:"all_rules",action:"allow",active:!0}];function tk(e){let{params:i}=e,m=(0,C.useRouter)(),{team:x,user:j}=(0,M.useAccount)(),[b,v]=(0,l.useState)(!1),{can:y,isLoading:k}=(0,N.default)(),{data:B,isLoading:I,mutate:D}=(0,T.useProject)(i.project,{apiVersion:"v13"}),{config:O}=(0,F.useFirewallConfig)({projectId:B?.id}),{updateMitigationsBypassAll:z,isLoading:U,bypassRules:E}=(0,$.useFirewallBypass)({projectId:B?.id}),q=(0,th.useOpenUpgradeModal)(),{config:H}=(0,F.useFirewallConfig)({projectId:i.project});(0,l.useEffect)(()=>{B?.id&&x?.id&&j?.uid&&A.analytics.track(R.AnalyticsEvent.FIREWALL_TAB_VISITED,{projectId:B.id,teamId:x.id,userId:j.uid})},[B?.id,x?.id,j?.uid]);let G=(0,l.useMemo)(()=>{if(x&&x.billing&&x.billing.plan)return x?.billing?.plan==="pro"?"pro":x?.billing?.plan==="enterprise"?"enterprise":"hobby"},[x]),V="hobby"===G,W=y(_.Action.Read,_.Resource.SeawallConfig)||y(_.Action.List,_.Resource.SeawallConfig),Z=y(_.Action.All,_.Resource.SeawallConfig),{enabled:Q}=(0,ea.globalBypassStatus)(B),J=(G??"hobby")!=="hobby",{menuItems:K,upgradeMenu:Y}=(0,l.useMemo)(()=>{let e=[],l=[],a={teamPlan:G,config:H,bypassRules:E};for(let{title:s,usage:r,key:n,href:o}of[{title:"Rule",key:"rule",href:`/${i.teamSlug}/${i.project}/firewall/configure/rule/new`,usage:(0,ea.getPlanUsage)({...a,type:"customRules"})},{title:"Rate Limit",key:"rate-limit",href:`/${i.teamSlug}/${i.project}/firewall/configure/rule/new?template=${encodeURIComponent(tv)}&sig=${encodeURIComponent((0,S.getRuleTemplateSignature)(tv))}`,usage:(0,ea.getPlanUsage)({...a,type:"rateLimit"})},{title:"IP Block",key:"ip-blocks",href:`/${i.teamSlug}/${i.project}/firewall/configure?add-ip=1`,usage:(0,ea.getPlanUsage)({...a,type:"ipBlocks"})},{title:"System Bypass",key:"system-bypass",href:`/${i.teamSlug}/${i.project}/firewall/configure?add-system-bypass=1`,usage:(0,ea.getPlanUsage)({...a,type:"ipBypass"})}]){if(!r)continue;let i=r.limit?(0,t.jsxs)("span",{className:"text-label-13 tabular-nums text-gray-900",children:[r.used," /"," ",r.limitReached&&r.nextPlanLimit?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("s",{className:"text-gray-700",children:r.limit})," ",(0,t.jsx)("span",{className:V?"text-blue-900":"text-purple-900",children:r.nextPlanLimit})]}):r.limit]}):void 0;if(r.limitReached&&"enterprise"!==G){let e=V?{onClick:()=>q({teamHint:x?.id,source:`firewall-configure-menu-${n}`,onConversionSuccess:()=>{m.push(o)}})}:{isLink:!0,href:"https://vercel.com/contact/sales"};l.push((0,t.jsx)(c.MenuItem,{...e,suffix:i,children:s},n))}else e.push((0,t.jsx)(c.MenuItem,{href:o,isLink:!0,suffix:i,children:s},n))}let s=null;return"hobby"===G?s="Upgrade to Pro":"pro"===G&&(s="Upgrade to Enterprise"),{menuItems:e,upgradeMenu:l.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.MenuDivider,{}),(0,t.jsx)(h.MenuSection,{title:s,children:l})]}):null}},[E,H,V,q,i,G,m.push,x?.id]),X=(0,l.useMemo)(()=>Q?"Resume":"Pause",[Q]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ei.DashboardHeading,{buttons:(0,t.jsxs)(a.Stack,{className:"hidden md:flex md:flex-wrap",direction:{sm:"column",md:"row",lg:"row"},gap:3,children:[(0,t.jsx)(eM.ReviewChangesButton,{currentConfig:O}),I||k?(0,t.jsx)("div",{className:"w-full md:w-[255px]",children:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"})}):(0,t.jsx)(g.ButtonLink,{disabled:!W,href:`/${i.teamSlug}/${i.project}/firewall/configure#bot-management`,prefix:(0,t.jsx)(p.Shield,{}),prefetch:!0,children:"Bot Management"}),(0,t.jsxs)(r.MenuContainer,{children:[(0,t.jsx)(o.MenuButton,{type:"secondary",children:"Add New..."}),(0,t.jsxs)(n.Menu,{width:224,children:[K,Y]})]}),(0,t.jsxs)(r.MenuContainer,{closeOnSelect:!0,position:"bottom-end",children:[(0,t.jsx)(o.MenuButton,{"aria-label":"Menu",shape:"square",size:"medium",svgOnly:!0,type:"secondary",children:(0,t.jsx)(w.MoreHorizontal,{})}),(0,t.jsxs)(n.Menu,{className:"min-w-[220px]",children:[(0,t.jsx)(c.MenuItem,{isLink:!0,href:`/${i.teamSlug}/${i.project}/firewall/configure`,children:"Configure"}),(0,t.jsx)(u.MenuLink,{href:"firewall/activity-log",children:"View Audit Log"}),J?(0,t.jsx)(P.EnsureSWRData,{data:[B],fallback:(0,t.jsx)(c.MenuItem,{children:(0,t.jsx)(s.Skeleton,{height:40,width:"100%"})}),children:(0,t.jsxs)(c.MenuItem,{disabled:!Z,onClick:()=>v(!0),type:"error",children:[X," System Mitigations"]})}):null]})]})]}),title:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,t.jsx)(d.Text,{as:"h1",size:32,weight:500,children:"Firewall"}),(0,t.jsx)(L.MicrofrontendsHelpBadge,{childHelp:"Firewall rules for the default app also run for every request to this microfrontend.",parentHelp:"Firewall rules defined here will run for all microfrontends in this group."})]}),(0,t.jsx)("div",{className:"md:hidden",children:(0,t.jsx)(tS,{canViewConfig:W,canWriteConfig:Z,currentConfig:O,isBypassEnabled:Q,onClickBypass:()=>v(!0),params:i,showBypassOption:J})})]})}),(0,t.jsx)(eI,{confirmText:`${x?x.slug:j?.username}/${B?.name}`,isEnabled:Q,isLoading:U||I,onClose:()=>v(!1),onSubmit:()=>{z(!Q).then(async()=>{v(!1),await D()}).catch(()=>{})},open:b})]})}function tS(e){let{params:i,onClickBypass:a,currentConfig:s,canViewConfig:c,canWriteConfig:u,isBypassEnabled:d,showBypassOption:x}=e,f=(0,C.useRouter)(),h=d?p.Shield:j.ShieldOff,{setOpen:g}=(0,K.useReviewChangeContext)(),y=(0,l.useRef)(null),N=(0,l.useMemo)(()=>d?"Resume":"Pause",[d]);return(0,t.jsx)("div",{className:"",ref:y,children:(0,t.jsxs)(r.MenuContainer,{closeOnSelect:!0,position:"bottom-end",children:[(0,t.jsx)(o.MenuButton,{"aria-label":"Menu",shape:"square",size:"small",svgOnly:!0,type:"secondary",children:(0,t.jsx)(w.MoreHorizontal,{})}),(0,t.jsx)(n.Menu,{className:"md:hidden",containerRef:y,mobileContainerClassName:"z-[5001]",portalClassName:"tailwind-preflight md:hidden",width:"14rem",children:(0,t.jsxs)("div",{className:"flex h-full flex-col gap-y-3 p-2",children:[s?.changes&&s.changes.length>0&&c?(0,t.jsx)(tN,{onClick:()=>setTimeout(()=>g(!0),30),prefix:(0,t.jsx)(k.CloudUpload,{size:16}),suffix:(0,t.jsx)(m.Badge,{className:"min-w-[28px]",size:"sm",variant:"blue",children:s.changes.length}),type:"secondary",children:"Review Changes"}):null,(0,t.jsx)(tN,{onClick:()=>{f.push(`/${i.teamSlug}/${i.project}/firewall/configure/rule/new`)},type:"secondary",prefix:(0,t.jsx)(b.Plus,{size:16}),children:"Add Rule"}),(0,t.jsx)(tN,{onClick:()=>{let e=(0,S.getRuleTemplateSignature)(tv);f.push(`/${i.teamSlug}/${i.project}/firewall/configure/rule/new?template=${encodeURIComponent(tv)}&sig=${encodeURIComponent(e)}`)},type:"secondary",prefix:(0,t.jsx)(v.Clock,{size:16}),children:"Add Rate Limit"}),(0,t.jsx)(tN,{onClick:()=>{f.push(`/${i.teamSlug}/${i.project}/firewall/configure`)},type:"secondary",children:"Configure Rules"}),(0,t.jsx)(tN,{onClick:()=>{f.push(`/${i.teamSlug}/${i.project}/firewall/activity-log`)},type:"secondary",children:"View Audit Log"}),x?(0,t.jsxs)(tN,{disabled:!u,onClick:a,prefix:(0,t.jsx)(h,{size:16}),children:[N," System Mitigations"]}):null,(0,t.jsx)(tN,{disabled:!c,onClick:()=>{f.push(`/${i.teamSlug}/${i.project}/firewall/configure#bot-management`)},prefix:(0,t.jsx)(p.Shield,{size:16}),children:"Bot Management"})]})})]})})}function tN(e){let{disabled:l,onClick:a,prefix:s,suffix:r,type:n,children:o}=e,{actions:c}=(0,x.useMenu)();return(0,t.jsx)(i.Button,{disabled:l,onClick:()=>{c.setOpen(!1),a()},prefix:s,suffix:r,type:n,width:"100%",children:o})}}]);

//# sourceMappingURL=2bbadcace0909a15.js.map
//# debugId=95327c4b-6403-59c8-9f71-81ee38db76dd
